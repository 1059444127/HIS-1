using System;
using System.Drawing;
using System.Collections;
using System.ComponentModel;
using System.Windows.Forms;
using System.Data;
using TrasenFrame.Classes;
using TrasenClasses.GeneralControls;
using TrasenClasses.GeneralClasses;
using YpClass;
namespace ts_yk_fkqr
{
	/// <summary>
	/// Form1 的摘要说明。
	/// </summary>
    public class Frmyfkpz : System.Windows.Forms.Form
    {
        private System.Windows.Forms.GroupBox groupBox1;
        private System.Windows.Forms.GroupBox groupBox2;
        private System.Windows.Forms.Label label3;
        private System.Windows.Forms.Label label2;
        private System.Windows.Forms.TextBox txtfph;
        private System.Windows.Forms.CheckBox chkfph;
        private System.Windows.Forms.Label label1;
        private System.Windows.Forms.TextBox txtghdw;
        private System.Windows.Forms.Button butref;
        private System.Windows.Forms.DateTimePicker dtpdjsj2;
        private System.Windows.Forms.DateTimePicker dtpdjsj1;
        private System.Windows.Forms.CheckBox chkdjsj;
        private System.Windows.Forms.TextBox txtdjh;
        private System.Windows.Forms.CheckBox chkdjh;
        private System.Windows.Forms.TextBox txtshdh;
        private System.Windows.Forms.CheckBox chkshdh;
        private System.Windows.Forms.DateTimePicker dtpfprq2;
        private System.Windows.Forms.DateTimePicker dtpfprq1;
        private System.Windows.Forms.CheckBox chkfprq;
        private System.Windows.Forms.RadioButton rdo1;
        private System.Windows.Forms.RadioButton rdo2;
        private myDataGrid.myDataGrid myDataGrid1;
        private myDataGrid.myDataGrid myDataGrid2;
        private System.Windows.Forms.Button butfk;
        private System.Windows.Forms.Button button1;
        private System.Windows.Forms.StatusBar statusBar1;
        private System.Windows.Forms.StatusBarPanel statusBarPanel1;
        private System.Windows.Forms.DataGridTableStyle dataGridTableStyle1;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn1;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn2;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn3;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn4;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn5;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn6;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn7;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn8;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn9;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn10;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn11;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn12;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn30;
        private System.Windows.Forms.DataGridBoolColumn 付款;
        private System.Windows.Forms.DataGridTableStyle dataGridTableStyle2;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn13;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn14;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn15;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn16;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn17;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn18;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn19;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn20;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn21;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn22;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn23;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn24;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn25;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn26;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn27;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn28;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn29;
        private DataGridTextBoxColumn dataGridTextBoxColumn31;
        private System.Windows.Forms.Button butclose;
        private System.Windows.Forms.Button butprint;
        private MenuTag _menuTag;
        private string _chineseName;
        private Form _mdiParent;
        private System.Windows.Forms.DateTimePicker dtpfprq;
        private CheckBox chkywy;
        private ComboBox cmbywy;
        private RadioButton rdoall;
        private ComboBox cmbck;
        private Label lblck;
        private ComboBox cmbyjks;
        private Label label6;
        private TabControl tabControl1;
        private TabPage tabPage1;
        private Panel panel2;
        private Splitter splitter1;
        private Panel panel1;
        private TabPage tabPage2;
        private myDataGrid.myDataGrid myDataGrid3;
        private DataGridTableStyle dataGridTableStyle3;
        private DataGridTextBoxColumn dataGridTextBoxColumn32;
        private DataGridTextBoxColumn dataGridTextBoxColumn33;
        private DataGridTextBoxColumn dataGridTextBoxColumn34;
        private DataGridTextBoxColumn dataGridTextBoxColumn35;
        private DataGridTextBoxColumn dataGridTextBoxColumn36;
        private DataGridTextBoxColumn dataGridTextBoxColumn37;
        private DataGridTextBoxColumn dataGridTextBoxColumn38;
        private DataGridTextBoxColumn dataGridTextBoxColumn39;
        private DataGridTextBoxColumn dataGridTextBoxColumn40;
        private DataGridTextBoxColumn dataGridTextBoxColumn41;
        private DataGridTextBoxColumn dataGridTextBoxColumn42;
        private DataGridTextBoxColumn dataGridTextBoxColumn43;
        private DataGridTextBoxColumn dataGridTextBoxColumn44;
        private DataGridTextBoxColumn dataGridTextBoxColumn45;
        private DataGridTextBoxColumn dataGridTextBoxColumn46;
        private DataGridTextBoxColumn dataGridTextBoxColumn47;
        private DataGridTextBoxColumn dataGridTextBoxColumn48;
        private DataGridTextBoxColumn dataGridTextBoxColumn49;
        private DataGridTextBoxColumn dataGridTextBoxColumn50;
        private TextBox txtypmc;
        private CheckBox chkypmc;
        private Panel panel3;
        private Splitter splitter2;
        private DataGridView dataGridView1;
        private Panel panel4;

        private decimal sumje = 0;
        private DataGridViewTextBoxColumn Column1;
        private DataGridViewTextBoxColumn 进货金额;
        private DataGridViewTextBoxColumn ghdwid;
        private Button butsaveFp;
        private Button butexcel;

        private decimal SumJe = 0;
        private Button button2;
        private DateTimePicker dtpfkrq2;
        private Label label4;
        private DateTimePicker dtpfkrq1;
        private CheckBox chkfkrq;
        private Panel panel5;
        private Panel panel6;
        private Button butexcel_dw;
        private DataGridTextBoxColumn dataGridTextBoxColumn51;
        private DataGridTextBoxColumn dataGridTextBoxColumn52;
        private DataGridTextBoxColumn dataGridTextBoxColumn53;
        private Timer timer1;
        private Button butallsel;
        private Button butunallsel;
        private DataGridTextBoxColumn col_yppch;
        private IContainer components;

        public Frmyfkpz(MenuTag menuTag, string chineseName, Form mdiParent)
        {
            //
            // Windows 窗体设计器支持所必需的
            //
            InitializeComponent();
            _menuTag = menuTag;
            _chineseName = chineseName;
            _mdiParent = mdiParent;
            this.Text = this.Text + " [" + InstanceForm._menuTag.Jgbm + "]";
            //
            // TODO: 在 InitializeComponent 调用后添加任何构造函数代码
            //
        }

        /// <summary>
        /// 清理所有正在使用的资源。
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if (components != null)
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #region Windows 窗体设计器生成的代码
        /// <summary>
        /// 设计器支持所需的方法 - 不要使用代码编辑器修改
        /// 此方法的内容。
        /// </summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            this.groupBox1 = new System.Windows.Forms.GroupBox();
            this.butexcel = new System.Windows.Forms.Button();
            this.cmbck = new System.Windows.Forms.ComboBox();
            this.lblck = new System.Windows.Forms.Label();
            this.cmbyjks = new System.Windows.Forms.ComboBox();
            this.label6 = new System.Windows.Forms.Label();
            this.rdoall = new System.Windows.Forms.RadioButton();
            this.butprint = new System.Windows.Forms.Button();
            this.butclose = new System.Windows.Forms.Button();
            this.rdo2 = new System.Windows.Forms.RadioButton();
            this.rdo1 = new System.Windows.Forms.RadioButton();
            this.butref = new System.Windows.Forms.Button();
            this.groupBox2 = new System.Windows.Forms.GroupBox();
            this.butunallsel = new System.Windows.Forms.Button();
            this.butallsel = new System.Windows.Forms.Button();
            this.dtpfkrq2 = new System.Windows.Forms.DateTimePicker();
            this.label4 = new System.Windows.Forms.Label();
            this.dtpfkrq1 = new System.Windows.Forms.DateTimePicker();
            this.chkfkrq = new System.Windows.Forms.CheckBox();
            this.button2 = new System.Windows.Forms.Button();
            this.butsaveFp = new System.Windows.Forms.Button();
            this.txtypmc = new System.Windows.Forms.TextBox();
            this.chkypmc = new System.Windows.Forms.CheckBox();
            this.cmbywy = new System.Windows.Forms.ComboBox();
            this.chkywy = new System.Windows.Forms.CheckBox();
            this.button1 = new System.Windows.Forms.Button();
            this.butfk = new System.Windows.Forms.Button();
            this.dtpdjsj2 = new System.Windows.Forms.DateTimePicker();
            this.label3 = new System.Windows.Forms.Label();
            this.dtpdjsj1 = new System.Windows.Forms.DateTimePicker();
            this.chkdjsj = new System.Windows.Forms.CheckBox();
            this.txtdjh = new System.Windows.Forms.TextBox();
            this.chkdjh = new System.Windows.Forms.CheckBox();
            this.txtshdh = new System.Windows.Forms.TextBox();
            this.chkshdh = new System.Windows.Forms.CheckBox();
            this.txtfph = new System.Windows.Forms.TextBox();
            this.chkfph = new System.Windows.Forms.CheckBox();
            this.dtpfprq2 = new System.Windows.Forms.DateTimePicker();
            this.label1 = new System.Windows.Forms.Label();
            this.dtpfprq1 = new System.Windows.Forms.DateTimePicker();
            this.chkfprq = new System.Windows.Forms.CheckBox();
            this.txtghdw = new System.Windows.Forms.TextBox();
            this.label2 = new System.Windows.Forms.Label();
            this.dtpfprq = new System.Windows.Forms.DateTimePicker();
            this.myDataGrid1 = new myDataGrid.myDataGrid();
            this.dataGridTableStyle1 = new System.Windows.Forms.DataGridTableStyle();
            this.dataGridTextBoxColumn1 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn31 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.付款 = new System.Windows.Forms.DataGridBoolColumn();
            this.dataGridTextBoxColumn2 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn4 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn3 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn10 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn6 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn7 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn9 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn5 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn8 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn51 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn11 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn12 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn30 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.myDataGrid2 = new myDataGrid.myDataGrid();
            this.dataGridTableStyle2 = new System.Windows.Forms.DataGridTableStyle();
            this.dataGridTextBoxColumn13 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn14 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn15 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn16 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn17 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn18 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn19 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn20 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn21 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn22 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn23 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn24 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn25 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn26 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn27 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn28 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn29 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.statusBar1 = new System.Windows.Forms.StatusBar();
            this.statusBarPanel1 = new System.Windows.Forms.StatusBarPanel();
            this.tabControl1 = new System.Windows.Forms.TabControl();
            this.tabPage1 = new System.Windows.Forms.TabPage();
            this.panel2 = new System.Windows.Forms.Panel();
            this.splitter1 = new System.Windows.Forms.Splitter();
            this.panel1 = new System.Windows.Forms.Panel();
            this.tabPage2 = new System.Windows.Forms.TabPage();
            this.myDataGrid3 = new myDataGrid.myDataGrid();
            this.dataGridTableStyle3 = new System.Windows.Forms.DataGridTableStyle();
            this.dataGridTextBoxColumn32 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn33 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn34 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn50 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn43 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn44 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn45 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn46 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn47 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn48 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn35 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn36 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn49 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn37 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn53 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn38 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn39 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn40 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn52 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn41 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn42 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.panel3 = new System.Windows.Forms.Panel();
            this.panel6 = new System.Windows.Forms.Panel();
            this.dataGridView1 = new System.Windows.Forms.DataGridView();
            this.Column1 = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.进货金额 = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.ghdwid = new System.Windows.Forms.DataGridViewTextBoxColumn();
            this.panel5 = new System.Windows.Forms.Panel();
            this.butexcel_dw = new System.Windows.Forms.Button();
            this.splitter2 = new System.Windows.Forms.Splitter();
            this.panel4 = new System.Windows.Forms.Panel();
            this.timer1 = new System.Windows.Forms.Timer(this.components);
            this.col_yppch = new System.Windows.Forms.DataGridTextBoxColumn();
            this.groupBox1.SuspendLayout();
            this.groupBox2.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.myDataGrid1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.myDataGrid2)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.statusBarPanel1)).BeginInit();
            this.tabControl1.SuspendLayout();
            this.tabPage1.SuspendLayout();
            this.panel2.SuspendLayout();
            this.panel1.SuspendLayout();
            this.tabPage2.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.myDataGrid3)).BeginInit();
            this.panel3.SuspendLayout();
            this.panel6.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.dataGridView1)).BeginInit();
            this.panel5.SuspendLayout();
            this.panel4.SuspendLayout();
            this.SuspendLayout();
            // 
            // groupBox1
            // 
            this.groupBox1.Controls.Add(this.butexcel);
            this.groupBox1.Controls.Add(this.cmbck);
            this.groupBox1.Controls.Add(this.lblck);
            this.groupBox1.Controls.Add(this.cmbyjks);
            this.groupBox1.Controls.Add(this.label6);
            this.groupBox1.Controls.Add(this.rdoall);
            this.groupBox1.Controls.Add(this.butprint);
            this.groupBox1.Controls.Add(this.butclose);
            this.groupBox1.Controls.Add(this.rdo2);
            this.groupBox1.Controls.Add(this.rdo1);
            this.groupBox1.Controls.Add(this.butref);
            this.groupBox1.Dock = System.Windows.Forms.DockStyle.Top;
            this.groupBox1.Location = new System.Drawing.Point(0, 0);
            this.groupBox1.Name = "groupBox1";
            this.groupBox1.Size = new System.Drawing.Size(968, 40);
            this.groupBox1.TabIndex = 0;
            this.groupBox1.TabStop = false;
            this.groupBox1.Text = "查询类型";
            // 
            // butexcel
            // 
            this.butexcel.Location = new System.Drawing.Point(737, 8);
            this.butexcel.Name = "butexcel";
            this.butexcel.Size = new System.Drawing.Size(69, 29);
            this.butexcel.TabIndex = 43;
            this.butexcel.Text = "导出(&E)";
            this.butexcel.Click += new System.EventHandler(this.butexcel_Click);
            // 
            // cmbck
            // 
            this.cmbck.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cmbck.Location = new System.Drawing.Point(480, 13);
            this.cmbck.Name = "cmbck";
            this.cmbck.Size = new System.Drawing.Size(108, 20);
            this.cmbck.TabIndex = 42;
            // 
            // lblck
            // 
            this.lblck.Location = new System.Drawing.Point(427, 18);
            this.lblck.Name = "lblck";
            this.lblck.Size = new System.Drawing.Size(67, 16);
            this.lblck.TabIndex = 41;
            this.lblck.Text = "仓库名称";
            // 
            // cmbyjks
            // 
            this.cmbyjks.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.cmbyjks.Location = new System.Drawing.Point(297, 13);
            this.cmbyjks.Name = "cmbyjks";
            this.cmbyjks.Size = new System.Drawing.Size(123, 20);
            this.cmbyjks.TabIndex = 40;
            this.cmbyjks.SelectedIndexChanged += new System.EventHandler(this.cmbyjks_SelectedIndexChanged);
            // 
            // label6
            // 
            this.label6.Location = new System.Drawing.Point(241, 18);
            this.label6.Name = "label6";
            this.label6.Size = new System.Drawing.Size(67, 16);
            this.label6.TabIndex = 39;
            this.label6.Text = "药剂科室";
            // 
            // rdoall
            // 
            this.rdoall.Location = new System.Drawing.Point(185, 14);
            this.rdoall.Name = "rdoall";
            this.rdoall.Size = new System.Drawing.Size(88, 24);
            this.rdoall.TabIndex = 29;
            this.rdoall.Text = "全部";
            this.rdoall.CheckedChanged += new System.EventHandler(this.rdo2_CheckedChanged);
            // 
            // butprint
            // 
            this.butprint.Location = new System.Drawing.Point(669, 8);
            this.butprint.Name = "butprint";
            this.butprint.Size = new System.Drawing.Size(67, 29);
            this.butprint.TabIndex = 28;
            this.butprint.Text = "打印(&P)";
            this.butprint.Click += new System.EventHandler(this.butprint_Click);
            // 
            // butclose
            // 
            this.butclose.Location = new System.Drawing.Point(807, 8);
            this.butclose.Name = "butclose";
            this.butclose.Size = new System.Drawing.Size(62, 29);
            this.butclose.TabIndex = 27;
            this.butclose.Text = "退出(&Q)";
            this.butclose.Click += new System.EventHandler(this.butclose_Click);
            // 
            // rdo2
            // 
            this.rdo2.Location = new System.Drawing.Point(99, 13);
            this.rdo2.Name = "rdo2";
            this.rdo2.Size = new System.Drawing.Size(88, 24);
            this.rdo2.TabIndex = 26;
            this.rdo2.Text = "已付款单据";
            this.rdo2.CheckedChanged += new System.EventHandler(this.rdo2_CheckedChanged);
            // 
            // rdo1
            // 
            this.rdo1.Checked = true;
            this.rdo1.Location = new System.Drawing.Point(12, 13);
            this.rdo1.Name = "rdo1";
            this.rdo1.Size = new System.Drawing.Size(88, 24);
            this.rdo1.TabIndex = 25;
            this.rdo1.TabStop = true;
            this.rdo1.Text = "未付款单据";
            this.rdo1.CheckedChanged += new System.EventHandler(this.rdo2_CheckedChanged);
            // 
            // butref
            // 
            this.butref.Location = new System.Drawing.Point(597, 8);
            this.butref.Name = "butref";
            this.butref.Size = new System.Drawing.Size(71, 29);
            this.butref.TabIndex = 13;
            this.butref.Text = "刷新(&R)";
            this.butref.Click += new System.EventHandler(this.butref_Click);
            // 
            // groupBox2
            // 
            this.groupBox2.Controls.Add(this.butunallsel);
            this.groupBox2.Controls.Add(this.butallsel);
            this.groupBox2.Controls.Add(this.dtpfkrq2);
            this.groupBox2.Controls.Add(this.label4);
            this.groupBox2.Controls.Add(this.dtpfkrq1);
            this.groupBox2.Controls.Add(this.chkfkrq);
            this.groupBox2.Controls.Add(this.button2);
            this.groupBox2.Controls.Add(this.butsaveFp);
            this.groupBox2.Controls.Add(this.txtypmc);
            this.groupBox2.Controls.Add(this.chkypmc);
            this.groupBox2.Controls.Add(this.cmbywy);
            this.groupBox2.Controls.Add(this.chkywy);
            this.groupBox2.Controls.Add(this.button1);
            this.groupBox2.Controls.Add(this.butfk);
            this.groupBox2.Controls.Add(this.dtpdjsj2);
            this.groupBox2.Controls.Add(this.label3);
            this.groupBox2.Controls.Add(this.dtpdjsj1);
            this.groupBox2.Controls.Add(this.chkdjsj);
            this.groupBox2.Controls.Add(this.txtdjh);
            this.groupBox2.Controls.Add(this.chkdjh);
            this.groupBox2.Controls.Add(this.txtshdh);
            this.groupBox2.Controls.Add(this.chkshdh);
            this.groupBox2.Controls.Add(this.txtfph);
            this.groupBox2.Controls.Add(this.chkfph);
            this.groupBox2.Controls.Add(this.dtpfprq2);
            this.groupBox2.Controls.Add(this.label1);
            this.groupBox2.Controls.Add(this.dtpfprq1);
            this.groupBox2.Controls.Add(this.chkfprq);
            this.groupBox2.Controls.Add(this.txtghdw);
            this.groupBox2.Controls.Add(this.label2);
            this.groupBox2.Dock = System.Windows.Forms.DockStyle.Top;
            this.groupBox2.Location = new System.Drawing.Point(0, 40);
            this.groupBox2.Name = "groupBox2";
            this.groupBox2.Size = new System.Drawing.Size(968, 98);
            this.groupBox2.TabIndex = 1;
            this.groupBox2.TabStop = false;
            this.groupBox2.Text = "查询条件";
            // 
            // butunallsel
            // 
            this.butunallsel.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(192)))), ((int)(((byte)(192)))), ((int)(((byte)(255)))));
            this.butunallsel.Location = new System.Drawing.Point(638, 71);
            this.butunallsel.Name = "butunallsel";
            this.butunallsel.Size = new System.Drawing.Size(80, 23);
            this.butunallsel.TabIndex = 55;
            this.butunallsel.Text = "反选";
            this.butunallsel.UseVisualStyleBackColor = false;
            this.butunallsel.Click += new System.EventHandler(this.butunallsel_Click);
            // 
            // butallsel
            // 
            this.butallsel.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(192)))), ((int)(((byte)(192)))), ((int)(((byte)(255)))));
            this.butallsel.Location = new System.Drawing.Point(576, 71);
            this.butallsel.Name = "butallsel";
            this.butallsel.Size = new System.Drawing.Size(56, 23);
            this.butallsel.TabIndex = 54;
            this.butallsel.Text = "全选";
            this.butallsel.UseVisualStyleBackColor = false;
            this.butallsel.Click += new System.EventHandler(this.butallsel_Click);
            // 
            // dtpfkrq2
            // 
            this.dtpfkrq2.Enabled = false;
            this.dtpfkrq2.Location = new System.Drawing.Point(461, 73);
            this.dtpfkrq2.Name = "dtpfkrq2";
            this.dtpfkrq2.Size = new System.Drawing.Size(110, 21);
            this.dtpfkrq2.TabIndex = 52;
            // 
            // label4
            // 
            this.label4.Location = new System.Drawing.Point(437, 77);
            this.label4.Name = "label4";
            this.label4.Size = new System.Drawing.Size(24, 16);
            this.label4.TabIndex = 53;
            this.label4.Text = "到";
            // 
            // dtpfkrq1
            // 
            this.dtpfkrq1.Enabled = false;
            this.dtpfkrq1.Location = new System.Drawing.Point(325, 73);
            this.dtpfkrq1.Name = "dtpfkrq1";
            this.dtpfkrq1.Size = new System.Drawing.Size(111, 21);
            this.dtpfkrq1.TabIndex = 51;
            // 
            // chkfkrq
            // 
            this.chkfkrq.Location = new System.Drawing.Point(253, 73);
            this.chkfkrq.Name = "chkfkrq";
            this.chkfkrq.Size = new System.Drawing.Size(80, 22);
            this.chkfkrq.TabIndex = 50;
            this.chkfkrq.Text = "付款日期";
            this.chkfkrq.CheckedChanged += new System.EventHandler(this.chkshdh_CheckedChanged);
            // 
            // button2
            // 
            this.button2.Location = new System.Drawing.Point(784, 69);
            this.button2.Name = "button2";
            this.button2.Size = new System.Drawing.Size(69, 29);
            this.button2.TabIndex = 49;
            this.button2.Text = "导出明细(&E)";
            this.button2.Visible = false;
            this.button2.Click += new System.EventHandler(this.button2_Click);
            // 
            // butsaveFp
            // 
            this.butsaveFp.Location = new System.Drawing.Point(675, 40);
            this.butsaveFp.Name = "butsaveFp";
            this.butsaveFp.Size = new System.Drawing.Size(88, 29);
            this.butsaveFp.TabIndex = 48;
            this.butsaveFp.Text = "保存发票(&F)";
            this.butsaveFp.Click += new System.EventHandler(this.butsaveFp_Click);
            // 
            // txtypmc
            // 
            this.txtypmc.Enabled = false;
            this.txtypmc.ForeColor = System.Drawing.Color.Navy;
            this.txtypmc.ImeMode = System.Windows.Forms.ImeMode.Off;
            this.txtypmc.Location = new System.Drawing.Point(84, 73);
            this.txtypmc.Name = "txtypmc";
            this.txtypmc.Size = new System.Drawing.Size(160, 21);
            this.txtypmc.TabIndex = 46;
            this.txtypmc.KeyUp += new System.Windows.Forms.KeyEventHandler(this.TextKeyUp);
            // 
            // chkypmc
            // 
            this.chkypmc.Location = new System.Drawing.Point(11, 73);
            this.chkypmc.Name = "chkypmc";
            this.chkypmc.Size = new System.Drawing.Size(80, 22);
            this.chkypmc.TabIndex = 47;
            this.chkypmc.Text = "药品名称";
            this.chkypmc.CheckedChanged += new System.EventHandler(this.chkshdh_CheckedChanged);
            // 
            // cmbywy
            // 
            this.cmbywy.Enabled = false;
            this.cmbywy.FormattingEnabled = true;
            this.cmbywy.Location = new System.Drawing.Point(296, 18);
            this.cmbywy.Name = "cmbywy";
            this.cmbywy.Size = new System.Drawing.Size(82, 20);
            this.cmbywy.TabIndex = 45;
            // 
            // chkywy
            // 
            this.chkywy.Location = new System.Drawing.Point(238, 18);
            this.chkywy.Name = "chkywy";
            this.chkywy.Size = new System.Drawing.Size(64, 22);
            this.chkywy.TabIndex = 44;
            this.chkywy.Text = "业务员";
            this.chkywy.CheckedChanged += new System.EventHandler(this.chkshdh_CheckedChanged);
            // 
            // button1
            // 
            this.button1.Location = new System.Drawing.Point(765, 40);
            this.button1.Name = "button1";
            this.button1.Size = new System.Drawing.Size(88, 29);
            this.button1.TabIndex = 43;
            this.button1.Text = "取消付款(&E)";
            this.button1.Click += new System.EventHandler(this.button1_Click);
            // 
            // butfk
            // 
            this.butfk.Location = new System.Drawing.Point(765, 9);
            this.butfk.Name = "butfk";
            this.butfk.Size = new System.Drawing.Size(88, 29);
            this.butfk.TabIndex = 42;
            this.butfk.Text = "付款(&F)";
            this.butfk.Click += new System.EventHandler(this.butfk_Click);
            // 
            // dtpdjsj2
            // 
            this.dtpdjsj2.Enabled = false;
            this.dtpdjsj2.Location = new System.Drawing.Point(556, 46);
            this.dtpdjsj2.Name = "dtpdjsj2";
            this.dtpdjsj2.Size = new System.Drawing.Size(110, 21);
            this.dtpdjsj2.TabIndex = 12;
            // 
            // label3
            // 
            this.label3.Location = new System.Drawing.Point(532, 50);
            this.label3.Name = "label3";
            this.label3.Size = new System.Drawing.Size(24, 16);
            this.label3.TabIndex = 40;
            this.label3.Text = "到";
            // 
            // dtpdjsj1
            // 
            this.dtpdjsj1.Enabled = false;
            this.dtpdjsj1.Location = new System.Drawing.Point(420, 46);
            this.dtpdjsj1.Name = "dtpdjsj1";
            this.dtpdjsj1.Size = new System.Drawing.Size(111, 21);
            this.dtpdjsj1.TabIndex = 11;
            // 
            // chkdjsj
            // 
            this.chkdjsj.Location = new System.Drawing.Point(348, 46);
            this.chkdjsj.Name = "chkdjsj";
            this.chkdjsj.Size = new System.Drawing.Size(80, 22);
            this.chkdjsj.TabIndex = 10;
            this.chkdjsj.Text = "登记日期";
            this.chkdjsj.CheckedChanged += new System.EventHandler(this.chkshdh_CheckedChanged);
            // 
            // txtdjh
            // 
            this.txtdjh.Enabled = false;
            this.txtdjh.Location = new System.Drawing.Point(696, 17);
            this.txtdjh.Name = "txtdjh";
            this.txtdjh.Size = new System.Drawing.Size(50, 21);
            this.txtdjh.TabIndex = 6;
            // 
            // chkdjh
            // 
            this.chkdjh.Location = new System.Drawing.Point(639, 16);
            this.chkdjh.Name = "chkdjh";
            this.chkdjh.Size = new System.Drawing.Size(66, 22);
            this.chkdjh.TabIndex = 5;
            this.chkdjh.Text = "单据号";
            this.chkdjh.CheckedChanged += new System.EventHandler(this.chkshdh_CheckedChanged);
            // 
            // txtshdh
            // 
            this.txtshdh.Enabled = false;
            this.txtshdh.Location = new System.Drawing.Point(579, 17);
            this.txtshdh.Name = "txtshdh";
            this.txtshdh.Size = new System.Drawing.Size(53, 21);
            this.txtshdh.TabIndex = 4;
            // 
            // chkshdh
            // 
            this.chkshdh.Location = new System.Drawing.Point(513, 16);
            this.chkshdh.Name = "chkshdh";
            this.chkshdh.Size = new System.Drawing.Size(80, 22);
            this.chkshdh.TabIndex = 3;
            this.chkshdh.Text = "送货单号";
            this.chkshdh.CheckedChanged += new System.EventHandler(this.chkshdh_CheckedChanged);
            // 
            // txtfph
            // 
            this.txtfph.Enabled = false;
            this.txtfph.Location = new System.Drawing.Point(454, 17);
            this.txtfph.Name = "txtfph";
            this.txtfph.Size = new System.Drawing.Size(52, 21);
            this.txtfph.TabIndex = 2;
            // 
            // chkfph
            // 
            this.chkfph.Location = new System.Drawing.Point(394, 16);
            this.chkfph.Name = "chkfph";
            this.chkfph.Size = new System.Drawing.Size(64, 22);
            this.chkfph.TabIndex = 1;
            this.chkfph.Text = "发票号";
            this.chkfph.CheckedChanged += new System.EventHandler(this.chkshdh_CheckedChanged);
            // 
            // dtpfprq2
            // 
            this.dtpfprq2.Enabled = false;
            this.dtpfprq2.Location = new System.Drawing.Point(220, 46);
            this.dtpfprq2.Name = "dtpfprq2";
            this.dtpfprq2.Size = new System.Drawing.Size(110, 21);
            this.dtpfprq2.TabIndex = 9;
            // 
            // label1
            // 
            this.label1.Location = new System.Drawing.Point(202, 51);
            this.label1.Name = "label1";
            this.label1.Size = new System.Drawing.Size(24, 16);
            this.label1.TabIndex = 29;
            this.label1.Text = "到";
            // 
            // dtpfprq1
            // 
            this.dtpfprq1.Enabled = false;
            this.dtpfprq1.Location = new System.Drawing.Point(84, 46);
            this.dtpfprq1.Name = "dtpfprq1";
            this.dtpfprq1.Size = new System.Drawing.Size(111, 21);
            this.dtpfprq1.TabIndex = 8;
            // 
            // chkfprq
            // 
            this.chkfprq.Location = new System.Drawing.Point(11, 46);
            this.chkfprq.Name = "chkfprq";
            this.chkfprq.Size = new System.Drawing.Size(80, 22);
            this.chkfprq.TabIndex = 7;
            this.chkfprq.Text = "发票日期";
            this.chkfprq.CheckedChanged += new System.EventHandler(this.chkshdh_CheckedChanged);
            // 
            // txtghdw
            // 
            this.txtghdw.ForeColor = System.Drawing.Color.Navy;
            this.txtghdw.ImeMode = System.Windows.Forms.ImeMode.Off;
            this.txtghdw.Location = new System.Drawing.Point(72, 17);
            this.txtghdw.Name = "txtghdw";
            this.txtghdw.Size = new System.Drawing.Size(160, 21);
            this.txtghdw.TabIndex = 0;
            this.txtghdw.KeyUp += new System.Windows.Forms.KeyEventHandler(this.TextKeyUp);
            // 
            // label2
            // 
            this.label2.Location = new System.Drawing.Point(16, 22);
            this.label2.Name = "label2";
            this.label2.Size = new System.Drawing.Size(58, 16);
            this.label2.TabIndex = 33;
            this.label2.Text = "供货单位";
            // 
            // dtpfprq
            // 
            this.dtpfprq.Location = new System.Drawing.Point(18, 29);
            this.dtpfprq.Name = "dtpfprq";
            this.dtpfprq.Size = new System.Drawing.Size(112, 21);
            this.dtpfprq.TabIndex = 1;
            this.dtpfprq.Visible = false;
            this.dtpfprq.VisibleChanged += new System.EventHandler(this.dtpfprq_VisibleChanged);
            this.dtpfprq.Leave += new System.EventHandler(this.dtpfprq_Leave);
            this.dtpfprq.KeyPress += new System.Windows.Forms.KeyPressEventHandler(this.dtpfprq_KeyPress);
            // 
            // myDataGrid1
            // 
            this.myDataGrid1.BackgroundColor = System.Drawing.Color.White;
            this.myDataGrid1.CaptionVisible = false;
            this.myDataGrid1.DataMember = "";
            this.myDataGrid1.Dock = System.Windows.Forms.DockStyle.Fill;
            this.myDataGrid1.HeaderForeColor = System.Drawing.SystemColors.ControlText;
            this.myDataGrid1.Location = new System.Drawing.Point(0, 0);
            this.myDataGrid1.Name = "myDataGrid1";
            this.myDataGrid1.Size = new System.Drawing.Size(735, 229);
            this.myDataGrid1.TabIndex = 0;
            this.myDataGrid1.TableStyles.AddRange(new System.Windows.Forms.DataGridTableStyle[] {
            this.dataGridTableStyle1});
            this.myDataGrid1.MouseClick += new System.Windows.Forms.MouseEventHandler(this.myDataGrid1_MouseClick);
            this.myDataGrid1.CurrentCellChanged += new System.EventHandler(this.myDataGrid1_CurrentCellChanged);
            this.myDataGrid1.Click += new System.EventHandler(this.myDataGrid1_Click);
            // 
            // dataGridTableStyle1
            // 
            this.dataGridTableStyle1.AllowSorting = false;
            this.dataGridTableStyle1.DataGrid = this.myDataGrid1;
            this.dataGridTableStyle1.GridColumnStyles.AddRange(new System.Windows.Forms.DataGridColumnStyle[] {
            this.dataGridTextBoxColumn1,
            this.dataGridTextBoxColumn31,
            this.付款,
            this.dataGridTextBoxColumn2,
            this.dataGridTextBoxColumn4,
            this.dataGridTextBoxColumn3,
            this.dataGridTextBoxColumn10,
            this.dataGridTextBoxColumn6,
            this.dataGridTextBoxColumn7,
            this.dataGridTextBoxColumn9,
            this.dataGridTextBoxColumn5,
            this.dataGridTextBoxColumn8,
            this.dataGridTextBoxColumn51,
            this.dataGridTextBoxColumn11,
            this.dataGridTextBoxColumn12,
            this.dataGridTextBoxColumn30});
            this.dataGridTableStyle1.HeaderForeColor = System.Drawing.SystemColors.ControlText;
            // 
            // dataGridTextBoxColumn1
            // 
            this.dataGridTextBoxColumn1.Format = "";
            this.dataGridTextBoxColumn1.FormatInfo = null;
            this.dataGridTextBoxColumn1.HeaderText = "序号";
            this.dataGridTextBoxColumn1.NullText = "";
            this.dataGridTextBoxColumn1.ReadOnly = true;
            this.dataGridTextBoxColumn1.Width = 30;
            // 
            // dataGridTextBoxColumn31
            // 
            this.dataGridTextBoxColumn31.Format = "";
            this.dataGridTextBoxColumn31.FormatInfo = null;
            this.dataGridTextBoxColumn31.HeaderText = "仓库名称";
            this.dataGridTextBoxColumn31.NullText = "";
            this.dataGridTextBoxColumn31.Width = 110;
            // 
            // 付款
            // 
            this.付款.AllowNull = false;
            this.付款.FalseValue = ((short)(0));
            this.付款.HeaderText = "付款";
            this.付款.MappingName = "付款";
            this.付款.NullText = "0";
            this.付款.NullValue = ((short)(0));
            this.付款.TrueValue = ((short)(1));
            this.付款.Width = 30;
            // 
            // dataGridTextBoxColumn2
            // 
            this.dataGridTextBoxColumn2.Format = "";
            this.dataGridTextBoxColumn2.FormatInfo = null;
            this.dataGridTextBoxColumn2.HeaderText = "单据号";
            this.dataGridTextBoxColumn2.NullText = "";
            this.dataGridTextBoxColumn2.ReadOnly = true;
            this.dataGridTextBoxColumn2.Width = 55;
            // 
            // dataGridTextBoxColumn4
            // 
            this.dataGridTextBoxColumn4.Format = "";
            this.dataGridTextBoxColumn4.FormatInfo = null;
            this.dataGridTextBoxColumn4.HeaderText = "单据日期";
            this.dataGridTextBoxColumn4.NullText = "";
            this.dataGridTextBoxColumn4.ReadOnly = true;
            this.dataGridTextBoxColumn4.Width = 80;
            // 
            // dataGridTextBoxColumn3
            // 
            this.dataGridTextBoxColumn3.Format = "";
            this.dataGridTextBoxColumn3.FormatInfo = null;
            this.dataGridTextBoxColumn3.HeaderText = "单据类别";
            this.dataGridTextBoxColumn3.NullText = "";
            this.dataGridTextBoxColumn3.ReadOnly = true;
            this.dataGridTextBoxColumn3.Width = 60;
            // 
            // dataGridTextBoxColumn10
            // 
            this.dataGridTextBoxColumn10.Format = "";
            this.dataGridTextBoxColumn10.FormatInfo = null;
            this.dataGridTextBoxColumn10.HeaderText = "进货金额";
            this.dataGridTextBoxColumn10.NullText = "";
            this.dataGridTextBoxColumn10.ReadOnly = true;
            this.dataGridTextBoxColumn10.Width = 85;
            // 
            // dataGridTextBoxColumn6
            // 
            this.dataGridTextBoxColumn6.Format = "";
            this.dataGridTextBoxColumn6.FormatInfo = null;
            this.dataGridTextBoxColumn6.HeaderText = "发票号";
            this.dataGridTextBoxColumn6.NullText = "";
            this.dataGridTextBoxColumn6.Width = 60;
            // 
            // dataGridTextBoxColumn7
            // 
            this.dataGridTextBoxColumn7.Format = "";
            this.dataGridTextBoxColumn7.FormatInfo = null;
            this.dataGridTextBoxColumn7.HeaderText = "发票日期";
            this.dataGridTextBoxColumn7.NullText = "";
            this.dataGridTextBoxColumn7.Width = 115;
            // 
            // dataGridTextBoxColumn9
            // 
            this.dataGridTextBoxColumn9.Format = "";
            this.dataGridTextBoxColumn9.FormatInfo = null;
            this.dataGridTextBoxColumn9.HeaderText = "供货单位";
            this.dataGridTextBoxColumn9.NullText = "";
            this.dataGridTextBoxColumn9.ReadOnly = true;
            this.dataGridTextBoxColumn9.Width = 150;
            // 
            // dataGridTextBoxColumn5
            // 
            this.dataGridTextBoxColumn5.Format = "";
            this.dataGridTextBoxColumn5.FormatInfo = null;
            this.dataGridTextBoxColumn5.HeaderText = "业务员";
            this.dataGridTextBoxColumn5.NullText = "";
            this.dataGridTextBoxColumn5.ReadOnly = true;
            this.dataGridTextBoxColumn5.Width = 60;
            // 
            // dataGridTextBoxColumn8
            // 
            this.dataGridTextBoxColumn8.Format = "";
            this.dataGridTextBoxColumn8.FormatInfo = null;
            this.dataGridTextBoxColumn8.HeaderText = "送货单号";
            this.dataGridTextBoxColumn8.NullText = "";
            this.dataGridTextBoxColumn8.ReadOnly = true;
            this.dataGridTextBoxColumn8.Width = 70;
            // 
            // dataGridTextBoxColumn51
            // 
            this.dataGridTextBoxColumn51.Format = "";
            this.dataGridTextBoxColumn51.FormatInfo = null;
            this.dataGridTextBoxColumn51.HeaderText = "付款日期";
            this.dataGridTextBoxColumn51.NullText = "";
            this.dataGridTextBoxColumn51.Width = 110;
            // 
            // dataGridTextBoxColumn11
            // 
            this.dataGridTextBoxColumn11.Format = "";
            this.dataGridTextBoxColumn11.FormatInfo = null;
            this.dataGridTextBoxColumn11.HeaderText = "登记时间";
            this.dataGridTextBoxColumn11.NullText = "";
            this.dataGridTextBoxColumn11.ReadOnly = true;
            this.dataGridTextBoxColumn11.Width = 120;
            // 
            // dataGridTextBoxColumn12
            // 
            this.dataGridTextBoxColumn12.Format = "";
            this.dataGridTextBoxColumn12.FormatInfo = null;
            this.dataGridTextBoxColumn12.HeaderText = "登记员";
            this.dataGridTextBoxColumn12.NullText = "";
            this.dataGridTextBoxColumn12.ReadOnly = true;
            this.dataGridTextBoxColumn12.Width = 60;
            // 
            // dataGridTextBoxColumn30
            // 
            this.dataGridTextBoxColumn30.Format = "";
            this.dataGridTextBoxColumn30.FormatInfo = null;
            this.dataGridTextBoxColumn30.HeaderText = "ID";
            this.dataGridTextBoxColumn30.NullText = "";
            this.dataGridTextBoxColumn30.ReadOnly = true;
            this.dataGridTextBoxColumn30.Width = 0;
            // 
            // myDataGrid2
            // 
            this.myDataGrid2.BackgroundColor = System.Drawing.Color.White;
            this.myDataGrid2.CaptionVisible = false;
            this.myDataGrid2.DataMember = "";
            this.myDataGrid2.Dock = System.Windows.Forms.DockStyle.Fill;
            this.myDataGrid2.HeaderForeColor = System.Drawing.SystemColors.ControlText;
            this.myDataGrid2.Location = new System.Drawing.Point(0, 0);
            this.myDataGrid2.Name = "myDataGrid2";
            this.myDataGrid2.Size = new System.Drawing.Size(735, 92);
            this.myDataGrid2.TabIndex = 3;
            this.myDataGrid2.TableStyles.AddRange(new System.Windows.Forms.DataGridTableStyle[] {
            this.dataGridTableStyle2});
            // 
            // dataGridTableStyle2
            // 
            this.dataGridTableStyle2.DataGrid = this.myDataGrid2;
            this.dataGridTableStyle2.GridColumnStyles.AddRange(new System.Windows.Forms.DataGridColumnStyle[] {
            this.dataGridTextBoxColumn13,
            this.dataGridTextBoxColumn14,
            this.dataGridTextBoxColumn15,
            this.dataGridTextBoxColumn16,
            this.col_yppch,
            this.dataGridTextBoxColumn17,
            this.dataGridTextBoxColumn18,
            this.dataGridTextBoxColumn19,
            this.dataGridTextBoxColumn20,
            this.dataGridTextBoxColumn21,
            this.dataGridTextBoxColumn22,
            this.dataGridTextBoxColumn23,
            this.dataGridTextBoxColumn24,
            this.dataGridTextBoxColumn25,
            this.dataGridTextBoxColumn26,
            this.dataGridTextBoxColumn27,
            this.dataGridTextBoxColumn28,
            this.dataGridTextBoxColumn29});
            this.dataGridTableStyle2.HeaderForeColor = System.Drawing.SystemColors.ControlText;
            this.dataGridTableStyle2.ReadOnly = true;
            // 
            // dataGridTextBoxColumn13
            // 
            this.dataGridTextBoxColumn13.Format = "";
            this.dataGridTextBoxColumn13.FormatInfo = null;
            this.dataGridTextBoxColumn13.HeaderText = "序号";
            this.dataGridTextBoxColumn13.Width = 30;
            // 
            // dataGridTextBoxColumn14
            // 
            this.dataGridTextBoxColumn14.Format = "";
            this.dataGridTextBoxColumn14.FormatInfo = null;
            this.dataGridTextBoxColumn14.HeaderText = "品名";
            this.dataGridTextBoxColumn14.Width = 90;
            // 
            // dataGridTextBoxColumn15
            // 
            this.dataGridTextBoxColumn15.Format = "";
            this.dataGridTextBoxColumn15.FormatInfo = null;
            this.dataGridTextBoxColumn15.HeaderText = "规格";
            this.dataGridTextBoxColumn15.Width = 70;
            // 
            // dataGridTextBoxColumn16
            // 
            this.dataGridTextBoxColumn16.Format = "";
            this.dataGridTextBoxColumn16.FormatInfo = null;
            this.dataGridTextBoxColumn16.HeaderText = "厂家";
            this.dataGridTextBoxColumn16.Width = 70;
            // 
            // dataGridTextBoxColumn17
            // 
            this.dataGridTextBoxColumn17.Format = "";
            this.dataGridTextBoxColumn17.FormatInfo = null;
            this.dataGridTextBoxColumn17.HeaderText = "批号";
            this.dataGridTextBoxColumn17.Width = 60;
            // 
            // dataGridTextBoxColumn18
            // 
            this.dataGridTextBoxColumn18.Format = "";
            this.dataGridTextBoxColumn18.FormatInfo = null;
            this.dataGridTextBoxColumn18.HeaderText = "效期";
            this.dataGridTextBoxColumn18.Width = 60;
            // 
            // dataGridTextBoxColumn19
            // 
            this.dataGridTextBoxColumn19.Format = "";
            this.dataGridTextBoxColumn19.FormatInfo = null;
            this.dataGridTextBoxColumn19.HeaderText = "库位";
            this.dataGridTextBoxColumn19.Width = 0;
            // 
            // dataGridTextBoxColumn20
            // 
            this.dataGridTextBoxColumn20.Format = "";
            this.dataGridTextBoxColumn20.FormatInfo = null;
            this.dataGridTextBoxColumn20.HeaderText = "扣率";
            this.dataGridTextBoxColumn20.Width = 40;
            // 
            // dataGridTextBoxColumn21
            // 
            this.dataGridTextBoxColumn21.Format = "";
            this.dataGridTextBoxColumn21.FormatInfo = null;
            this.dataGridTextBoxColumn21.HeaderText = "进价";
            this.dataGridTextBoxColumn21.Width = 60;
            // 
            // dataGridTextBoxColumn22
            // 
            this.dataGridTextBoxColumn22.Format = "";
            this.dataGridTextBoxColumn22.FormatInfo = null;
            this.dataGridTextBoxColumn22.HeaderText = "批发价";
            this.dataGridTextBoxColumn22.Width = 0;
            // 
            // dataGridTextBoxColumn23
            // 
            this.dataGridTextBoxColumn23.Format = "";
            this.dataGridTextBoxColumn23.FormatInfo = null;
            this.dataGridTextBoxColumn23.HeaderText = "零售价";
            this.dataGridTextBoxColumn23.Width = 60;
            // 
            // dataGridTextBoxColumn24
            // 
            this.dataGridTextBoxColumn24.Format = "";
            this.dataGridTextBoxColumn24.FormatInfo = null;
            this.dataGridTextBoxColumn24.HeaderText = "数量";
            this.dataGridTextBoxColumn24.Width = 50;
            // 
            // dataGridTextBoxColumn25
            // 
            this.dataGridTextBoxColumn25.Format = "";
            this.dataGridTextBoxColumn25.FormatInfo = null;
            this.dataGridTextBoxColumn25.HeaderText = "单位";
            this.dataGridTextBoxColumn25.Width = 30;
            // 
            // dataGridTextBoxColumn26
            // 
            this.dataGridTextBoxColumn26.Format = "";
            this.dataGridTextBoxColumn26.FormatInfo = null;
            this.dataGridTextBoxColumn26.HeaderText = "进货金额";
            this.dataGridTextBoxColumn26.Width = 65;
            // 
            // dataGridTextBoxColumn27
            // 
            this.dataGridTextBoxColumn27.Format = "";
            this.dataGridTextBoxColumn27.FormatInfo = null;
            this.dataGridTextBoxColumn27.HeaderText = "批发金额";
            this.dataGridTextBoxColumn27.Width = 0;
            // 
            // dataGridTextBoxColumn28
            // 
            this.dataGridTextBoxColumn28.Format = "";
            this.dataGridTextBoxColumn28.FormatInfo = null;
            this.dataGridTextBoxColumn28.HeaderText = "零售金额";
            this.dataGridTextBoxColumn28.Width = 65;
            // 
            // dataGridTextBoxColumn29
            // 
            this.dataGridTextBoxColumn29.Format = "";
            this.dataGridTextBoxColumn29.FormatInfo = null;
            this.dataGridTextBoxColumn29.HeaderText = "进零差额";
            this.dataGridTextBoxColumn29.Width = 65;
            // 
            // statusBar1
            // 
            this.statusBar1.Font = new System.Drawing.Font("宋体", 9F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.statusBar1.Location = new System.Drawing.Point(0, 501);
            this.statusBar1.Name = "statusBar1";
            this.statusBar1.Panels.AddRange(new System.Windows.Forms.StatusBarPanel[] {
            this.statusBarPanel1});
            this.statusBar1.ShowPanels = true;
            this.statusBar1.Size = new System.Drawing.Size(968, 24);
            this.statusBar1.TabIndex = 6;
            this.statusBar1.Text = "statusBar1";
            // 
            // statusBarPanel1
            // 
            this.statusBarPanel1.Name = "statusBarPanel1";
            this.statusBarPanel1.Width = 300;
            // 
            // tabControl1
            // 
            this.tabControl1.Controls.Add(this.tabPage1);
            this.tabControl1.Controls.Add(this.tabPage2);
            this.tabControl1.Dock = System.Windows.Forms.DockStyle.Fill;
            this.tabControl1.Location = new System.Drawing.Point(0, 0);
            this.tabControl1.Name = "tabControl1";
            this.tabControl1.SelectedIndex = 0;
            this.tabControl1.Size = new System.Drawing.Size(749, 363);
            this.tabControl1.TabIndex = 9;
            this.tabControl1.SelectedIndexChanged += new System.EventHandler(this.tabControl1_SelectedIndexChanged);
            // 
            // tabPage1
            // 
            this.tabPage1.Controls.Add(this.panel2);
            this.tabPage1.Controls.Add(this.splitter1);
            this.tabPage1.Controls.Add(this.panel1);
            this.tabPage1.Location = new System.Drawing.Point(4, 22);
            this.tabPage1.Name = "tabPage1";
            this.tabPage1.Padding = new System.Windows.Forms.Padding(3);
            this.tabPage1.Size = new System.Drawing.Size(741, 337);
            this.tabPage1.TabIndex = 0;
            this.tabPage1.Text = "单据";
            this.tabPage1.UseVisualStyleBackColor = true;
            // 
            // panel2
            // 
            this.panel2.Controls.Add(this.myDataGrid2);
            this.panel2.Dock = System.Windows.Forms.DockStyle.Fill;
            this.panel2.Location = new System.Drawing.Point(3, 242);
            this.panel2.Name = "panel2";
            this.panel2.Size = new System.Drawing.Size(735, 92);
            this.panel2.TabIndex = 6;
            // 
            // splitter1
            // 
            this.splitter1.Dock = System.Windows.Forms.DockStyle.Top;
            this.splitter1.Location = new System.Drawing.Point(3, 232);
            this.splitter1.Name = "splitter1";
            this.splitter1.Size = new System.Drawing.Size(735, 10);
            this.splitter1.TabIndex = 5;
            this.splitter1.TabStop = false;
            // 
            // panel1
            // 
            this.panel1.Controls.Add(this.dtpfprq);
            this.panel1.Controls.Add(this.myDataGrid1);
            this.panel1.Dock = System.Windows.Forms.DockStyle.Top;
            this.panel1.Location = new System.Drawing.Point(3, 3);
            this.panel1.Name = "panel1";
            this.panel1.Size = new System.Drawing.Size(735, 229);
            this.panel1.TabIndex = 4;
            // 
            // tabPage2
            // 
            this.tabPage2.Controls.Add(this.myDataGrid3);
            this.tabPage2.Location = new System.Drawing.Point(4, 22);
            this.tabPage2.Name = "tabPage2";
            this.tabPage2.Padding = new System.Windows.Forms.Padding(3);
            this.tabPage2.Size = new System.Drawing.Size(741, 337);
            this.tabPage2.TabIndex = 1;
            this.tabPage2.Text = "明细";
            this.tabPage2.UseVisualStyleBackColor = true;
            // 
            // myDataGrid3
            // 
            this.myDataGrid3.AlternatingBackColor = System.Drawing.Color.Gainsboro;
            this.myDataGrid3.BackgroundColor = System.Drawing.Color.White;
            this.myDataGrid3.CaptionVisible = false;
            this.myDataGrid3.DataMember = "";
            this.myDataGrid3.Dock = System.Windows.Forms.DockStyle.Fill;
            this.myDataGrid3.HeaderForeColor = System.Drawing.SystemColors.ControlText;
            this.myDataGrid3.Location = new System.Drawing.Point(3, 3);
            this.myDataGrid3.Name = "myDataGrid3";
            this.myDataGrid3.Size = new System.Drawing.Size(735, 331);
            this.myDataGrid3.TabIndex = 6;
            this.myDataGrid3.TableStyles.AddRange(new System.Windows.Forms.DataGridTableStyle[] {
            this.dataGridTableStyle3});
            // 
            // dataGridTableStyle3
            // 
            this.dataGridTableStyle3.DataGrid = this.myDataGrid3;
            this.dataGridTableStyle3.GridColumnStyles.AddRange(new System.Windows.Forms.DataGridColumnStyle[] {
            this.dataGridTextBoxColumn32,
            this.dataGridTextBoxColumn33,
            this.dataGridTextBoxColumn34,
            this.dataGridTextBoxColumn50,
            this.dataGridTextBoxColumn43,
            this.dataGridTextBoxColumn44,
            this.dataGridTextBoxColumn45,
            this.dataGridTextBoxColumn46,
            this.dataGridTextBoxColumn47,
            this.dataGridTextBoxColumn48,
            this.dataGridTextBoxColumn35,
            this.dataGridTextBoxColumn36,
            this.dataGridTextBoxColumn49,
            this.dataGridTextBoxColumn37,
            this.dataGridTextBoxColumn53,
            this.dataGridTextBoxColumn38,
            this.dataGridTextBoxColumn39,
            this.dataGridTextBoxColumn40,
            this.dataGridTextBoxColumn52,
            this.dataGridTextBoxColumn41,
            this.dataGridTextBoxColumn42});
            this.dataGridTableStyle3.HeaderForeColor = System.Drawing.SystemColors.ControlText;
            // 
            // dataGridTextBoxColumn32
            // 
            this.dataGridTextBoxColumn32.Format = "";
            this.dataGridTextBoxColumn32.FormatInfo = null;
            this.dataGridTextBoxColumn32.HeaderText = "序号";
            this.dataGridTextBoxColumn32.Width = 40;
            // 
            // dataGridTextBoxColumn33
            // 
            this.dataGridTextBoxColumn33.Format = "";
            this.dataGridTextBoxColumn33.FormatInfo = null;
            this.dataGridTextBoxColumn33.HeaderText = "仓库名称";
            this.dataGridTextBoxColumn33.Width = 65;
            // 
            // dataGridTextBoxColumn34
            // 
            this.dataGridTextBoxColumn34.Format = "";
            this.dataGridTextBoxColumn34.FormatInfo = null;
            this.dataGridTextBoxColumn34.HeaderText = "单据号";
            this.dataGridTextBoxColumn34.Width = 60;
            // 
            // dataGridTextBoxColumn50
            // 
            this.dataGridTextBoxColumn50.Format = "";
            this.dataGridTextBoxColumn50.FormatInfo = null;
            this.dataGridTextBoxColumn50.HeaderText = "商品名";
            this.dataGridTextBoxColumn50.Width = 0;
            // 
            // dataGridTextBoxColumn43
            // 
            this.dataGridTextBoxColumn43.Format = "";
            this.dataGridTextBoxColumn43.FormatInfo = null;
            this.dataGridTextBoxColumn43.HeaderText = "品名";
            this.dataGridTextBoxColumn43.Width = 75;
            // 
            // dataGridTextBoxColumn44
            // 
            this.dataGridTextBoxColumn44.Format = "";
            this.dataGridTextBoxColumn44.FormatInfo = null;
            this.dataGridTextBoxColumn44.HeaderText = "规格";
            this.dataGridTextBoxColumn44.Width = 70;
            // 
            // dataGridTextBoxColumn45
            // 
            this.dataGridTextBoxColumn45.Format = "";
            this.dataGridTextBoxColumn45.FormatInfo = null;
            this.dataGridTextBoxColumn45.HeaderText = "厂家";
            this.dataGridTextBoxColumn45.Width = 0;
            // 
            // dataGridTextBoxColumn46
            // 
            this.dataGridTextBoxColumn46.Format = "";
            this.dataGridTextBoxColumn46.FormatInfo = null;
            this.dataGridTextBoxColumn46.HeaderText = "进价";
            this.dataGridTextBoxColumn46.Width = 60;
            // 
            // dataGridTextBoxColumn47
            // 
            this.dataGridTextBoxColumn47.Format = "";
            this.dataGridTextBoxColumn47.FormatInfo = null;
            this.dataGridTextBoxColumn47.HeaderText = "数量";
            this.dataGridTextBoxColumn47.Width = 50;
            // 
            // dataGridTextBoxColumn48
            // 
            this.dataGridTextBoxColumn48.Format = "";
            this.dataGridTextBoxColumn48.FormatInfo = null;
            this.dataGridTextBoxColumn48.HeaderText = "单位";
            this.dataGridTextBoxColumn48.Width = 40;
            // 
            // dataGridTextBoxColumn35
            // 
            this.dataGridTextBoxColumn35.Format = "";
            this.dataGridTextBoxColumn35.FormatInfo = null;
            this.dataGridTextBoxColumn35.HeaderText = "单据日期";
            this.dataGridTextBoxColumn35.Width = 70;
            // 
            // dataGridTextBoxColumn36
            // 
            this.dataGridTextBoxColumn36.Format = "";
            this.dataGridTextBoxColumn36.FormatInfo = null;
            this.dataGridTextBoxColumn36.HeaderText = "单据类别";
            this.dataGridTextBoxColumn36.Width = 75;
            // 
            // dataGridTextBoxColumn49
            // 
            this.dataGridTextBoxColumn49.Format = "";
            this.dataGridTextBoxColumn49.FormatInfo = null;
            this.dataGridTextBoxColumn49.HeaderText = "进货金额";
            this.dataGridTextBoxColumn49.Width = 65;
            // 
            // dataGridTextBoxColumn37
            // 
            this.dataGridTextBoxColumn37.Format = "";
            this.dataGridTextBoxColumn37.FormatInfo = null;
            this.dataGridTextBoxColumn37.HeaderText = "发票号";
            this.dataGridTextBoxColumn37.Width = 75;
            // 
            // dataGridTextBoxColumn53
            // 
            this.dataGridTextBoxColumn53.Format = "";
            this.dataGridTextBoxColumn53.FormatInfo = null;
            this.dataGridTextBoxColumn53.HeaderText = "发票日期";
            this.dataGridTextBoxColumn53.NullText = "";
            this.dataGridTextBoxColumn53.Width = 110;
            // 
            // dataGridTextBoxColumn38
            // 
            this.dataGridTextBoxColumn38.Format = "";
            this.dataGridTextBoxColumn38.FormatInfo = null;
            this.dataGridTextBoxColumn38.HeaderText = "供货单位";
            this.dataGridTextBoxColumn38.NullText = "";
            this.dataGridTextBoxColumn38.Width = 75;
            // 
            // dataGridTextBoxColumn39
            // 
            this.dataGridTextBoxColumn39.Format = "";
            this.dataGridTextBoxColumn39.FormatInfo = null;
            this.dataGridTextBoxColumn39.HeaderText = "业务员";
            this.dataGridTextBoxColumn39.Width = 75;
            // 
            // dataGridTextBoxColumn40
            // 
            this.dataGridTextBoxColumn40.Format = "";
            this.dataGridTextBoxColumn40.FormatInfo = null;
            this.dataGridTextBoxColumn40.HeaderText = "送货单号";
            this.dataGridTextBoxColumn40.Width = 75;
            // 
            // dataGridTextBoxColumn52
            // 
            this.dataGridTextBoxColumn52.Format = "";
            this.dataGridTextBoxColumn52.FormatInfo = null;
            this.dataGridTextBoxColumn52.HeaderText = "付款日期";
            this.dataGridTextBoxColumn52.NullText = "";
            this.dataGridTextBoxColumn52.Width = 110;
            // 
            // dataGridTextBoxColumn41
            // 
            this.dataGridTextBoxColumn41.Format = "";
            this.dataGridTextBoxColumn41.FormatInfo = null;
            this.dataGridTextBoxColumn41.HeaderText = "登记时间";
            this.dataGridTextBoxColumn41.Width = 75;
            // 
            // dataGridTextBoxColumn42
            // 
            this.dataGridTextBoxColumn42.Format = "";
            this.dataGridTextBoxColumn42.FormatInfo = null;
            this.dataGridTextBoxColumn42.HeaderText = "登记员";
            this.dataGridTextBoxColumn42.Width = 75;
            // 
            // panel3
            // 
            this.panel3.Controls.Add(this.panel6);
            this.panel3.Controls.Add(this.panel5);
            this.panel3.Dock = System.Windows.Forms.DockStyle.Left;
            this.panel3.Location = new System.Drawing.Point(0, 138);
            this.panel3.Name = "panel3";
            this.panel3.Size = new System.Drawing.Size(214, 363);
            this.panel3.TabIndex = 10;
            // 
            // panel6
            // 
            this.panel6.Controls.Add(this.dataGridView1);
            this.panel6.Dock = System.Windows.Forms.DockStyle.Fill;
            this.panel6.Location = new System.Drawing.Point(0, 0);
            this.panel6.Name = "panel6";
            this.panel6.Size = new System.Drawing.Size(214, 331);
            this.panel6.TabIndex = 2;
            // 
            // dataGridView1
            // 
            this.dataGridView1.AllowUserToAddRows = false;
            this.dataGridView1.AllowUserToResizeRows = false;
            this.dataGridView1.BackgroundColor = System.Drawing.Color.White;
            this.dataGridView1.Columns.AddRange(new System.Windows.Forms.DataGridViewColumn[] {
            this.Column1,
            this.进货金额,
            this.ghdwid});
            this.dataGridView1.Dock = System.Windows.Forms.DockStyle.Fill;
            this.dataGridView1.Location = new System.Drawing.Point(0, 0);
            this.dataGridView1.Name = "dataGridView1";
            this.dataGridView1.RowHeadersVisible = false;
            this.dataGridView1.RowTemplate.Height = 23;
            this.dataGridView1.Size = new System.Drawing.Size(214, 331);
            this.dataGridView1.TabIndex = 0;
            this.dataGridView1.CellClick += new System.Windows.Forms.DataGridViewCellEventHandler(this.dataGridView1_CellClick);
            this.dataGridView1.CurrentCellChanged += new System.EventHandler(this.dataGridView1_CurrentCellChanged);
            this.dataGridView1.CellContentClick += new System.Windows.Forms.DataGridViewCellEventHandler(this.dataGridView1_CellContentClick);
            // 
            // Column1
            // 
            this.Column1.DataPropertyName = "供货单位";
            this.Column1.HeaderText = "供货单位";
            this.Column1.Name = "Column1";
            this.Column1.ReadOnly = true;
            this.Column1.Width = 150;
            // 
            // 进货金额
            // 
            this.进货金额.DataPropertyName = "进货金额";
            this.进货金额.HeaderText = "未付款";
            this.进货金额.Name = "进货金额";
            this.进货金额.ReadOnly = true;
            this.进货金额.Width = 90;
            // 
            // ghdwid
            // 
            this.ghdwid.DataPropertyName = "ghdwid";
            this.ghdwid.HeaderText = "ghdwid";
            this.ghdwid.Name = "ghdwid";
            this.ghdwid.ReadOnly = true;
            this.ghdwid.Visible = false;
            // 
            // panel5
            // 
            this.panel5.Controls.Add(this.butexcel_dw);
            this.panel5.Dock = System.Windows.Forms.DockStyle.Bottom;
            this.panel5.Location = new System.Drawing.Point(0, 331);
            this.panel5.Name = "panel5";
            this.panel5.Size = new System.Drawing.Size(214, 32);
            this.panel5.TabIndex = 1;
            // 
            // butexcel_dw
            // 
            this.butexcel_dw.Dock = System.Windows.Forms.DockStyle.Fill;
            this.butexcel_dw.Location = new System.Drawing.Point(0, 0);
            this.butexcel_dw.Name = "butexcel_dw";
            this.butexcel_dw.Size = new System.Drawing.Size(214, 32);
            this.butexcel_dw.TabIndex = 50;
            this.butexcel_dw.Text = "导出EXCEL";
            this.butexcel_dw.Click += new System.EventHandler(this.butexcel_dw_Click);
            // 
            // splitter2
            // 
            this.splitter2.BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle;
            this.splitter2.Location = new System.Drawing.Point(214, 138);
            this.splitter2.Name = "splitter2";
            this.splitter2.Size = new System.Drawing.Size(5, 363);
            this.splitter2.TabIndex = 11;
            this.splitter2.TabStop = false;
            // 
            // panel4
            // 
            this.panel4.Controls.Add(this.tabControl1);
            this.panel4.Dock = System.Windows.Forms.DockStyle.Fill;
            this.panel4.Location = new System.Drawing.Point(219, 138);
            this.panel4.Name = "panel4";
            this.panel4.Size = new System.Drawing.Size(749, 363);
            this.panel4.TabIndex = 12;
            // 
            // timer1
            // 
            this.timer1.Enabled = true;
            this.timer1.Interval = 10;
            this.timer1.Tick += new System.EventHandler(this.timer1_Tick);
            // 
            // col_yppch
            // 
            this.col_yppch.Format = "";
            this.col_yppch.FormatInfo = null;
            this.col_yppch.HeaderText = "批次号";
            this.col_yppch.Width = 75;
            // 
            // Frmyfkpz
            // 
            this.AutoScaleBaseSize = new System.Drawing.Size(6, 14);
            this.ClientSize = new System.Drawing.Size(968, 525);
            this.Controls.Add(this.panel4);
            this.Controls.Add(this.splitter2);
            this.Controls.Add(this.panel3);
            this.Controls.Add(this.statusBar1);
            this.Controls.Add(this.groupBox2);
            this.Controls.Add(this.groupBox1);
            this.Name = "Frmyfkpz";
            this.Text = "采购入库单付款确认";
            this.WindowState = System.Windows.Forms.FormWindowState.Maximized;
            this.Load += new System.EventHandler(this.Frmyfkpz_Load);
            this.groupBox1.ResumeLayout(false);
            this.groupBox2.ResumeLayout(false);
            this.groupBox2.PerformLayout();
            ((System.ComponentModel.ISupportInitialize)(this.myDataGrid1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.myDataGrid2)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.statusBarPanel1)).EndInit();
            this.tabControl1.ResumeLayout(false);
            this.tabPage1.ResumeLayout(false);
            this.panel2.ResumeLayout(false);
            this.panel1.ResumeLayout(false);
            this.tabPage2.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.myDataGrid3)).EndInit();
            this.panel3.ResumeLayout(false);
            this.panel6.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.dataGridView1)).EndInit();
            this.panel5.ResumeLayout(false);
            this.panel4.ResumeLayout(false);
            this.ResumeLayout(false);

        }
        #endregion

        /// <summary>
        /// 应用程序的主入口点。
        /// </summary>


        private void Frmyfkpz_Load(object sender, System.EventArgs e)
        {
            //初始化
            DataTable myTb = new DataTable();
            myTb.TableName = "Tb";
            for (int i = 0; i <= this.myDataGrid1.TableStyles[0].GridColumnStyles.Count - 1; i++)
            {
                if (this.myDataGrid1.TableStyles[0].GridColumnStyles[i].GetType().ToString() == "System.Windows.Forms.DataGridBoolColumn")
                {
                    myTb.Columns.Add(this.myDataGrid1.TableStyles[0].GridColumnStyles[i].HeaderText, typeof(bool));
                }

                else
                {
                    myTb.Columns.Add(this.myDataGrid1.TableStyles[0].GridColumnStyles[i].HeaderText, Type.GetType("System.String"));
                }

                this.myDataGrid1.TableStyles[0].GridColumnStyles[i].MappingName = this.myDataGrid1.TableStyles[0].GridColumnStyles[i].HeaderText;
            }


            this.myDataGrid1.DataSource = myTb;
            this.myDataGrid1.TableStyles[0].MappingName = "Tb";

            //初始化
            DataTable myTb1 = new DataTable();
            myTb1.TableName = "Tb1";
            for (int i = 0; i <= this.myDataGrid2.TableStyles[0].GridColumnStyles.Count - 1; i++)
            {
                if (this.myDataGrid2.TableStyles[0].GridColumnStyles[i].GetType().ToString() == "System.Windows.Forms.DataGridBoolColumn")
                {
                    myTb1.Columns.Add(this.myDataGrid2.TableStyles[0].GridColumnStyles[i].HeaderText, Type.GetType("System.Int16"));
                    this.myDataGrid2.TableStyles[0].GridColumnStyles[i].NullText = "0";
                }
                else
                {
                    myTb1.Columns.Add(this.myDataGrid2.TableStyles[0].GridColumnStyles[i].HeaderText, Type.GetType("System.String"));
                    this.myDataGrid2.TableStyles[0].GridColumnStyles[i].NullText = "";
                }
                this.myDataGrid2.TableStyles[0].GridColumnStyles[i].MappingName = this.myDataGrid2.TableStyles[0].GridColumnStyles[i].HeaderText;

            }
            this.myDataGrid2.DataSource = myTb1;
            this.myDataGrid2.TableStyles[0].MappingName = "Tb1";

            FunBase.CsDataGrid(this.myDataGrid3, this.myDataGrid3.TableStyles[0], "Tb3");


            DateTime dt = DateManager.ServerDateTimeByDBType(InstanceForm.BDatabase);
            this.dtpfprq1.Value = dt;
            this.dtpfprq2.Value = dt;
            this.dtpdjsj1.Value = dt;
            this.dtpdjsj2.Value = dt;

            if (_menuTag.Function_Name == "Fun_ts_yf_fkqr" && YpConfig.是否药库(InstanceForm.BCurrentDept.DeptId, InstanceForm.BDatabase) == true)
            {
                butref.Enabled = false;
                butfk.Enabled = false;
                button1.Enabled = false;
            }

            if (_menuTag.Function_Name == "Fun_ts_yk_fkqr" && YpConfig.是否药库(InstanceForm.BCurrentDept.DeptId, InstanceForm.BDatabase) == false)
            {
                butref.Enabled = false;
                butfk.Enabled = false;
                button1.Enabled = false;
            }

            Yp.AddCmbYjks(false, InstanceForm.BCurrentDept.DeptId, cmbyjks, InstanceForm.BDatabase);
        }

        private void chkshdh_CheckedChanged(object sender, System.EventArgs e)
        {
            this.txtshdh.Enabled = chkshdh.Checked == true ? true : false;
            this.txtfph.Enabled = chkfph.Checked == true ? true : false;
            this.txtdjh.Enabled = chkdjh.Checked == true ? true : false;
            this.dtpfprq1.Enabled = chkfprq.Checked == true ? true : false;
            this.dtpfprq2.Enabled = chkfprq.Checked == true ? true : false;
            this.dtpdjsj1.Enabled = chkdjsj.Checked == true ? true : false;
            this.dtpdjsj2.Enabled = chkdjsj.Checked == true ? true : false;
            this.cmbywy.Enabled = chkywy.Checked == true ? true : false;
            this.txtypmc.Enabled = chkypmc.Checked == true ? true : false;

            this.dtpfkrq1.Enabled = chkfkrq.Checked == true ? true : false;
            this.dtpfkrq2.Enabled = chkfkrq.Checked == true ? true : false;
        }

        private void rdo2_CheckedChanged(object sender, System.EventArgs e)
        {
            DataTable tb = (DataTable)this.myDataGrid1.DataSource;
            DataTable tb1 = (DataTable)this.myDataGrid2.DataSource;
            tb.Rows.Clear();
            tb1.Rows.Clear();
            if (this.rdo2.Checked == true)
            {
                this.myDataGrid1.TableStyles[0].GridColumnStyles["付款"].ReadOnly = true;
                this.dataGridTableStyle1.ForeColor = System.Drawing.Color.FromArgb(((System.Byte)(0)), ((System.Byte)(0)), ((System.Byte)(192)));
                this.butfk.Enabled = false;
                this.dataGridView1.Columns["进货金额"].HeaderText = "已付款";
            }
            if (this.rdo1.Checked == true)
            {
                this.myDataGrid1.TableStyles[0].GridColumnStyles["付款"].ReadOnly = false;
                this.dataGridTableStyle1.ForeColor = System.Drawing.Color.Black;
                this.butfk.Enabled = true;
                this.dataGridView1.Columns["进货金额"].HeaderText = "未付款";
            }
            if (this.rdoall.Checked == true)
            {
                this.myDataGrid1.TableStyles[0].GridColumnStyles["付款"].ReadOnly = false;
                this.dataGridTableStyle1.ForeColor = System.Drawing.Color.Black;
                this.butfk.Enabled = false;
                this.dataGridView1.Columns["进货金额"].HeaderText = "进货金额";

            }
            this.statusBar1.Panels[0].Text = "";

            butref_Click(sender, e);

        }

        private void butref_Click(object sender, System.EventArgs e)
        {
            //if (Convert.ToInt32(Convertor.IsNull(this.txtghdw.Tag,"0"))==0){ MessageBox.Show("请输入供货单位");txtghdw.Focus();return;}
            if (chkfph.Checked == true && txtfph.Text.Trim() == "") { MessageBox.Show("请输入发票号"); txtfph.Focus(); return; }
            if (chkshdh.Checked == true && txtshdh.Text.Trim() == "") { MessageBox.Show("请输入送货单号"); txtshdh.Focus(); return; }
            if (chkdjh.Checked == true && txtdjh.Text.Trim() == "") { MessageBox.Show("请输入单据号"); txtdjh.Focus(); return; }
            try
            {
                int zt = 2;
                if (rdo1.Checked == true) zt = 0;
                if (rdo2.Checked == true) zt = 1;
                ParameterEx[] parameters = new ParameterEx[16];
                parameters[0].Text = "@fkzt";
                parameters[0].Value = zt;
                parameters[1].Text = "@wldw";
                parameters[1].Value = Convert.ToInt32(Convertor.IsNull(this.txtghdw.Tag, "0"));
                parameters[2].Text = "@fph";
                parameters[2].Value = chkfph.Checked == true ? txtfph.Text.Trim() : "";
                parameters[3].Text = "@shdh";
                parameters[3].Value = chkshdh.Checked == true ? txtshdh.Text.Trim() : "";
                parameters[4].Text = "@djh";
                parameters[4].Value = chkdjh.Checked == true ? Convert.ToInt64(Convertor.IsNull(txtdjh.Text, "0")) : 0;
                parameters[5].Text = "@dtpfprq1";
                parameters[5].Value = chkfprq.Checked == true ? dtpfprq1.Value.ToShortDateString() : "";
                parameters[6].Text = "@dtpfprq2";
                parameters[6].Value = chkfprq.Checked == true ? dtpfprq2.Value.ToShortDateString() : "";
                parameters[7].Text = "@dtpdjsj1";
                parameters[7].Value = chkdjsj.Checked == true ? dtpdjsj1.Value.ToShortDateString() : "";
                parameters[8].Text = "@dtpdjsj2";
                parameters[8].Value = chkdjsj.Checked == true ? dtpdjsj2.Value.ToShortDateString() : "";
                parameters[9].Text = "@deptid";
                parameters[9].Value = Convert.ToInt32(cmbyjks.SelectedValue);
                parameters[10].Text = "@ywy";
                parameters[10].Value = chkywy.Checked == true ? Convert.ToInt32(Convertor.IsNull(cmbywy.SelectedValue, "0")) : 0;
                parameters[11].Text = "@deptid_ck";
                parameters[11].Value = Convert.ToInt32(Convertor.IsNull(cmbck.SelectedValue, "0"));
                parameters[12].Text = "@bmx";
                parameters[12].Value = tabControl1.SelectedTab == tabPage1 ? 0 : 1;
                parameters[13].Text = "@cjid";
                parameters[13].Value = chkypmc.Checked == true ? Convertor.IsNull(txtypmc.Tag, "0") : "0";
                parameters[14].Text = "@dtpfkrq1";
                parameters[14].Value = chkfkrq.Checked == true ? dtpfkrq1.Value.ToShortDateString() : "";
                parameters[15].Text = "@dtpfkrq2";
                parameters[15].Value = chkfkrq.Checked == true ? dtpfkrq2.Value.ToShortDateString() : "";

                DataTable tb = InstanceForm.BDatabase.GetDataTable("sp_yk_select_FKDJCX", parameters, 30);

                //DataSet dset = new DataSet();
                //DatabaseAccess.AdapterFillDataSet(DatabaseType.IbmDb2, "sp_yk_select_FKDJCX", parameters, 30, dset, "sfmx");

                //DataTable tb = dset.Tables[0];
                FunBase.AddRowtNo(tb);

                if (tabControl1.SelectedTab == tabPage1)
                {
                    DataTable myTb = (DataTable)this.myDataGrid1.DataSource;
                    myTb.Rows.Clear();
                    tb.TableName = "Tb";
                    this.myDataGrid1.DataSource = tb;
                    this.myDataGrid1.TableStyles[0].MappingName = "Tb";
                }
                else
                {
                    DataTable myTb = (DataTable)this.myDataGrid3.DataSource;
                    myTb.Rows.Clear();
                    tb.TableName = "Tb3";
                    this.myDataGrid3.DataSource = tb;
                    this.myDataGrid3.TableStyles[0].MappingName = "Tb3";
                }

                //BaseFun.myGridSelect(this.myDataGrid1,this.myDataGrid1.TableStyles[0].GridColumnStyles);

                decimal sumje = 0;
                for (int i = 0; i <= tb.Rows.Count - 1; i++)
                {
                    sumje = sumje + Convert.ToDecimal(Convertor.IsNull(tb.Rows[i]["进货金额"], "0"));
                    if (tabControl1.SelectedTab == tabPage1) tb.Rows[i]["付款"] = (short)Convert.ToInt16(tb.Rows[i]["付款"]);
                }
                if (this.rdo1.Checked == true)
                    this.statusBar1.Panels[0].Text = "未付金额  " + sumje.ToString("0.00");
                if (this.rdo2.Checked == true)
                    this.statusBar1.Panels[0].Text = "已付金额  " + sumje.ToString("0.00");
                if (this.rdoall.Checked == true)
                    this.statusBar1.Panels[0].Text = "进货金额  " + sumje.ToString("0.00");

                this.myDataGrid1.ReadOnly = false;
                this.dtpfprq.Visible = false;


                parameters[1].Value = 0;
                parameters[12].Value = 2;
                DataTable tb2 = InstanceForm.BDatabase.GetDataTable("sp_yk_select_FKDJCX", parameters, 30);
                decimal sumjeX = Convert.ToDecimal(Convertor.IsNull(tb2.Compute("sum(进货金额)", ""), "0"));

                if (SumJe != sumjeX)
                {
                    this.dataGridView1.DataSource = tb2;
                    SumJe = Convert.ToDecimal(Convertor.IsNull(tb2.Compute("sum(进货金额)", ""), "0"));
                }


            }
            catch (System.Exception err)
            {
                MessageBox.Show(err.ToString());
            }
        }


        //弹出输入框
        private void TextKeyUp(object sender, KeyEventArgs e)//KeyEventArgs
        {
            int nkey = Convert.ToInt32(e.KeyCode);
            Control control = (Control)sender;

            if (control.Text.Trim() == "")
            {
                control.Text = "";
                control.Tag = "0";
            }

            if ((nkey >= 65 && nkey <= 90) || (nkey >= 48 && nkey <= 57) || (nkey >= 96 && nkey <= 105) || nkey == 8 || nkey == 32 || nkey == 46 || (nkey == 13 && (Convert.ToString(control.Tag) == "0" || Convert.ToString(control.Tag) == "")))
            {

            }
            else
            {
                return;
            }

            string[] GrdMappingName;
            int[] GrdWidth;
            string[] sfield;
            string ssql = "";
            DataRow row;

            Point point = new Point(this.Location.X + control.Location.X, this.Location.Y + control.Location.Y + control.Height * 3);
            switch (control.TabIndex)
            {
                case 0:
                    if (control.Text.Trim() == "") return;
                    GrdMappingName = new string[] { "id", "行号", "供货商", "拼音码", "五笔码" };
                    GrdWidth = new int[] { 0, 50, 200, 100, 100 };
                    sfield = new string[] { "wbm", "pym", "", "", "" };
                    ssql = "select ID,0 rowno,ghdwmc,pym,wbm from yp_ghdw WHERE ID<>0 ";
                    TrasenFrame.Forms.Fshowcard f1 = new TrasenFrame.Forms.Fshowcard(GrdMappingName, GrdWidth, sfield, FilterType.拼音, control.Text.Trim(), ssql);
                    f1.Location = point;
                    f1.ShowDialog(this);
                    row = f1.dataRow;
                    if (row != null)
                    {
                        control.Text = row["ghdwmc"].ToString();
                        control.Tag = row["id"].ToString();
                        Yp.AddcmbYwy(Convert.ToInt32(control.Tag), cmbywy, InstanceForm.BDatabase);
                    }
                    break;
                case 46:
                    if (control.Text.Trim() == "") return;
                    Yp.frmShowCard(sender, ShowCardType.包含在科室管理类型中的药品字典, 0, point, Convert.ToInt32(Convertor.IsNull(cmbck.SelectedValue, "0")), InstanceForm.BDatabase);
                    if (Convertor.IsNull(control.Tag, "0") != "0")
                    {
                        Ypcj cj = new Ypcj(Convert.ToInt32(Convertor.IsNull(control.Tag, "0")), InstanceForm.BDatabase);
                        txtypmc.Text = cj.S_YPPM;
                        txtypmc.Tag = cj.CJID.ToString();
                        this.SelectNextControl((Control)sender, true, false, true, true);
                        //FindRecord(cj.CJID, 0);
                    }
                    break;
            }

        }

        private void butfk_Click(object sender, System.EventArgs e)
        {
            if (MessageBox.Show(this, "您 [确定] 要对当前选定采购单进行付款吗?", "确认", MessageBoxButtons.YesNo) == DialogResult.No) return;

            try
            {
                InstanceForm.BDatabase.BeginTransaction();

                DataTable tb = (DataTable)this.myDataGrid1.DataSource;
                for (int i = 0; i <= tb.Rows.Count - 1; i++)
                {
                    if (Convert.ToInt32(tb.Rows[i]["付款"]) == 1)
                    {
                        string fph = tb.Rows[i]["发票号"].ToString().Trim();
                        string fprq = tb.Rows[i]["发票日期"].ToString().Trim();
                        if (fph == "" || fprq == "") throw new Exception("必须输入发票号和发票日期");
                        Yk_dj_djmx.Fk(new Guid(Convertor.IsNull(tb.Rows[i]["id"], Guid.Empty.ToString())), tb.Rows[i]["发票号"].ToString(), tb.Rows[i]["发票日期"].ToString(), InstanceForm.BDatabase);
                    }
                }

                InstanceForm.BDatabase.CommitTransaction();

                this.butref_Click(sender, e);
            }

            catch (System.Exception err)
            {
                InstanceForm.BDatabase.RollbackTransaction();
                MessageBox.Show(err.Message, "提示", MessageBoxButtons.OK, MessageBoxIcon.Warning);
            }
        }

        private void button1_Click(object sender, System.EventArgs e)
        {
            //if (this.myDataGrid1.CurrentCell == null) return;
            DataTable tb = (DataTable)this.myDataGrid1.DataSource;
            if (tb == null) return;
            int nrow = this.myDataGrid1.CurrentCell.RowNumber;

            if (nrow > tb.Rows.Count - 1) return;
            if (MessageBox.Show(this, "您确认要 [取消] 对当前选定采购单的付款吗?", "确认", MessageBoxButtons.YesNo) == DialogResult.No) return;

            try
            {
                InstanceForm.BDatabase.BeginTransaction();

                if (Convert.ToInt32(tb.Rows[nrow]["付款"]) == 1)
                {
                    Yk_dj_djmx.UFk(new Guid(Convertor.IsNull(tb.Rows[nrow]["id"], Guid.Empty.ToString())), InstanceForm.BDatabase);
                }

                InstanceForm.BDatabase.CommitTransaction();
                this.butref_Click(sender, e);
            }
            catch (System.Exception err)
            {
                InstanceForm.BDatabase.RollbackTransaction();
                MessageBox.Show(err.Message);
            }
        }

        private void myDataGrid1_CurrentCellChanged(object sender, System.EventArgs e)
        {
            try
            {
                //this.myDataGrid1.Select(this.myDataGrid1.CurrentCell.RowNumber);

                int nrow = this.myDataGrid1.CurrentCell.RowNumber;
                int ncol = this.myDataGrid1.CurrentCell.ColumnNumber;

                DataTable tb = (DataTable)this.myDataGrid1.DataSource;
                DataTable tbmx = (DataTable)this.myDataGrid2.DataSource;
                tbmx.Rows.Clear();

                if (nrow > tb.Rows.Count - 1)
                    this.myDataGrid1.ReadOnly = true;
                else
                    this.myDataGrid1.ReadOnly = false;

                if (nrow > tb.Rows.Count - 1) return;

                long djh = Convert.ToInt64(Convertor.IsNull(tb.Rows[nrow]["单据号"], "0"));

                tbmx = Yk_dj_djmx.SelectFk_Djmx(new Guid(Convertor.IsNull(tb.Rows[nrow]["id"], "0")), InstanceForm.BDatabase);
                decimal sumjhje = 0;
                decimal sumpfje = 0;
                decimal sumlsje = 0;
                decimal sumjlce = 0;
                for (int i = 0; i <= tbmx.Rows.Count - 1; i++)
                {
                    sumjhje = sumjhje + Convert.ToDecimal(tbmx.Rows[i]["进货金额"]);
                    sumpfje = sumpfje + Convert.ToDecimal(tbmx.Rows[i]["批发金额"]);
                    sumlsje = sumlsje + Convert.ToDecimal(tbmx.Rows[i]["零售金额"]);
                    sumjlce = sumjlce + Convert.ToDecimal(tbmx.Rows[i]["进零差额"]);
                }
                DataRow row = tbmx.NewRow();
                row["序号"] = "合计";
                row["进货金额"] = sumjhje.ToString("0.00");
                row["批发金额"] = sumpfje.ToString("0.00");
                row["零售金额"] = sumlsje.ToString("0.00");
                row["进零差额"] = sumjlce.ToString("0.00");
                tbmx.Rows.Add(row);
                tbmx.TableName = "Tb1";
                FunBase.AddRowtNo(tbmx);
                this.myDataGrid2.DataSource = tbmx;
                this.myDataGrid2.TableStyles[0].MappingName = "Tb1";

                string columnName = this.myDataGrid1.TableStyles[0].GridColumnStyles[ncol].HeaderText.Trim();
                this.dtpfprq.Visible = false;
                if (columnName.Trim() == "发票日期")
                {
                    if (nrow > tb.Rows.Count - 1) return;
                    if (djh == 0) return;
                    this.dtpfprq.Visible = true;
                    this.dtpfprq.Left = this.myDataGrid1.GetCellBounds(nrow, ncol).Left + this.myDataGrid1.Left;
                    this.dtpfprq.Top = this.myDataGrid1.GetCellBounds(nrow, ncol).Top + this.myDataGrid1.Top;
                    this.dtpfprq.Width = this.myDataGrid1.GetCellBounds(nrow, ncol).Width;
                    ////this.myDataGrid1.Enabled = false;
                    //dtpfprq.Select();
                    //dtpfprq.Focus();
                    
                    return;
                }

            }
            catch (System.Exception err)
            {
                MessageBox.Show("发生错误" + err.Message);
            }

        }

        private void butclose_Click(object sender, System.EventArgs e)
        {
            this.Close();
        }


        private void butprint_Click(object sender, System.EventArgs e)
        {
            if (tabControl1.SelectedTab == tabPage1)
            {
                try
                {
                    string tjtj = "";
                    string titletext = "";
                    if (this.chkdjsj.Checked == true)
                        tjtj = "登记时间从 " + dtpdjsj1.Value.ToShortDateString() + " 到 " + dtpdjsj2.Value.ToShortDateString() + "";
                    if (this.chkfprq.Checked == true)
                        tjtj = tjtj + "   发票日期从 " + dtpfprq1.Value.ToShortDateString() + " 到 " + dtpfprq2.Value.ToShortDateString() + "";
                    titletext = this.rdo1.Checked == true ? "未付款情况表" : "已付款情况表";
                    DataTable tb = (DataTable)this.myDataGrid1.DataSource;
                    ts_Yk_ReportView.Dataset1 Dset = new ts_Yk_ReportView.Dataset1(); DataRow myrow;
                    for (int i = 0; i <= tb.Rows.Count - 1; i++)
                    {
                        myrow = Dset.付款情况表.NewRow();
                        myrow["xh"] = Convert.ToInt32(tb.Rows[i]["序号"]);
                        myrow["djh"] = Convert.ToString(tb.Rows[i]["单据号"]);
                        myrow["djrq"] = Convert.ToString(tb.Rows[i]["单据日期"]);
                        myrow["djlb"] = Convert.ToString(tb.Rows[i]["单据类别"]);
                        myrow["jhje"] = Convert.ToString(tb.Rows[i]["进货金额"]);
                        myrow["fph"] = Convert.ToString(tb.Rows[i]["发票号"]);
                        myrow["fprq"] = Convert.ToString(tb.Rows[i]["发票日期"]);
                        myrow["shdh"] = Convert.ToString(tb.Rows[i]["送货单号"]);
                        myrow["ghdw"] = Convert.ToString(tb.Rows[i]["供货单位"]);
                        myrow["ywy"] = Convert.ToString(tb.Rows[i]["业务员"]);
                        myrow["djsj"] = Convert.ToString(tb.Rows[i]["登记时间"]);
                        myrow["djy"] = Convert.ToString(tb.Rows[i]["登记员"]);
                        Dset.付款情况表.Rows.Add(myrow);

                    }

                    ParameterEx[] parameters = new ParameterEx[3];
                    parameters[0].Text = "tjtj";
                    parameters[0].Value = tjtj.Trim();
                    parameters[1].Text = "ghdw";
                    parameters[1].Value = txtghdw.Text.Trim();
                    parameters[2].Text = "TITLETEXT";
                    parameters[2].Value = TrasenFrame.Classes.Constant.HospitalName + "(" + InstanceForm.BCurrentDept.DeptName + ")" + titletext.Trim();


                    TrasenFrame.Forms.FrmReportView f = new TrasenFrame.Forms.FrmReportView(Dset.付款情况表, Constant.ApplicationDirectory + "\\Report\\YK_付款情况表.rpt", parameters);
                    if (f.LoadReportSuccess) f.Show(); else f.Dispose();
                }
                catch (System.Exception err)
                {
                    MessageBox.Show(err.Message);
                }
            }
            else
            {
                try
                {
                    //生成会报错 暂时屏蔽该段代码
                    //string tjtj = "";
                    //string titletext = "";
                    //if (this.chkdjsj.Checked == true)
                    //    tjtj = "登记时间从 " + dtpdjsj1.Value.ToShortDateString() + " 到 " + dtpdjsj2.Value.ToShortDateString() + "";
                    //if (this.chkfprq.Checked == true)
                    //    tjtj = tjtj + "   发票日期从 " + dtpfprq1.Value.ToShortDateString() + " 到 " + dtpfprq2.Value.ToShortDateString() + "";
                    //titletext = this.rdo1.Checked == true ? "未付款情况表" : "已付款情况表";
                    //DataTable tb = (DataTable)this.myDataGrid3.DataSource;
                    //ts_Yk_ReportView.Dataset1 Dset = new ts_Yk_ReportView.Dataset1(); DataRow myrow;
                    //for (int i = 0; i <= tb.Rows.Count - 1; i++)
                    //{
                    //    myrow = Dset.付款情况表明细.NewRow();
                    //    myrow["xh"] = Convert.ToInt32(tb.Rows[i]["序号"]);
                    //    myrow["djh"] = Convert.ToString(tb.Rows[i]["单据号"]);
                    //    myrow["djrq"] = Convert.ToString(tb.Rows[i]["单据日期"]);
                    //    myrow["djlb"] = Convert.ToString(tb.Rows[i]["单据类别"]);
                    //    myrow["jhje"] = Convert.ToString(tb.Rows[i]["进货金额"]);
                    //    myrow["fph"] = Convert.ToString(tb.Rows[i]["发票号"]);
                    //    myrow["fprq"] = Convert.ToString(tb.Rows[i]["发票日期"]);
                    //    myrow["shdh"] = Convert.ToString(tb.Rows[i]["送货单号"]);
                    //    myrow["ghdw"] = Convert.ToString(tb.Rows[i]["供货单位"]);
                    //    myrow["ywy"] = Convert.ToString(tb.Rows[i]["业务员"]);
                    //    myrow["djsj"] = Convert.ToString(tb.Rows[i]["登记时间"]);
                    //    myrow["djy"] = Convert.ToString(tb.Rows[i]["登记员"]);
                    //    myrow["pm"] = Convert.ToString(tb.Rows[i]["品名"]);
                    //    myrow["spm"] = Convert.ToString(tb.Rows[i]["商品名"]);
                    //    myrow["gg"] = Convert.ToString(tb.Rows[i]["规格"]);
                    //    myrow["cj"] = Convert.ToString(tb.Rows[i]["厂家"]);
                    //    myrow["jhj"] = Convert.ToString(tb.Rows[i]["进价"]);
                    //    myrow["ypsl"] = Convert.ToString(tb.Rows[i]["数量"]);
                    //    myrow["ypdw"] = Convert.ToString(tb.Rows[i]["单位"]);
                    //    Dset.付款情况表明细.Rows.Add(myrow);

                    //}

                    //ParameterEx[] parameters = new ParameterEx[3];
                    //parameters[0].Text = "tjtj";
                    //parameters[0].Value = tjtj.Trim();
                    //parameters[1].Text = "ghdw";
                    //parameters[1].Value = txtghdw.Text.Trim();
                    //parameters[2].Text = "TITLETEXT";
                    //parameters[2].Value = TrasenFrame.Classes.Constant.HospitalName + "(" + InstanceForm.BCurrentDept.DeptName + ")" + titletext.Trim();


                    //TrasenFrame.Forms.FrmReportView f = new TrasenFrame.Forms.FrmReportView(Dset.付款情况表明细, Constant.ApplicationDirectory + "\\Report\\YK_付款情况表明细.rpt", parameters);
                    //if (f.LoadReportSuccess) f.Show(); else f.Dispose();
                }
                catch (System.Exception err)
                {
                    MessageBox.Show(err.Message);
                }
            }
        }

        private void dtpfprq_KeyPress(object sender, System.Windows.Forms.KeyPressEventArgs e)
        {

            int nkey = Convert.ToInt32(e.KeyChar);
            if (nkey == 13)
            {
                this.myDataGrid1.Enabled = true;
                DataTable tb = (DataTable)this.myDataGrid1.DataSource;
                int nrow = this.myDataGrid1.CurrentCell.RowNumber;
                int ncol = this.myDataGrid1.CurrentCell.ColumnNumber;
                string columnName = this.myDataGrid1.TableStyles[0].GridColumnStyles[ncol].HeaderText.Trim();
                if (columnName.Trim() == "发票日期")
                {
                    if (nrow > tb.Rows.Count - 1) return;
                    tb.Rows[nrow]["发票日期"] = this.dtpfprq.Value.ToShortDateString();
                    this.dtpfprq.Visible = false;
                    this.myDataGrid1.CurrentCell = new DataGridCell(nrow + 1, this.myDataGrid1.CurrentCell.ColumnNumber - 1);
                }
            }
            if (nkey == 27)
            {
                this.myDataGrid1.Enabled = true;
                dtpfprq.Visible = false;
            }

        }

        private void myDataGrid1_Click(object sender, System.EventArgs e)
        {
            try
            {
                DataTable tb = (DataTable)this.myDataGrid1.DataSource;
                int nrow = this.myDataGrid1.CurrentCell.RowNumber;
                int ncol = this.myDataGrid1.CurrentCell.ColumnNumber;
                if (nrow > tb.Rows.Count - 1) return;
                string columnName = this.myDataGrid1.TableStyles[0].GridColumnStyles[ncol].HeaderText.Trim();
                if (columnName.Trim() == "付款" && this.rdo1.Checked == true)
                {
                    tb.Rows[nrow]["付款"] = (short)tb.Rows[nrow]["付款"] == 0 ? 1 : 0;
                }

                //if (columnName.Trim() == "付款") dtpfprq.Visible = true;
            }
            catch (System.Exception err)
            {
                MessageBox.Show(err.Message, "", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
        }

        private void cmbyjks_SelectedIndexChanged(object sender, EventArgs e)
        {
            Yp.AddCmbYjks_ck(true, Convert.ToInt32(cmbyjks.SelectedValue), cmbck, InstanceForm.BDatabase);
            if (cmbck.Items.Count == 1)
            {
                cmbck.Visible = false;
                lblck.Visible = false;
            }
            else
            {
                cmbck.Visible = true;
                lblck.Visible = true;
            }
        }

        private void tabControl1_SelectedIndexChanged(object sender, EventArgs e)
        {
            butref_Click(sender, e);
        }

        private void dataGridView1_CellContentClick(object sender, DataGridViewCellEventArgs e)
        {

        }

        private void butsaveFp_Click(object sender, EventArgs e)
        {




            if (MessageBox.Show(this, "您确定保存吗?", "确认", MessageBoxButtons.YesNo) == DialogResult.No) return;

            try
            {
                InstanceForm.BDatabase.BeginTransaction();

                DataTable tb = (DataTable)this.myDataGrid1.DataSource;
                for (int i = 0; i <= tb.Rows.Count - 1; i++)
                {
                    if (Convert.ToInt32(tb.Rows[i]["付款"]) == 1)
                    {
                        string fph = tb.Rows[i]["发票号"].ToString().Trim();
                        string fprq = tb.Rows[i]["发票日期"].ToString().Trim();
                        Guid id = new Guid(Convertor.IsNull(tb.Rows[i]["id"], Guid.Empty.ToString()));
                        if (fph == "" || fprq == "") throw new Exception("必须输入发票号和发票日期");

                        string ssql = "update yk_dj set fph='" + fph.Trim() + "',fprq='" + fprq.Trim() + "' where id='" + id + "'";
                        int nrow = InstanceForm.BDatabase.DoCommand(ssql);
                        if (nrow != 1)
                        {
                            ssql = "update yk_dj_h set fph='" + fph.Trim() + "',fprq='" + fprq.Trim() + "' where id='" + id + "'";
                            nrow = InstanceForm.BDatabase.DoCommand(ssql);
                        }

                    }
                }

                InstanceForm.BDatabase.CommitTransaction();

                this.butref_Click(sender, e);
            }

            catch (System.Exception err)
            {
                InstanceForm.BDatabase.RollbackTransaction();
                MessageBox.Show(err.Message, "提示", MessageBoxButtons.OK, MessageBoxIcon.Warning);
            }


        }

        private void butexcel_Click(object sender, EventArgs e)
        {


            try
            {
                if (this.tabControl1.SelectedTab == tabPage1)
                {
                    #region 导汇总
                    DataTable tb = (DataTable)this.myDataGrid1.DataSource;

                    // 创建Excel对象                    --LeeWenjie    2006-11-29
                    Excel.Application xlApp = new Excel.ApplicationClass();
                    if (xlApp == null)
                    {
                        MessageBox.Show("Excel无法启动");
                        return;
                    }
                    // 创建Excel工作薄
                    Excel.Workbook xlBook = xlApp.Workbooks.Add(true);
                    Excel.Worksheet xlSheet = (Excel.Worksheet)xlBook.Worksheets[1];

                    // 列索引，行索引，总列数，总行数
                    int colIndex = 0;
                    int RowIndex = 0;
                    int colCount = 0;
                    int RowCount = tb.Rows.Count;
                    for (int i = 0; i <= myDataGrid1.TableStyles[0].GridColumnStyles.Count - 1; i++)
                    {
                        if (myDataGrid1.TableStyles[0].GridColumnStyles[i].Width > 0)
                            colCount = colCount + 1;
                    }

                    // 设置标题
                    Excel.Range range = xlSheet.get_Range(xlApp.Cells[1, 1], xlApp.Cells[1, colCount]);
                    range.MergeCells = true;
                    xlApp.ActiveCell.FormulaR1C1 = rdo1.Checked == true ? "未付款" + "单据汇总情况" : "已付款" + "单据汇总情况";
                    xlApp.ActiveCell.Font.Size = 20;
                    xlApp.ActiveCell.Font.Bold = true;
                    xlApp.ActiveCell.HorizontalAlignment = Excel.Constants.xlCenter;


                    // 创建缓存数据
                    object[,] objData = new object[RowCount + 1, colCount + 1];
                    // 获取列标题
                    for (int i = 0; i <= myDataGrid1.TableStyles[0].GridColumnStyles.Count - 1; i++)
                    {
                        if (myDataGrid1.TableStyles[0].GridColumnStyles[i].Width > 0)
                            objData[0, colIndex++] = myDataGrid1.TableStyles[0].GridColumnStyles[i].HeaderText;
                    }
                    // 获取数据

                    for (int i = 0; i <= tb.Rows.Count - 1; i++)
                    {
                        colIndex = 0;
                        for (int j = 0; j <= myDataGrid1.TableStyles[0].GridColumnStyles.Count - 1; j++)
                        {
                            if (myDataGrid1.TableStyles[0].GridColumnStyles[j].Width > 0)
                            {
                                if (myDataGrid1.TableStyles[0].GridColumnStyles[j].HeaderText == "品名" || myDataGrid1.TableStyles[0].GridColumnStyles[j].HeaderText == "商品名" || myDataGrid1.TableStyles[0].GridColumnStyles[j].HeaderText == "规格")
                                    objData[i + 1, colIndex++] = "'" + tb.Rows[i][j].ToString().Trim();
                                else
                                    objData[i + 1, colIndex++] = "" + tb.Rows[i][j].ToString().Trim();
                            }
                        }
                        Application.DoEvents();
                    }

                    // 写入Excel
                    range = xlSheet.get_Range(xlApp.Cells[2, 1], xlApp.Cells[RowCount + 2, colCount]);
                    range.Value2 = objData;

                    // 
                    xlApp.get_Range(xlApp.Cells[2, 1], xlApp.Cells[RowCount + 2, colCount]).Borders.LineStyle = 1;

                    //设置报表表格为最适应宽度
                    xlApp.get_Range(xlApp.Cells[2, 1], xlApp.Cells[RowCount + 2, colCount]).Select();
                    xlApp.get_Range(xlApp.Cells[2, 1], xlApp.Cells[RowCount + 2, colCount]).Columns.AutoFit();
                    xlApp.get_Range(xlApp.Cells[2, 1], xlApp.Cells[RowCount + 2, colCount]).Font.Size = 9;

                    xlApp.Visible = true;
                    #endregion
                }
                else
                {
                    button2_Click(sender, e);
                }
            }
            catch (System.Exception err)
            {
                MessageBox.Show(err.Message, "", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }

        }

        private void button2_Click(object sender, EventArgs e)
        {

            DataTable tb = (DataTable)this.myDataGrid3.DataSource;

            // 创建Excel对象                    --LeeWenjie    2006-11-29
            Excel.Application xlApp = new Excel.ApplicationClass();
            if (xlApp == null)
            {
                MessageBox.Show("Excel无法启动");
                return;
            }
            // 创建Excel工作薄
            Excel.Workbook xlBook = xlApp.Workbooks.Add(true);
            Excel.Worksheet xlSheet = (Excel.Worksheet)xlBook.Worksheets[1];

            // 列索引，行索引，总列数，总行数
            int colIndex = 0;
            int RowIndex = 0;
            int colCount = 0;
            int RowCount = tb.Rows.Count;
            for (int i = 0; i <= myDataGrid3.TableStyles[0].GridColumnStyles.Count - 1; i++)
            {
                if (myDataGrid3.TableStyles[0].GridColumnStyles[i].Width > 0)
                    colCount = colCount + 1;
            }

            // 设置标题
            Excel.Range range = xlSheet.get_Range(xlApp.Cells[1, 1], xlApp.Cells[1, colCount]);
            range.MergeCells = true;
            xlApp.ActiveCell.FormulaR1C1 = rdo1.Checked == true ? "未付款" + "单据明细情况" : "已付款" + "单据明细情况";
            xlApp.ActiveCell.Font.Size = 20;
            xlApp.ActiveCell.Font.Bold = true;
            xlApp.ActiveCell.HorizontalAlignment = Excel.Constants.xlCenter;


            // 创建缓存数据
            object[,] objData = new object[RowCount + 1, colCount + 1];
            // 获取列标题
            for (int i = 0; i <= myDataGrid3.TableStyles[0].GridColumnStyles.Count - 1; i++)
            {
                if (myDataGrid3.TableStyles[0].GridColumnStyles[i].Width > 0)
                    objData[0, colIndex++] = myDataGrid3.TableStyles[0].GridColumnStyles[i].HeaderText;
            }
            // 获取数据

            for (int i = 0; i <= tb.Rows.Count - 1; i++)
            {
                colIndex = 0;
                for (int j = 0; j <= myDataGrid3.TableStyles[0].GridColumnStyles.Count - 1; j++)
                {
                    if (myDataGrid3.TableStyles[0].GridColumnStyles[j].Width > 0)
                    {
                        if (myDataGrid3.TableStyles[0].GridColumnStyles[j].HeaderText == "品名" || myDataGrid3.TableStyles[0].GridColumnStyles[j].HeaderText == "商品名" || myDataGrid3.TableStyles[0].GridColumnStyles[j].HeaderText == "规格")
                            objData[i + 1, colIndex++] = "'" + tb.Rows[i][j].ToString().Trim();
                        else
                            objData[i + 1, colIndex++] = "" + tb.Rows[i][j].ToString().Trim();
                    }
                }
                Application.DoEvents();
            }

            // 写入Excel
            range = xlSheet.get_Range(xlApp.Cells[2, 1], xlApp.Cells[RowCount + 2, colCount]);
            range.Value2 = objData;

            // 
            xlApp.get_Range(xlApp.Cells[2, 1], xlApp.Cells[RowCount + 2, colCount]).Borders.LineStyle = 1;

            //设置报表表格为最适应宽度
            xlApp.get_Range(xlApp.Cells[2, 1], xlApp.Cells[RowCount + 2, colCount]).Select();
            xlApp.get_Range(xlApp.Cells[2, 1], xlApp.Cells[RowCount + 2, colCount]).Columns.AutoFit();
            xlApp.get_Range(xlApp.Cells[2, 1], xlApp.Cells[RowCount + 2, colCount]).Font.Size = 9;

            xlApp.Visible = true;

        }

        private void butexcel_dw_Click(object sender, EventArgs e)
        {
            try
            {

                DataTable tb = (DataTable)this.dataGridView1.DataSource;

                // 创建Excel对象                    --LeeWenjie    2006-11-29
                Excel.Application xlApp = new Excel.ApplicationClass();
                if (xlApp == null)
                {
                    MessageBox.Show("Excel无法启动");
                    return;
                }
                // 创建Excel工作薄
                Excel.Workbook xlBook = xlApp.Workbooks.Add(true);
                Excel.Worksheet xlSheet = (Excel.Worksheet)xlBook.Worksheets[1];

                // 列索引，行索引，总列数，总行数
                int colIndex = 0;
                int RowIndex = 0;
                int colCount = 0;
                int RowCount = tb.Rows.Count;
                for (int i = 0; i <= dataGridView1.ColumnCount - 1; i++)
                {
                    if (dataGridView1.Columns[i].Visible == true)
                        colCount = colCount + 1;
                }

                // 设置标题
                Excel.Range range = xlSheet.get_Range(xlApp.Cells[1, 1], xlApp.Cells[1, colCount]);
                range.MergeCells = true;
                xlApp.ActiveCell.FormulaR1C1 = "供货商未付款情况";
                xlApp.ActiveCell.Font.Size = 16;
                xlApp.ActiveCell.Font.Bold = true;
                xlApp.ActiveCell.HorizontalAlignment = Excel.Constants.xlCenter;


                // 创建缓存数据
                object[,] objData = new object[RowCount + 1, colCount + 1];
                // 获取列标题
                for (int i = 0; i <= dataGridView1.ColumnCount - 1; i++)
                {
                    if (dataGridView1.Columns[i].Visible == true)
                        objData[0, colIndex++] = dataGridView1.Columns[i].HeaderText;
                }
                // 获取数据

                for (int i = 0; i <= tb.Rows.Count - 1; i++)
                {
                    colIndex = 0;
                    for (int j = 0; j <= dataGridView1.ColumnCount - 1; j++)
                    {
                        if (dataGridView1.Columns[j].Visible == true)
                        {
                            if (dataGridView1.Columns[j].HeaderText == "门诊号" || dataGridView1.Columns[j].HeaderText == "发票号" || dataGridView1.Columns[j].HeaderText == "卡号")
                                objData[i + 1, colIndex++] = "'" + tb.Rows[i][j].ToString();
                            else
                                objData[i + 1, colIndex++] = "" + tb.Rows[i][j].ToString();
                        }
                    }
                    Application.DoEvents();
                }
                // 写入Excel
                range = xlSheet.get_Range(xlApp.Cells[2, 1], xlApp.Cells[RowCount + 2, colCount]);
                range.Value2 = objData;

                // 
                xlApp.get_Range(xlApp.Cells[2, 1], xlApp.Cells[RowCount + 2, colCount]).Borders.LineStyle = 1;

                //设置报表表格为最适应宽度
                xlApp.get_Range(xlApp.Cells[2, 1], xlApp.Cells[RowCount + 2, colCount]).Select();
                xlApp.get_Range(xlApp.Cells[2, 1], xlApp.Cells[RowCount + 2, colCount]).Columns.AutoFit();
                xlApp.get_Range(xlApp.Cells[2, 1], xlApp.Cells[RowCount + 2, colCount]).Font.Size = 9;

                xlApp.Visible = true;
            }
            catch (System.Exception err)
            {
                MessageBox.Show(err.Message, "", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }


        }

        private void dtpfprq_Leave(object sender, EventArgs e)
        {
            //myDataGrid1.Enabled = true;
            //if (dtpfprq.Visible == true)
            //{
                dtpfprq.Visible = false;
                dtpfprq.Tag = "";
                timer1.Enabled = true;
            //}
        }

        private void myDataGrid1_MouseClick(object sender, MouseEventArgs e)
        {

        }

        private void dtpfprq_VisibleChanged(object sender, EventArgs e)
        {
   
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            if (dtpfprq.Visible == true && Convertor.IsNull(dtpfprq.Tag, "") == "")
            {
                dtpfprq.Tag = "1";
                dtpfprq.Focus();
                timer1.Enabled = false;
            }
        }

        private void dataGridView1_CurrentCellChanged(object sender, EventArgs e)
        {

        }

        private void dataGridView1_CellClick(object sender, DataGridViewCellEventArgs e)
        {
            DataTable tb = (DataTable)dataGridView1.DataSource;
            if (tb == null) return;
            if (tb.Rows.Count == 0) return;
            if (dataGridView1.CurrentCell == null) return;

            int nrow = dataGridView1.CurrentCell.RowIndex;
            int ghdwid = Convert.ToInt32(tb.Rows[nrow]["ghdwid"]);
            string ghdwmc = tb.Rows[nrow]["供货单位"].ToString();

            txtghdw.Text = ghdwmc;
            txtghdw.Tag = ghdwid.ToString();

            butref_Click(sender, e);
        }

        private void butallsel_Click(object sender, EventArgs e)
        {
            
            DataTable tb = (DataTable)this.myDataGrid1.DataSource;
            for (int i = 0; i <= tb.Rows.Count - 1; i++)
            {
                tb.Rows[i]["付款"] = 1;
            }
        }

        private void butunallsel_Click(object sender, EventArgs e)
        {
            DataTable tb = (DataTable)this.myDataGrid1.DataSource;
            for (int i = 0; i <= tb.Rows.Count - 1; i++)
            {
                tb.Rows[i]["付款"] = (short)tb.Rows[i]["付款"] == 0 ? 1 : 0;
            }

           
        }


    }
}
