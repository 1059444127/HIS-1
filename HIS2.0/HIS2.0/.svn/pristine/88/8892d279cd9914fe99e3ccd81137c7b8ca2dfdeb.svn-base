using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Data.Odbc;

using System.Drawing;
using System.Text;
using System.Windows.Forms;
using TrasenClasses.DatabaseAccess;

namespace TraSen
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            
        }

        private void button1_Click(object sender, EventArgs e)
        {
            try
            {
                string conn = @"Provider=Microsoft.Jet.OLEDB.4.0;
                Data Source=d:\;
                Extended Properties=FoxPro 2.6 ;
                User ID=Admin;Password=;";
                //conn = @"Provider=vfpoledb;Data Source=d:\;Collating Sequence=machine";

                //conn = @"Provider=VFPOLEDB.1;Data Source=d:\";
                //conn = @"provider=VFPOLEDB.1;data source=d:\;user id=admin;password=";
                //conn =@"Driver={Microsoft dBASE Driver (*.dbf)}; DriverID=277;Dbq=d:\";
                //conn =@"Dsn=yy;defaultdir=D:\;driverid=533;fil=dBase 5.0;maxbuffersize=2048;pagetimeout=5";

                //conn=@"Driver={Microsoft dBASE Driver (*.dbf)};SourceType=DBF;Data Source=d:\;Exclusive=No;NULL=NO;Collate=Machine;BACKGROUNDFETCH=NO;DELETED=NO";
                //conn = @"Driver={Microsoft Visual FoxPro Driver};SourceType=DBF;SourceDB=d:\;Exclusive=No;NULL=NO;Collate=Machine;BACKGROUNDFETCH=NO;DELETED=NO";
                //conn = @" DRIVER=VFP;UID=;Collate=Machine;BackgroundFetch=Yes;      Exclusive=No;SourceType=DBF;SourceDB=D:\;";
                //conn = @" Dsn=Visual FoxPro Database;sourcedb=d:\;sourcetype=DBF;exclusive=No;backgroundfetch=Yes;collate=Machine";
                //conn = @"Driver={Microsoft Visual FoxPro Driver};SourceType=DBF;SourceDB=d:\;Exclusive=No";
                

                conn = @"Driver={Microsoft Visual FoxPro Driver};SourceType=DBF;SourceDB=d:\;Exclusive=No;NULL=NO;Collate=Machine;BACKGROUNDFETCH=NO;DELETED=NO";

                //conn = @"Dsn=Visual FoxPro Tables;sourcedb=d:\;sourcetype=DBF;exclusive=No;backgroundfetch=Yes;collate=Machine";
                //conn = @"DRIVER={Microsoft Visual FoxPro Driver (*.dbf)};dbq=d:\";
                OleDB olde = new OleDB();

                //olde.Initialize(conn);
                //DataTable db1 = olde.GetDataTable("select * from N041");
                //olde.DoCommand("delete from test.dbf");
                //olde.DoCommand("alter table test.dbf add column p1 int");

                OdbcConnection ODBC = new OdbcConnection();
                ODBC.ConnectionString = conn;
                ODBC.Open();
                OdbcDataAdapter da = new OdbcDataAdapter("select * from N041", ODBC);
                DataTable dt = new DataTable();
                da.Fill(dt);
                
                //olde.DoCommand("insert into test.dbf(kind,code,name) values (1,2,'≤‚ ‘')");
                //string t = db1.Rows.Count.ToString();
                string createTab = "create table test2.dbf(kind numeric(16,0) ,code numeric(16,0) ,name varchar(100),px numeric(16,0) ,yx numeric(16,0) ,bz varchar(200))";
                //createTab = "create table N041 (USERNAME VARCHAR(60), YLFKFS VARCHAR(100), JKKH VARCHAR(100), ZYCS VARCHAR(100), BAH VARCHAR(100), XM VARCHAR(100), XB VARCHAR(100), CSRQ VARCHAR(12), NL NUMERIC(10), GJ VARCHAR(100), BZYZSNL NUMERIC(4,0), XSECSTZ NUMERIC(12,2), XSERYTZ NUMERIC(12,2), CSD VARCHAR(200), GG VARCHAR(200), MZ VARCHAR(100), SFZH VARCHAR(100), ZY VARCHAR(100), HY VARCHAR(100), XZZ VARCHAR(100), DH VARCHAR(100), YB1 VARCHAR(100), HKDZ VARCHAR(100), YB2 VARCHAR(100), GZDWJDZ VARCHAR(100), DWDH VARCHAR(100), YB3 VARCHAR(100), LXRXM VARCHAR(100), GX VARCHAR(100), DZ VARCHAR(100), DH2 VARCHAR(100), RYTJ VARCHAR(100), RYSJ VARCHAR(12), RYSJS NUMERIC(24,0), RYKB VARCHAR(100), RYBF VARCHAR(100), ZKKB VARCHAR(100), CYSJ VARCHAR(12), CYSJS NUMERIC(24,0), CYKB VARCHAR(100), CYBF VARCHAR(100), SJZYTS VARCHAR(100), MZZD VARCHAR(200), JBBM VARCHAR(100), ZYZD VARCHAR(200), JBDM VARCHAR(100), RYBQ VARCHAR(100), QTZD8 VARCHAR(200), JBDM8 VARCHAR(100), RYBQ8 VARCHAR(100), QTZD1 VARCHAR(200), JBDM1 VARCHAR(100), RYBQ1 VARCHAR(100), QTZD9 VARCHAR(200), JBDM9 VARCHAR(100), RYBQ9 VARCHAR(100), QTZD2 VARCHAR(200), JBDM2 VARCHAR(100), RYBQ2 VARCHAR(100), QTZD10 VARCHAR(200), JBDM10 VARCHAR(100), RYBQ10 VARCHAR(100), QTZD3 VARCHAR(200), JBDM3 VARCHAR(100), RYBQ3 VARCHAR(100), QTZD11 VARCHAR(200), JBDM11 VARCHAR(100), RYBQ11 VARCHAR(100), QTZD4 VARCHAR(200), JBDM4 VARCHAR(100), RYBQ4 VARCHAR(100), QTZD12 VARCHAR(200), JBDM12 VARCHAR(100), RYBQ12 VARCHAR(100), QTZD5 VARCHAR(200), JBDM5 VARCHAR(100), RYBQ5 VARCHAR(100), QTZD13 VARCHAR(200), JBDM13 VARCHAR(100), RYBQ13 VARCHAR(100), QTZD6 VARCHAR(200), JBDM6 VARCHAR(100), RYBQ6 VARCHAR(100), QTZD14 VARCHAR(200), JBDM14 VARCHAR(100), RYBQ14 VARCHAR(100), QTZD7 VARCHAR(200), JBDM7 VARCHAR(100), RYBQ7 VARCHAR(100), QTZD15 VARCHAR(200), JBDM15 VARCHAR(100), RYBQ15 VARCHAR(100), WBYY VARCHAR(254), H23 VARCHAR(100), BLZD VARCHAR(100), JBMM VARCHAR(100), BLH VARCHAR(100), YWGM VARCHAR(254), GMYW VARCHAR(100), SWHZSJ VARCHAR(100), XX VARCHAR(100), RH VARCHAR(100), KZR VARCHAR(100), ZRYS VARCHAR(100), ZZYS VARCHAR(100), ZYYS VARCHAR(100), ZRHS VARCHAR(100), JXYS VARCHAR(100), SXYS VARCHAR(100), BMY VARCHAR(100), BAZL VARCHAR(100), ZKYS VARCHAR(100), ZKHS VARCHAR(100), ZKRQ VARCHAR(12), SSJCZBM1 VARCHAR(100), SSJCZRQ1 VARCHAR(12), SSJB1 VARCHAR(100), SSJCZMC1 VARCHAR(200), SZ1 VARCHAR(100), YZ1 VARCHAR(100), EZ1 VARCHAR(100), QKDJ1 VARCHAR(100), QKYHLB1 VARCHAR(100), MZFS1 VARCHAR(100), MZYS1 VARCHAR(100), SSJCZBM2 VARCHAR(100), SSJCZRQ2 VARCHAR(12), SSJB2 VARCHAR(100), SSJCZMC2 VARCHAR(200), SZ2 VARCHAR(100), YZ2 VARCHAR(100), EZ2 VARCHAR(100), QKDJ2 VARCHAR(100), QKYHLB2 VARCHAR(100), MZFS2 VARCHAR(100), MZYS2 VARCHAR(100), SSJCZBM3 VARCHAR(100), SSJCZRQ3 VARCHAR(12), SSJB3 VARCHAR(100), SSJCZMC3 VARCHAR(200), SZ3 VARCHAR(100), YZ3 VARCHAR(100), EZ3 VARCHAR(100), QKDJ3 VARCHAR(100), QKYHLB3 VARCHAR(100), MZFS3 VARCHAR(100), MZYS3 VARCHAR(100), SSJCZBM4 VARCHAR(100), SSJCZRQ4 VARCHAR(12), SSJB4 VARCHAR(100), SSJCZMC4 VARCHAR(200), SZ4 VARCHAR(100), YZ4 VARCHAR(100), EZ4 VARCHAR(100), QKDJ4 VARCHAR(100), QKYHLB4 VARCHAR(100), MZFS4 VARCHAR(100), MZYS4 VARCHAR(100), SSJCZBM5 VARCHAR(100), SSJCZRQ5 VARCHAR(12), SSJB5 VARCHAR(100), SSJCZMC5 VARCHAR(200), SZ5 VARCHAR(100), YZ5 VARCHAR(100), EZ5 VARCHAR(100), QKDJ5 VARCHAR(100), QKYHLB5 VARCHAR(100), MZFS5 VARCHAR(100), MZYS5 VARCHAR(100), SSJCZBM6 VARCHAR(100), SSJCZRQ6 VARCHAR(12), SSJB6 VARCHAR(100), SSJCZMC6 VARCHAR(200), SZ6 VARCHAR(100), YZ6 VARCHAR(100), EZ6 VARCHAR(100), QKDJ6 VARCHAR(100), QKYHLB6 VARCHAR(100), MZFS6 VARCHAR(100), MZYS6 VARCHAR(100), SSJCZBM7 VARCHAR(100), SSJCZRQ7 VARCHAR(12), SSJB7 VARCHAR(100), SSJCZMC7 VARCHAR(200), SZ7 VARCHAR(100), YZ7 VARCHAR(100), EZ7 VARCHAR(100), QKDJ7 VARCHAR(100), QKYHLB7 VARCHAR(100), MZFS7 VARCHAR(100), MZYS7 VARCHAR(100), LYFS VARCHAR(100), YZZY_YLJG VARCHAR(200), WSY_YLJG VARCHAR(200), SFZZYJH VARCHAR(100), MD VARCHAR(100), RYQ_T NUMERIC(12,0), RYQ_XS NUMERIC(24,0), RYQ_F NUMERIC(12,0), RYH_T NUMERIC(12,0), RYH_XS NUMERIC(24,0), RYH_F NUMERIC(12,0), ZFY NUMERIC(12,2), ZFJE NUMERIC(12,2), YLFUF NUMERIC(12,2), ZLCZF NUMERIC(12,2), HLF NUMERIC(12,2), QTFY NUMERIC(12,2), BLZDF NUMERIC(12,2), SYSZDF NUMERIC(12,2), YXXZDF NUMERIC(12,2), LCZDXMF NUMERIC(12,2), FSSZLXMF NUMERIC(12,2), WLZLF NUMERIC(12,2), SSZLF NUMERIC(12,2), MAF NUMERIC(12,2), SSF NUMERIC(12,2), KFF NUMERIC(12,2), ZYZLF NUMERIC(12,2), XYF NUMERIC(12,2), KJYWF NUMERIC(12,2), ZCYF NUMERIC(12,2), ZCYF1 NUMERIC(12,2), XF NUMERIC(12,2), BDBLZPF NUMERIC(12,2), QDBLZPF NUMERIC(12,2), NXYZLZPF NUMERIC(12,2), XBYZLZPF NUMERIC(12,2), HCYYCLF NUMERIC(12,2), YYCLF NUMERIC(12,2), YCXYYCLF NUMERIC(12,2), QTF NUMERIC(12,2))";
                createTab = @"create table d:\N043 (USERNAME VARCHAR(60), YLFKFS VARCHAR(100), JKKH VARCHAR(100), ZYCS VARCHAR(100), BAH VARCHAR(100), XM VARCHAR(100), XB VARCHAR(100), CSRQ VARCHAR(12), NL NUMERIC(10,0), GJ VARCHAR(100), BZYZSNL NUMERIC(4,0), XSECSTZ NUMERIC(12,2), XSERYTZ NUMERIC(12,2), CSD VARCHAR(200), GG VARCHAR(200), MZ VARCHAR(100), SFZH VARCHAR(100), ZY VARCHAR(100), HY VARCHAR(100), XZZ VARCHAR(100), DH VARCHAR(100), YB1 VARCHAR(100), HKDZ VARCHAR(100), YB2 VARCHAR(100), GZDWJDZ VARCHAR(100), DWDH VARCHAR(100), YB3 VARCHAR(100), LXRXM VARCHAR(100), GX VARCHAR(100), DZ VARCHAR(100), DH2 VARCHAR(100), RYTJ VARCHAR(100), RYSJ VARCHAR(12), RYSJS NUMERIC(18,0), RYKB VARCHAR(100), RYBF VARCHAR(100), ZKKB VARCHAR(100), CYSJ VARCHAR(12), CYSJS NUMERIC(18,0), CYKB VARCHAR(100), CYBF VARCHAR(100), SJZYTS VARCHAR(100), MZZD VARCHAR(200), JBBM VARCHAR(100), ZYZD VARCHAR(200), JBDM VARCHAR(100), RYBQ VARCHAR(100), QTZD8 VARCHAR(200), JBDM8 VARCHAR(100), RYBQ8 VARCHAR(100), QTZD1 VARCHAR(200), JBDM1 VARCHAR(100), RYBQ1 VARCHAR(100), QTZD9 VARCHAR(200), JBDM9 VARCHAR(100), RYBQ9 VARCHAR(100), QTZD2 VARCHAR(200), JBDM2 VARCHAR(100), RYBQ2 VARCHAR(100), QTZD10 VARCHAR(200), JBDM10 VARCHAR(100), RYBQ10 VARCHAR(100), QTZD3 VARCHAR(200), JBDM3 VARCHAR(100), RYBQ3 VARCHAR(100), QTZD11 VARCHAR(200), JBDM11 VARCHAR(100), RYBQ11 VARCHAR(100), QTZD4 VARCHAR(200), JBDM4 VARCHAR(100), RYBQ4 VARCHAR(100), QTZD12 VARCHAR(200), JBDM12 VARCHAR(100), RYBQ12 VARCHAR(100), QTZD5 VARCHAR(200), JBDM5 VARCHAR(100), RYBQ5 VARCHAR(100), QTZD13 VARCHAR(200), JBDM13 VARCHAR(100), RYBQ13 VARCHAR(100), QTZD6 VARCHAR(200), JBDM6 VARCHAR(100), RYBQ6 VARCHAR(100), QTZD14 VARCHAR(200), JBDM14 VARCHAR(100), RYBQ14 VARCHAR(100), QTZD7 VARCHAR(200), JBDM7 VARCHAR(100), RYBQ7 VARCHAR(100), QTZD15 VARCHAR(200), JBDM15 VARCHAR(100), RYBQ15 VARCHAR(100), WBYY VARCHAR(254), H23 VARCHAR(100), BLZD VARCHAR(100), JBMM VARCHAR(100), BLH VARCHAR(100), YWGM VARCHAR(254), GMYW VARCHAR(100), SWHZSJ VARCHAR(100), XX VARCHAR(100), RH VARCHAR(100), KZR VARCHAR(100), ZRYS VARCHAR(100), ZZYS VARCHAR(100), ZYYS VARCHAR(100), ZRHS VARCHAR(100), JXYS VARCHAR(100), SXYS VARCHAR(100), BMY VARCHAR(100), BAZL VARCHAR(100), ZKYS VARCHAR(100), ZKHS VARCHAR(100), ZKRQ VARCHAR(12), SSJCZBM1 VARCHAR(100), SSJCZRQ1 VARCHAR(12), SSJB1 VARCHAR(100), SSJCZMC1 VARCHAR(200), SZ1 VARCHAR(100), YZ1 VARCHAR(100), EZ1 VARCHAR(100), QKDJ1 VARCHAR(100), QKYHLB1 VARCHAR(100), MZFS1 VARCHAR(100), MZYS1 VARCHAR(100), SSJCZBM2 VARCHAR(100), SSJCZRQ2 VARCHAR(12), SSJB2 VARCHAR(100), SSJCZMC2 VARCHAR(200), SZ2 VARCHAR(100), YZ2 VARCHAR(100), EZ2 VARCHAR(100), QKDJ2 VARCHAR(100), QKYHLB2 VARCHAR(100), MZFS2 VARCHAR(100), MZYS2 VARCHAR(100), SSJCZBM3 VARCHAR(100), SSJCZRQ3 VARCHAR(12), SSJB3 VARCHAR(100), SSJCZMC3 VARCHAR(200), SZ3 VARCHAR(100), YZ3 VARCHAR(100), EZ3 VARCHAR(100), QKDJ3 VARCHAR(100), QKYHLB3 VARCHAR(100), MZFS3 VARCHAR(100), MZYS3 VARCHAR(100), SSJCZBM4 VARCHAR(100), SSJCZRQ4 VARCHAR(12), SSJB4 VARCHAR(100), SSJCZMC4 VARCHAR(200), SZ4 VARCHAR(100), YZ4 VARCHAR(100), EZ4 VARCHAR(100), QKDJ4 VARCHAR(100), QKYHLB4 VARCHAR(100), MZFS4 VARCHAR(100), MZYS4 VARCHAR(100), SSJCZBM5 VARCHAR(100), SSJCZRQ5 VARCHAR(12), SSJB5 VARCHAR(100), SSJCZMC5 VARCHAR(200), SZ5 VARCHAR(100), YZ5 VARCHAR(100), EZ5 VARCHAR(100), QKDJ5 VARCHAR(100), QKYHLB5 VARCHAR(100), MZFS5 VARCHAR(100), MZYS5 VARCHAR(100), SSJCZBM6 VARCHAR(100), SSJCZRQ6 VARCHAR(12), SSJB6 VARCHAR(100), SSJCZMC6 VARCHAR(200), SZ6 VARCHAR(100), YZ6 VARCHAR(100), EZ6 VARCHAR(100), QKDJ6 VARCHAR(100), QKYHLB6 VARCHAR(100), MZFS6 VARCHAR(100), MZYS6 VARCHAR(100), SSJCZBM7 VARCHAR(100), SSJCZRQ7 VARCHAR(12), SSJB7 VARCHAR(100), SSJCZMC7 VARCHAR(200), SZ7 VARCHAR(100), YZ7 VARCHAR(100), EZ7 VARCHAR(100), QKDJ7 VARCHAR(100), QKYHLB7 VARCHAR(100), MZFS7 VARCHAR(100), MZYS7 VARCHAR(100), LYFS VARCHAR(100), YZZY_YLJG VARCHAR(200), WSY_YLJG VARCHAR(200), SFZZYJH VARCHAR(100), MD VARCHAR(100), RYQ_T NUMERIC(12,0), RYQ_XS NUMERIC(18,0), RYQ_F NUMERIC(12,0), RYH_T NUMERIC(12,0), RYH_XS NUMERIC(18,0), RYH_F NUMERIC(12,0), ZFY NUMERIC(12,2), ZFJE NUMERIC(12,2), YLFUF NUMERIC(12,2), ZLCZF NUMERIC(12,2), HLF NUMERIC(12,2), QTFY NUMERIC(12,2), BLZDF NUMERIC(12,2), SYSZDF NUMERIC(12,2), YXXZDF NUMERIC(12,2), LCZDXMF NUMERIC(12,2), FSSZLXMF NUMERIC(12,2), WLZLF NUMERIC(12,2), SSZLF NUMERIC(12,2), MAF NUMERIC(12,2), SSF NUMERIC(12,2), KFF NUMERIC(12,2), ZYZLF NUMERIC(12,2), XYF NUMERIC(12,2), KJYWF NUMERIC(12,2), ZCYF NUMERIC(12,2), ZCYF1 NUMERIC(12,2), XF NUMERIC(12,2), BDBLZPF NUMERIC(12,2), QDBLZPF NUMERIC(12,2), NXYZLZPF NUMERIC(12,2), XBYZLZPF NUMERIC(12,2), HCYYCLF NUMERIC(12,2), YYCLF NUMERIC(12,2), YCXYYCLF NUMERIC(12,2), QTF NUMERIC(12,2))";
                createTab = @"create table d:\N043 (USERNAME c(60), YLFKFS c(100), JKKH c(100), ZYCS c(100), BAH c(100), XM c(100), XB c(100), CSRQ c(12), NL n(10,0), GJ c(100), BZYZSNL n(4,0), XSECSTZ n(12,2), XSERYTZ n(12,2), CSD c(200), GG c(200), MZ c(100), SFZH c(100), ZY c(100), HY c(100), XZZ c(100), DH c(100), YB1 c(100), HKDZ c(100), YB2 c(100), GZDWJDZ c(100), DWDH c(100), YB3 c(100), LXRXM c(100), GX c(100), DZ c(100), DH2 c(100), RYTJ c(100), RYSJ c(12), RYSJS n(18,0), RYKB c(100), RYBF c(100), ZKKB c(100), CYSJ c(12), CYSJS n(18,0), CYKB c(100), CYBF c(100), SJZYTS c(100), MZZD c(200), JBBM c(100), ZYZD c(200), JBDM c(100), RYBQ c(100), QTZD8 c(200), JBDM8 c(100), RYBQ8 c(100), QTZD1 c(200), JBDM1 c(100), RYBQ1 c(100), QTZD9 c(200), JBDM9 c(100), RYBQ9 c(100), QTZD2 c(200), JBDM2 c(100), RYBQ2 c(100), QTZD10 c(200), JBDM10 c(100), RYBQ10 c(100), QTZD3 c(200), JBDM3 c(100), RYBQ3 c(100), QTZD11 c(200), JBDM11 c(100), RYBQ11 c(100), QTZD4 c(200), JBDM4 c(100), RYBQ4 c(100), QTZD12 c(200), JBDM12 c(100), RYBQ12 c(100), QTZD5 c(200), JBDM5 c(100), RYBQ5 c(100), QTZD13 c(200), JBDM13 c(100), RYBQ13 c(100), QTZD6 c(200), JBDM6 c(100), RYBQ6 c(100), QTZD14 c(200), JBDM14 c(100), RYBQ14 c(100), QTZD7 c(200), JBDM7 c(100), RYBQ7 c(100), QTZD15 c(200), JBDM15 c(100), RYBQ15 c(100), WBYY c(254), H23 c(100), BLZD c(100), JBMM c(100), BLH c(100), YWGM c(254), GMYW c(100), SWHZSJ c(100), XX c(100), RH c(100), KZR c(100), ZRYS c(100), ZZYS c(100), ZYYS c(100), ZRHS c(100), JXYS c(100), SXYS c(100), BMY c(100), BAZL c(100), ZKYS c(100), ZKHS c(100), ZKRQ c(12), SSJCZBM1 c(100), SSJCZRQ1 c(12), SSJB1 c(100), SSJCZMC1 c(200), SZ1 c(100), YZ1 c(100), EZ1 c(100), QKDJ1 c(100), QKYHLB1 c(100), MZFS1 c(100), MZYS1 c(100), SSJCZBM2 c(100), SSJCZRQ2 c(12), SSJB2 c(100), SSJCZMC2 c(200), SZ2 c(100), YZ2 c(100), EZ2 c(100), QKDJ2 c(100), QKYHLB2 c(100), MZFS2 c(100), MZYS2 c(100), SSJCZBM3 c(100), SSJCZRQ3 c(12), SSJB3 c(100), SSJCZMC3 c(200), SZ3 c(100), YZ3 c(100), EZ3 c(100), QKDJ3 c(100), QKYHLB3 c(100), MZFS3 c(100), MZYS3 c(100), SSJCZBM4 c(100), SSJCZRQ4 c(12), SSJB4 c(100), SSJCZMC4 c(200), SZ4 c(100), YZ4 c(100), EZ4 c(100), QKDJ4 c(100), QKYHLB4 c(100), MZFS4 c(100), MZYS4 c(100), SSJCZBM5 c(100), SSJCZRQ5 c(12), SSJB5 c(100), SSJCZMC5 c(200), SZ5 c(100), YZ5 c(100), EZ5 c(100), QKDJ5 c(100), QKYHLB5 c(100), MZFS5 c(100), MZYS5 c(100), SSJCZBM6 c(100), SSJCZRQ6 c(12), SSJB6 c(100), SSJCZMC6 c(200), SZ6 c(100), YZ6 c(100), EZ6 c(100), QKDJ6 c(100), QKYHLB6 c(100), MZFS6 c(100), MZYS6 c(100), SSJCZBM7 c(100), SSJCZRQ7 c(12), SSJB7 c(100), SSJCZMC7 c(200), SZ7 c(100), YZ7 c(100), EZ7 c(100), QKDJ7 c(100), QKYHLB7 c(100), MZFS7 c(100), MZYS7 c(100), LYFS c(100), YZZY_YLJG c(200), WSY_YLJG c(200), SFZZYJH c(100), MD c(100), RYQ_T n(12,0), RYQ_XS n(18,0), RYQ_F n(12,0), RYH_T n(12,0), RYH_XS n(18,0), RYH_F n(12,0), ZFY n(12,2), ZFJE n(12,2), YLFUF n(12,2), ZLCZF n(12,2), HLF n(12,2), QTFY n(12,2), BLZDF n(12,2), SYSZDF n(12,2), YXXZDF n(12,2), LCZDXMF n(12,2), FSSZLXMF n(12,2), WLZLF n(12,2), SSZLF n(12,2), MAF n(12,2), SSF n(12,2), KFF n(12,2), ZYZLF n(12,2), XYF n(12,2), KJYWF n(12,2), ZCYF n(12,2), ZCYF1 n(12,2), XF n(12,2), BDBLZPF n(12,2), QDBLZPF n(12,2), NXYZLZPF n(12,2), XBYZLZPF n(12,2), HCYYCLF n(12,2), YYCLF n(12,2), YCXYYCLF n(12,2), QTF n(12,2))";

                //createTab = "create table N041 (USERNAME VARCHAR(60), YLFKFS VARCHAR(100), JKKH VARCHAR(100), ZYCS VARCHAR(100), BAH VARCHAR(100), XM VARCHAR(100), XB VARCHAR(100), CSRQ VARCHAR(12), NL NUMERIC(10), GJ VARCHAR(100), BZYZSNL NUMERIC(4,0), XSECSTZ NUMERIC(12,2), XSERYTZ NUMERIC(12,2), CSD VARCHAR(200), GG VARCHAR(200), MZ VARCHAR(100), SFZH VARCHAR(100), ZY VARCHAR(100), HY VARCHAR(100), XZZ VARCHAR(100), DH VARCHAR(100), YB1 VARCHAR(100), HKDZ VARCHAR(100), YB2 VARCHAR(100), GZDWJDZ VARCHAR(100), DWDH VARCHAR(100), YB3 VARCHAR(100), LXRXM VARCHAR(100), GX VARCHAR(100), DZ VARCHAR(100), DH2 VARCHAR(100), RYTJ VARCHAR(100), RYSJ VARCHAR(12), RYSJS NUMERIC(24,0), RYKB VARCHAR(100), RYBF VARCHAR(100), ZKKB VARCHAR(100), CYSJ VARCHAR(12), CYSJS NUMERIC(24,0), CYKB VARCHAR(100), CYBF VARCHAR(100), SJZYTS VARCHAR(100), MZZD VARCHAR(200), ZYZD VARCHAR(190))";
                //createTab = @"create table d:\N042 (USERNAME n(12,0) null)";
                //olde.DoCommand(createTab);

                 string strSQl = "insert into N041(USERNAME, YLFKFS, JKKH, ZYCS, BAH, XM, XB, CSRQ, NL, GJ, BZYZSNL, XSECSTZ, XSERYTZ, CSD, GG, MZ, SFZH, ZY, HY, XZZ, DH, YB1, HKDZ, YB2, GZDWJDZ, DWDH, YB3, LXRXM, GX, DZ, DH2, RYTJ, RYSJ, RYSJS, RYKB, RYBF, ZKKB, CYSJ, CYSJS, CYKB, CYBF, SJZYTS, MZZD, JBBM, ZYZD, JBDM, RYBQ, QTZD8, JBDM8, RYBQ8, QTZD1, JBDM1, RYBQ1, QTZD9, JBDM9, RYBQ9, QTZD2, JBDM2, RYBQ2, QTZD10, JBDM10, RYBQ10, QTZD3, JBDM3, RYBQ3, QTZD11, JBDM11, RYBQ11, QTZD4, JBDM4, RYBQ4, QTZD12, JBDM12, RYBQ12, QTZD5, JBDM5, RYBQ5, QTZD13, JBDM13, RYBQ13, QTZD6, JBDM6, RYBQ6, QTZD14, JBDM14, RYBQ14, QTZD7, JBDM7, RYBQ7, QTZD15, JBDM15, RYBQ15, WBYY, H23, BLZD, JBMM, BLH, YWGM, GMYW, SWHZSJ, XX, RH, KZR, ZRYS, ZZYS, ZYYS, ZRHS, JXYS, SXYS, BMY, BAZL, ZKYS, ZKHS, ZKRQ, SSJCZBM1, SSJCZRQ1, SSJB1, SSJCZMC1, SZ1, YZ1, EZ1, QKDJ1, QKYHLB1, MZFS1, MZYS1, SSJCZBM2, SSJCZRQ2, SSJB2, SSJCZMC2, SZ2, YZ2, EZ2, QKDJ2, QKYHLB2, MZFS2, MZYS2, SSJCZBM3, SSJCZRQ3, SSJB3, SSJCZMC3, SZ3, YZ3, EZ3, QKDJ3, QKYHLB3, MZFS3, MZYS3, SSJCZBM4, SSJCZRQ4, SSJB4, SSJCZMC4, SZ4, YZ4, EZ4, QKDJ4, QKYHLB4, MZFS4, MZYS4, SSJCZBM5, SSJCZRQ5, SSJB5, SSJCZMC5, SZ5, YZ5, EZ5, QKDJ5, QKYHLB5, MZFS5, MZYS5, SSJCZBM6, SSJCZRQ6, SSJB6, SSJCZMC6, SZ6, YZ6, EZ6, QKDJ6, QKYHLB6, MZFS6, MZYS6, SSJCZBM7, SSJCZRQ7, SSJB7, SSJCZMC7, SZ7, YZ7, EZ7, QKDJ7, QKYHLB7, MZFS7, MZYS7, LYFS, YZZY_YLJG, WSY_YLJG, SFZZYJH, MD, RYQ_T, RYQ_XS, RYQ_F, RYH_T, RYH_XS, RYH_F, ZFY, ZFJE, YLFUF, ZLCZF, HLF, QTFY, BLZDF, SYSZDF, YXXZDF, LCZDXMF, FSSZLXMF, WLZLF, SSZLF, MAF, SSF, KFF, ZYZLF, XYF, KJYWF, ZCYF, ZCYF1, XF, BDBLZPF, QDBLZPF, NXYZLZPF, XBYZLZPF, HCYYCLF, YYCLF, YCXYYCLF, QTF,USERIDKEY,TBJGDM) values ('œÊÃ∂ –∫Ï Æ◊÷» ∫Õ“Ω‘∫', '01', '', '1', '00008429                      ', '÷‹””∑≤                        ', '1', '1934-01-23', 78, '÷–π˙', 0, 0.00, 0.00, '∫˛ƒœ≥§…≥ –', '∫˛ƒœ≥§…≥ –', '∫∫◊Â', '430103193401233015  ', '80  ', '2', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷                                      ', '84723448      ', '410000', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷', '410000', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷                                      ', '84723448      ', '410000', '                              ', '8', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷                                      ', '84723448      ', '2', '2013-01-19', 11, '11', '', '', '2013-01-23', 15, '11', '', '4', '±«≥ˆ—™', 'R04.000', '±«≥ˆ—™', 'R04.000             ', '1', '', '', '', '∏ﬂ—™—π≤°', 'I10.x00             ', '1', '', '', '', '2–ÕÃ«ƒÚ≤°', 'E11.900             ', '1', '', '', '', 'π⁄◊¥∂Ø¬ˆ÷‡—˘”≤ªØ–‘–ƒ‘‡≤°', 'I25.103             ', '1', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '1', '', ' ', '6', '4', 'Õıƒ˛                          ', '…≥…Ø                          ', '÷‹∆Ω                          ', '÷‹∆Ω                          ', '', '                              ', '                              ', '”‡—‡                          ', '1', '…≥…Ø                          ', '¿Ó¡¯                          ', '2013-01-23', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '1', '', '', '1', '', 0, 0, 0, 0, 0, 0, 3699.5100, 777.58, 168.00, 91.00, 60.00, 0.00, 0.00, 1633.00, 364.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1380.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 3.50, 0.00, 0.00, 0.00,'1','1')";
                 strSQl = "insert into N043(USERNAME, YLFKFS, JKKH, ZYCS, BAH, XM, XB, CSRQ, NL, GJ, BZYZSNL, XSECSTZ, XSERYTZ, CSD, GG, MZ, SFZH, ZY, HY, XZZ, DH, YB1, HKDZ, YB2, GZDWJDZ, DWDH, YB3, LXRXM, GX, DZ, DH2, RYTJ, RYSJ, RYSJS, RYKB, RYBF, ZKKB, CYSJ, CYSJS, CYKB, CYBF, SJZYTS, MZZD, JBBM, ZYZD, JBDM, RYBQ, QTZD8, JBDM8, RYBQ8, QTZD1, JBDM1, RYBQ1, QTZD9, JBDM9, RYBQ9, QTZD2, JBDM2, RYBQ2, QTZD10, JBDM10, RYBQ10, QTZD3, JBDM3, RYBQ3, QTZD11, JBDM11, RYBQ11, QTZD4, JBDM4, RYBQ4, QTZD12, JBDM12, RYBQ12, QTZD5, JBDM5, RYBQ5, QTZD13, JBDM13, RYBQ13, QTZD6, JBDM6, RYBQ6, QTZD14, JBDM14, RYBQ14, QTZD7, JBDM7, RYBQ7, QTZD15, JBDM15, RYBQ15, WBYY, H23, BLZD, JBMM, BLH, YWGM, GMYW, SWHZSJ, XX, RH, KZR, ZRYS, ZZYS, ZYYS, ZRHS, JXYS, SXYS, BMY, BAZL, ZKYS, ZKHS, ZKRQ, SSJCZBM1, SSJCZRQ1, SSJB1, SSJCZMC1, SZ1, YZ1, EZ1, QKDJ1, QKYHLB1, MZFS1, MZYS1, SSJCZBM2, SSJCZRQ2, SSJB2, SSJCZMC2, SZ2, YZ2, EZ2, QKDJ2, QKYHLB2, MZFS2, MZYS2, SSJCZBM3, SSJCZRQ3, SSJB3, SSJCZMC3, SZ3, YZ3, EZ3, QKDJ3, QKYHLB3, MZFS3, MZYS3, SSJCZBM4, SSJCZRQ4, SSJB4, SSJCZMC4, SZ4, YZ4, EZ4, QKDJ4, QKYHLB4, MZFS4, MZYS4, SSJCZBM5, SSJCZRQ5, SSJB5, SSJCZMC5, SZ5, YZ5, EZ5, QKDJ5, QKYHLB5, MZFS5, MZYS5, SSJCZBM6, SSJCZRQ6, SSJB6, SSJCZMC6, SZ6, YZ6, EZ6, QKDJ6, QKYHLB6, MZFS6, MZYS6, SSJCZBM7, SSJCZRQ7, SSJB7, SSJCZMC7, SZ7, YZ7, EZ7, QKDJ7, QKYHLB7, MZFS7, MZYS7, LYFS, YZZY_YLJG, WSY_YLJG, SFZZYJH, MD, RYQ_T, RYQ_XS, RYQ_F, RYH_T, RYH_XS, RYH_F, ZFY, ZFJE, YLFUF, ZLCZF, HLF, QTFY, BLZDF, SYSZDF, YXXZDF, LCZDXMF, FSSZLXMF, WLZLF, SSZLF, MAF, SSF, KFF, ZYZLF, XYF, KJYWF, ZCYF, ZCYF1, XF, BDBLZPF, QDBLZPF, NXYZLZPF, XBYZLZPF, HCYYCLF, YYCLF, YCXYYCLF, QTF) values ('œÊÃ∂ –∫Ï Æ◊÷» ∫Õ“Ω‘∫', '01', '', '1', '00008429                      ', '÷‹””∑≤                        ', '1', '1934-01-23', 78, '÷–π˙', 0, 0.00, 0.00, '∫˛ƒœ≥§…≥ –', '∫˛ƒœ≥§…≥ –', '∫∫◊Â', '430103193401233015  ', '80  ', '2', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷                                      ', '84723448      ', '410000', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷', '410000', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷                                      ', '84723448      ', '410000', '                              ', '8', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷                                      ', '84723448      ', '2', '2013-01-19', 11, '11', '', '', '2013-01-23', 15, '11', '', '4', '±«≥ˆ—™', 'R04.000', '±«≥ˆ—™', 'R04.000             ', '1', '', '', '', '∏ﬂ—™—π≤°', 'I10.x00             ', '1', '', '', '', '2–ÕÃ«ƒÚ≤°', 'E11.900             ', '1', '', '', '', 'π⁄◊¥∂Ø¬ˆ÷‡—˘”≤ªØ–‘–ƒ‘‡≤°', 'I25.103             ', '1', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '1', '', ' ', '6', '4', 'Õıƒ˛                          ', '…≥…Ø                          ', '÷‹∆Ω                          ', '÷‹∆Ω                          ', '', '                              ', '                              ', '”‡—‡                          ', '1', '…≥…Ø                          ', '¿Ó¡¯                          ', '2013-01-23', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '1', '', '', '1', '', 0, 0, 0, 0, 0, 0, 3699.5100, 777.58, 168.00, 91.00, 60.00, 0.00, 0.00, 1633.00, 364.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1380.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 3.50, 0.00, 0.00, 0.00)";
 
                //strSQl = "insert into N041(USERNAME) values('œ‡')";
                //olde.DoCommand(strSQl);
                //olde.Close();
                OdbcCommand cmd = new OdbcCommand();
                cmd.CommandText = createTab;
                cmd.Connection = ODBC;

                int row = cmd.ExecuteNonQuery();

                OdbcCommand cmd1 = new OdbcCommand();
                cmd1.CommandText = strSQl;
                cmd1.Connection = ODBC;

                cmd1.ExecuteNonQuery();

                ODBC.Close();
            }
            catch(Exception ex)
            {
                MessageBox.Show(ex.Message);
            }
            //olde.DoCommand("insert into test2.dbf(kind,code,name) values (1,2,'≤‚ ‘')");
            //DataTable db2 = olde.GetDataTable("select * from test2.dbf");
            //foreach (DataRow dr in db1.Rows)
            //{
            //    DataRow dr2 = db2.NewRow();
            //    for (int i = 0; i < db1.Columns.Count; i++)
            //    {
            //        if (db1.Columns[i].DataType.ToString() == "System.Double")
            //            dr2[i] = Convert.ToInt32(dr[i]);
            //        else dr2[i] = dr[i];
            //    }
            //    dr2.ItemArray = dr.ItemArray;
            //    db2.Rows.Add(dr2);



            //}
            //Trasen.DbAcc.InstanceBaseForm.BDatabase = olde;
            //Trasen.DbAcc.DbOpt.UpdateTable(db2, "select * from test2.dbf");


            //int i=0;



//            Dim strCn As String = "Provider=Microsoft.Jet.OLEDB.4.0;" & _

//"Data Source=C:\DBFôn∞∏À˘‘⁄ŸY¡œäA;" & _

//"Extended Properties=dBASE IV;" & _

//"User ID=Admin;Password=;"


//Dim strQry As String = "Select * From ƒ≥ƒ≥.dbf"


//Dim cn As New OleDbConnection(strCn)

//Dim da As New OleDbDataAdapter(strQry, cn)

//Dim ds As New DataSet


//da.Fill(ds)

//DataGridView1.DataSource = ds.Tables(0)


//PS : ConnectionString µƒ Extended Properties ø…ûÈ dBASE IV ªÚ dBASE 5.0 ªÚ dBASE III°£

//“≤ø…“‘ « FoxPro 2.0 °¢ FoxPro 2.5 °¢ FoxPro 2.6 °¢ FoxPro 3.0






        }

        private void button2_Click(object sender, EventArgs e)
        {
            OdbcConnection oConn = new System.Data.Odbc.OdbcConnection();
            oConn.ConnectionString = "Driver={Microsoft dBase Driver (*.dbf)};DriverID=277;Dbq=d:\\" ;
            string createTab = "create table test2.dbf(kind numeric(16,0) ,code numeric(16,0) ,name varchar(100),px numeric(16,0) ,yx numeric(16,0) ,bz varchar(200))";



            oConn.Open();
            OdbcCommand cmd = new OdbcCommand(createTab, oConn);
            cmd.ExecuteNonQuery();

            cmd = new OdbcCommand("insert into test2.dbf(kind,code,name) values (1,2,'≤‚ ‘')", oConn);

            cmd.ExecuteNonQuery();
           // string str_oleConn = @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=d:/;Extended Properties=dBASE IV;";
           ////str_oleConn =@"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=c:\;Extended Properties=""dBASE IV;HDR=Yes;"";" 
           // System.Data.OleDb.OleDbConnection ole_conn = new System.Data.OleDb.OleDbConnection(str_oleConn);

           // try
           // {
           //     ole_conn.Open();
           //     System.Data.OleDb.OleDbCommand cmd1 = new System.Data.OleDb.OleDbCommand
           //             ("Create Table test4 (Field1 int, Field2 char(10))",
           //             ole_conn);
           //     System.Data.OleDb.OleDbCommand cmd2 = new System.Data.OleDb.OleDbCommand
           //             ("Insert Into test4  values (1,'Hello3')", ole_conn);
           //     System.Data.OleDb.OleDbCommand cmd3 = new System.Data.OleDb.OleDbCommand
           //             ("Insert Into test4  values (2,'Hello4')", ole_conn);
           //     cmd1.ExecuteNonQuery();
           //     cmd2.ExecuteNonQuery();
           //     cmd3.ExecuteNonQuery();
           // }
           // catch (Exception ex)
           // {
           //     MessageBox.Show(ex.Message);
           // }
           // finally
           // {
           //     ole_conn.Close();
           // } 

        }

        private void button3_Click(object sender, EventArgs e)
        {
            TransDBFClass t = new TransDBFClass();
            t.AccessToExcel(@"d:\π´‘¢.mdb");
            //DataRow dr = new DataRow();
       
        }

        private void button4_Click(object sender, EventArgs e)
        {
            TransDBFClass t = new TransDBFClass();
            t.ExcelToDbf();
        }

        private void button5_Click(object sender, EventArgs e)
        {
            try
            {
                string conn = (@"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=D:\db.mdb;");
                //OleDB olde = new OleDB();

                //olde.Initialize(conn);
                //string createTab = "create table test2.dbf(kind numeric(16,0) ,code numeric(16,0) ,name varchar(100),px numeric(16,0) ,yx numeric(16,0) ,bz varchar(200))";
                ////createTab = "create table N041 (USERNAME VARCHAR(60), YLFKFS VARCHAR(100), JKKH VARCHAR(100), ZYCS VARCHAR(100), BAH VARCHAR(100), XM VARCHAR(100), XB VARCHAR(100), CSRQ VARCHAR(12), NL NUMERIC(10), GJ VARCHAR(100), BZYZSNL NUMERIC(4,0), XSECSTZ NUMERIC(12,2), XSERYTZ NUMERIC(12,2), CSD VARCHAR(200), GG VARCHAR(200), MZ VARCHAR(100), SFZH VARCHAR(100), ZY VARCHAR(100), HY VARCHAR(100), XZZ VARCHAR(100), DH VARCHAR(100), YB1 VARCHAR(100), HKDZ VARCHAR(100), YB2 VARCHAR(100), GZDWJDZ VARCHAR(100), DWDH VARCHAR(100), YB3 VARCHAR(100), LXRXM VARCHAR(100), GX VARCHAR(100), DZ VARCHAR(100), DH2 VARCHAR(100), RYTJ VARCHAR(100), RYSJ VARCHAR(12), RYSJS NUMERIC(24,0), RYKB VARCHAR(100), RYBF VARCHAR(100), ZKKB VARCHAR(100), CYSJ VARCHAR(12), CYSJS NUMERIC(24,0), CYKB VARCHAR(100), CYBF VARCHAR(100), SJZYTS VARCHAR(100), MZZD VARCHAR(200), JBBM VARCHAR(100), ZYZD VARCHAR(200), JBDM VARCHAR(100), RYBQ VARCHAR(100), QTZD8 VARCHAR(200), JBDM8 VARCHAR(100), RYBQ8 VARCHAR(100), QTZD1 VARCHAR(200), JBDM1 VARCHAR(100), RYBQ1 VARCHAR(100), QTZD9 VARCHAR(200), JBDM9 VARCHAR(100), RYBQ9 VARCHAR(100), QTZD2 VARCHAR(200), JBDM2 VARCHAR(100), RYBQ2 VARCHAR(100), QTZD10 VARCHAR(200), JBDM10 VARCHAR(100), RYBQ10 VARCHAR(100), QTZD3 VARCHAR(200), JBDM3 VARCHAR(100), RYBQ3 VARCHAR(100), QTZD11 VARCHAR(200), JBDM11 VARCHAR(100), RYBQ11 VARCHAR(100), QTZD4 VARCHAR(200), JBDM4 VARCHAR(100), RYBQ4 VARCHAR(100), QTZD12 VARCHAR(200), JBDM12 VARCHAR(100), RYBQ12 VARCHAR(100), QTZD5 VARCHAR(200), JBDM5 VARCHAR(100), RYBQ5 VARCHAR(100), QTZD13 VARCHAR(200), JBDM13 VARCHAR(100), RYBQ13 VARCHAR(100), QTZD6 VARCHAR(200), JBDM6 VARCHAR(100), RYBQ6 VARCHAR(100), QTZD14 VARCHAR(200), JBDM14 VARCHAR(100), RYBQ14 VARCHAR(100), QTZD7 VARCHAR(200), JBDM7 VARCHAR(100), RYBQ7 VARCHAR(100), QTZD15 VARCHAR(200), JBDM15 VARCHAR(100), RYBQ15 VARCHAR(100), WBYY VARCHAR(254), H23 VARCHAR(100), BLZD VARCHAR(100), JBMM VARCHAR(100), BLH VARCHAR(100), YWGM VARCHAR(254), GMYW VARCHAR(100), SWHZSJ VARCHAR(100), XX VARCHAR(100), RH VARCHAR(100), KZR VARCHAR(100), ZRYS VARCHAR(100), ZZYS VARCHAR(100), ZYYS VARCHAR(100), ZRHS VARCHAR(100), JXYS VARCHAR(100), SXYS VARCHAR(100), BMY VARCHAR(100), BAZL VARCHAR(100), ZKYS VARCHAR(100), ZKHS VARCHAR(100), ZKRQ VARCHAR(12), SSJCZBM1 VARCHAR(100), SSJCZRQ1 VARCHAR(12), SSJB1 VARCHAR(100), SSJCZMC1 VARCHAR(200), SZ1 VARCHAR(100), YZ1 VARCHAR(100), EZ1 VARCHAR(100), QKDJ1 VARCHAR(100), QKYHLB1 VARCHAR(100), MZFS1 VARCHAR(100), MZYS1 VARCHAR(100), SSJCZBM2 VARCHAR(100), SSJCZRQ2 VARCHAR(12), SSJB2 VARCHAR(100), SSJCZMC2 VARCHAR(200), SZ2 VARCHAR(100), YZ2 VARCHAR(100), EZ2 VARCHAR(100), QKDJ2 VARCHAR(100), QKYHLB2 VARCHAR(100), MZFS2 VARCHAR(100), MZYS2 VARCHAR(100), SSJCZBM3 VARCHAR(100), SSJCZRQ3 VARCHAR(12), SSJB3 VARCHAR(100), SSJCZMC3 VARCHAR(200), SZ3 VARCHAR(100), YZ3 VARCHAR(100), EZ3 VARCHAR(100), QKDJ3 VARCHAR(100), QKYHLB3 VARCHAR(100), MZFS3 VARCHAR(100), MZYS3 VARCHAR(100), SSJCZBM4 VARCHAR(100), SSJCZRQ4 VARCHAR(12), SSJB4 VARCHAR(100), SSJCZMC4 VARCHAR(200), SZ4 VARCHAR(100), YZ4 VARCHAR(100), EZ4 VARCHAR(100), QKDJ4 VARCHAR(100), QKYHLB4 VARCHAR(100), MZFS4 VARCHAR(100), MZYS4 VARCHAR(100), SSJCZBM5 VARCHAR(100), SSJCZRQ5 VARCHAR(12), SSJB5 VARCHAR(100), SSJCZMC5 VARCHAR(200), SZ5 VARCHAR(100), YZ5 VARCHAR(100), EZ5 VARCHAR(100), QKDJ5 VARCHAR(100), QKYHLB5 VARCHAR(100), MZFS5 VARCHAR(100), MZYS5 VARCHAR(100), SSJCZBM6 VARCHAR(100), SSJCZRQ6 VARCHAR(12), SSJB6 VARCHAR(100), SSJCZMC6 VARCHAR(200), SZ6 VARCHAR(100), YZ6 VARCHAR(100), EZ6 VARCHAR(100), QKDJ6 VARCHAR(100), QKYHLB6 VARCHAR(100), MZFS6 VARCHAR(100), MZYS6 VARCHAR(100), SSJCZBM7 VARCHAR(100), SSJCZRQ7 VARCHAR(12), SSJB7 VARCHAR(100), SSJCZMC7 VARCHAR(200), SZ7 VARCHAR(100), YZ7 VARCHAR(100), EZ7 VARCHAR(100), QKDJ7 VARCHAR(100), QKYHLB7 VARCHAR(100), MZFS7 VARCHAR(100), MZYS7 VARCHAR(100), LYFS VARCHAR(100), YZZY_YLJG VARCHAR(200), WSY_YLJG VARCHAR(200), SFZZYJH VARCHAR(100), MD VARCHAR(100), RYQ_T NUMERIC(12,0), RYQ_XS NUMERIC(24,0), RYQ_F NUMERIC(12,0), RYH_T NUMERIC(12,0), RYH_XS NUMERIC(24,0), RYH_F NUMERIC(12,0), ZFY NUMERIC(12,2), ZFJE NUMERIC(12,2), YLFUF NUMERIC(12,2), ZLCZF NUMERIC(12,2), HLF NUMERIC(12,2), QTFY NUMERIC(12,2), BLZDF NUMERIC(12,2), SYSZDF NUMERIC(12,2), YXXZDF NUMERIC(12,2), LCZDXMF NUMERIC(12,2), FSSZLXMF NUMERIC(12,2), WLZLF NUMERIC(12,2), SSZLF NUMERIC(12,2), MAF NUMERIC(12,2), SSF NUMERIC(12,2), KFF NUMERIC(12,2), ZYZLF NUMERIC(12,2), XYF NUMERIC(12,2), KJYWF NUMERIC(12,2), ZCYF NUMERIC(12,2), ZCYF1 NUMERIC(12,2), XF NUMERIC(12,2), BDBLZPF NUMERIC(12,2), QDBLZPF NUMERIC(12,2), NXYZLZPF NUMERIC(12,2), XBYZLZPF NUMERIC(12,2), HCYYCLF NUMERIC(12,2), YYCLF NUMERIC(12,2), YCXYYCLF NUMERIC(12,2), QTF NUMERIC(12,2))";
                //createTab = "create table N041 (USERNAME VARCHAR(60), YLFKFS VARCHAR(100), JKKH VARCHAR(100), ZYCS VARCHAR(100), BAH VARCHAR(100), XM VARCHAR(100), XB VARCHAR(100), CSRQ VARCHAR(12), NL NUMERIC(10,0), GJ VARCHAR(100), BZYZSNL NUMERIC(4,0), XSECSTZ NUMERIC(12,2), XSERYTZ NUMERIC(12,2), CSD VARCHAR(200), GG VARCHAR(200), MZ VARCHAR(100), SFZH VARCHAR(100), ZY VARCHAR(100), HY VARCHAR(100), XZZ VARCHAR(100), DH VARCHAR(100), YB1 VARCHAR(100), HKDZ VARCHAR(100), YB2 VARCHAR(100), GZDWJDZ VARCHAR(100), DWDH VARCHAR(100), YB3 VARCHAR(100), LXRXM VARCHAR(100), GX VARCHAR(100), DZ VARCHAR(100), DH2 VARCHAR(100), RYTJ VARCHAR(100), RYSJ VARCHAR(12), RYSJS NUMERIC(18,0), RYKB VARCHAR(100), RYBF VARCHAR(100), ZKKB VARCHAR(100), CYSJ VARCHAR(12), CYSJS NUMERIC(18,0), CYKB VARCHAR(100), CYBF VARCHAR(100), SJZYTS VARCHAR(100), MZZD VARCHAR(200), JBBM VARCHAR(100), ZYZD VARCHAR(200), JBDM VARCHAR(100), RYBQ VARCHAR(100), QTZD8 VARCHAR(200), JBDM8 VARCHAR(100), RYBQ8 VARCHAR(100), QTZD1 VARCHAR(200), JBDM1 VARCHAR(100), RYBQ1 VARCHAR(100), QTZD9 VARCHAR(200), JBDM9 VARCHAR(100), RYBQ9 VARCHAR(100), QTZD2 VARCHAR(200), JBDM2 VARCHAR(100), RYBQ2 VARCHAR(100), QTZD10 VARCHAR(200), JBDM10 VARCHAR(100), RYBQ10 VARCHAR(100), QTZD3 VARCHAR(200), JBDM3 VARCHAR(100), RYBQ3 VARCHAR(100), QTZD11 VARCHAR(200), JBDM11 VARCHAR(100), RYBQ11 VARCHAR(100), QTZD4 VARCHAR(200), JBDM4 VARCHAR(100), RYBQ4 VARCHAR(100), QTZD12 VARCHAR(200), JBDM12 VARCHAR(100), RYBQ12 VARCHAR(100), QTZD5 VARCHAR(200), JBDM5 VARCHAR(100), RYBQ5 VARCHAR(100), QTZD13 VARCHAR(200), JBDM13 VARCHAR(100), RYBQ13 VARCHAR(100), QTZD6 VARCHAR(200), JBDM6 VARCHAR(100), RYBQ6 VARCHAR(100), QTZD14 VARCHAR(200), JBDM14 VARCHAR(100), RYBQ14 VARCHAR(100), QTZD7 VARCHAR(200), JBDM7 VARCHAR(100), RYBQ7 VARCHAR(100), QTZD15 VARCHAR(200), JBDM15 VARCHAR(100), RYBQ15 VARCHAR(100), WBYY VARCHAR(254), H23 VARCHAR(100), BLZD VARCHAR(100), JBMM VARCHAR(100), BLH VARCHAR(100), YWGM VARCHAR(254), GMYW VARCHAR(100), SWHZSJ VARCHAR(100), XX VARCHAR(100), RH VARCHAR(100), KZR VARCHAR(100), ZRYS VARCHAR(100), ZZYS VARCHAR(100), ZYYS VARCHAR(100), ZRHS VARCHAR(100), JXYS VARCHAR(100), SXYS VARCHAR(100), BMY VARCHAR(100), BAZL VARCHAR(100), ZKYS VARCHAR(100), ZKHS VARCHAR(100), ZKRQ VARCHAR(12), SSJCZBM1 VARCHAR(100), SSJCZRQ1 VARCHAR(12), SSJB1 VARCHAR(100), SSJCZMC1 VARCHAR(200), SZ1 VARCHAR(100), YZ1 VARCHAR(100), EZ1 VARCHAR(100), QKDJ1 VARCHAR(100), QKYHLB1 VARCHAR(100), MZFS1 VARCHAR(100), MZYS1 VARCHAR(100), SSJCZBM2 VARCHAR(100), SSJCZRQ2 VARCHAR(12), SSJB2 VARCHAR(100), SSJCZMC2 VARCHAR(200), SZ2 VARCHAR(100), YZ2 VARCHAR(100), EZ2 VARCHAR(100), QKDJ2 VARCHAR(100), QKYHLB2 VARCHAR(100), MZFS2 VARCHAR(100), MZYS2 VARCHAR(100), SSJCZBM3 VARCHAR(100), SSJCZRQ3 VARCHAR(12), SSJB3 VARCHAR(100), SSJCZMC3 VARCHAR(200), SZ3 VARCHAR(100), YZ3 VARCHAR(100), EZ3 VARCHAR(100), QKDJ3 VARCHAR(100), QKYHLB3 VARCHAR(100), MZFS3 VARCHAR(100), MZYS3 VARCHAR(100), SSJCZBM4 VARCHAR(100), SSJCZRQ4 VARCHAR(12), SSJB4 VARCHAR(100), SSJCZMC4 VARCHAR(200), SZ4 VARCHAR(100), YZ4 VARCHAR(100), EZ4 VARCHAR(100), QKDJ4 VARCHAR(100), QKYHLB4 VARCHAR(100), MZFS4 VARCHAR(100), MZYS4 VARCHAR(100), SSJCZBM5 VARCHAR(100), SSJCZRQ5 VARCHAR(12), SSJB5 VARCHAR(100), SSJCZMC5 VARCHAR(200), SZ5 VARCHAR(100), YZ5 VARCHAR(100), EZ5 VARCHAR(100), QKDJ5 VARCHAR(100), QKYHLB5 VARCHAR(100), MZFS5 VARCHAR(100), MZYS5 VARCHAR(100), SSJCZBM6 VARCHAR(100), SSJCZRQ6 VARCHAR(12), SSJB6 VARCHAR(100), SSJCZMC6 VARCHAR(200), SZ6 VARCHAR(100), YZ6 VARCHAR(100), EZ6 VARCHAR(100), QKDJ6 VARCHAR(100), QKYHLB6 VARCHAR(100), MZFS6 VARCHAR(100), MZYS6 VARCHAR(100), SSJCZBM7 VARCHAR(100), SSJCZRQ7 VARCHAR(12), SSJB7 VARCHAR(100), SSJCZMC7 VARCHAR(200), SZ7 VARCHAR(100), YZ7 VARCHAR(100), EZ7 VARCHAR(100), QKDJ7 VARCHAR(100), QKYHLB7 VARCHAR(100), MZFS7 VARCHAR(100), MZYS7 VARCHAR(100), LYFS VARCHAR(100), YZZY_YLJG VARCHAR(200), WSY_YLJG VARCHAR(200), SFZZYJH VARCHAR(100), MD VARCHAR(100), RYQ_T NUMERIC(12,0), RYQ_XS NUMERIC(18,0), RYQ_F NUMERIC(12,0), RYH_T NUMERIC(12,0), RYH_XS NUMERIC(18,0), RYH_F NUMERIC(12,0), ZFY NUMERIC(12,2), ZFJE NUMERIC(12,2), YLFUF NUMERIC(12,2), ZLCZF NUMERIC(12,2), HLF NUMERIC(12,2), QTFY NUMERIC(12,2), BLZDF NUMERIC(12,2), SYSZDF NUMERIC(12,2), YXXZDF NUMERIC(12,2), LCZDXMF NUMERIC(12,2), FSSZLXMF NUMERIC(12,2), WLZLF NUMERIC(12,2), SSZLF NUMERIC(12,2), MAF NUMERIC(12,2), SSF NUMERIC(12,2), KFF NUMERIC(12,2), ZYZLF NUMERIC(12,2), XYF NUMERIC(12,2), KJYWF NUMERIC(12,2), ZCYF NUMERIC(12,2), ZCYF1 NUMERIC(12,2), XF NUMERIC(12,2), BDBLZPF NUMERIC(12,2), QDBLZPF NUMERIC(12,2), NXYZLZPF NUMERIC(12,2), XBYZLZPF NUMERIC(12,2), HCYYCLF NUMERIC(12,2), YYCLF NUMERIC(12,2), YCXYYCLF NUMERIC(12,2), QTF NUMERIC(12,2))";
                ////createTab = "create table N041 (USERNAME VARCHAR(60), YLFKFS VARCHAR(100), JKKH VARCHAR(100), ZYCS VARCHAR(100), BAH VARCHAR(100), XM VARCHAR(100), XB VARCHAR(100), CSRQ VARCHAR(12), NL NUMERIC(10), GJ VARCHAR(100), BZYZSNL NUMERIC(4,0), XSECSTZ NUMERIC(12,2), XSERYTZ NUMERIC(12,2), CSD VARCHAR(200), GG VARCHAR(200), MZ VARCHAR(100), SFZH VARCHAR(100), ZY VARCHAR(100), HY VARCHAR(100), XZZ VARCHAR(100), DH VARCHAR(100), YB1 VARCHAR(100), HKDZ VARCHAR(100), YB2 VARCHAR(100), GZDWJDZ VARCHAR(100), DWDH VARCHAR(100), YB3 VARCHAR(100), LXRXM VARCHAR(100), GX VARCHAR(100), DZ VARCHAR(100), DH2 VARCHAR(100), RYTJ VARCHAR(100), RYSJ VARCHAR(12), RYSJS NUMERIC(24,0), RYKB VARCHAR(100), RYBF VARCHAR(100), ZKKB VARCHAR(100), CYSJ VARCHAR(12), CYSJS NUMERIC(24,0), CYKB VARCHAR(100), CYBF VARCHAR(100), SJZYTS VARCHAR(100), MZZD VARCHAR(200), ZYZD VARCHAR(190))";

                //olde.DoCommand(createTab);
                //string strSQl = "insert into N041(USERNAME, YLFKFS, JKKH, ZYCS, BAH, XM, XB, CSRQ, NL, GJ, BZYZSNL, XSECSTZ, XSERYTZ, CSD, GG, MZ, SFZH, ZY, HY, XZZ, DH, YB1, HKDZ, YB2, GZDWJDZ, DWDH, YB3, LXRXM, GX, DZ, DH2, RYTJ, RYSJ, RYSJS, RYKB, RYBF, ZKKB, CYSJ, CYSJS, CYKB, CYBF, SJZYTS, MZZD, JBBM, ZYZD, JBDM, RYBQ, QTZD8, JBDM8, RYBQ8, QTZD1, JBDM1, RYBQ1, QTZD9, JBDM9, RYBQ9, QTZD2, JBDM2, RYBQ2, QTZD10, JBDM10, RYBQ10, QTZD3, JBDM3, RYBQ3, QTZD11, JBDM11, RYBQ11, QTZD4, JBDM4, RYBQ4, QTZD12, JBDM12, RYBQ12, QTZD5, JBDM5, RYBQ5, QTZD13, JBDM13, RYBQ13, QTZD6, JBDM6, RYBQ6, QTZD14, JBDM14, RYBQ14, QTZD7, JBDM7, RYBQ7, QTZD15, JBDM15, RYBQ15, WBYY, H23, BLZD, JBMM, BLH, YWGM, GMYW, SWHZSJ, XX, RH, KZR, ZRYS, ZZYS, ZYYS, ZRHS, JXYS, SXYS, BMY, BAZL, ZKYS, ZKHS, ZKRQ, SSJCZBM1, SSJCZRQ1, SSJB1, SSJCZMC1, SZ1, YZ1, EZ1, QKDJ1, QKYHLB1, MZFS1, MZYS1, SSJCZBM2, SSJCZRQ2, SSJB2, SSJCZMC2, SZ2, YZ2, EZ2, QKDJ2, QKYHLB2, MZFS2, MZYS2, SSJCZBM3, SSJCZRQ3, SSJB3, SSJCZMC3, SZ3, YZ3, EZ3, QKDJ3, QKYHLB3, MZFS3, MZYS3, SSJCZBM4, SSJCZRQ4, SSJB4, SSJCZMC4, SZ4, YZ4, EZ4, QKDJ4, QKYHLB4, MZFS4, MZYS4, SSJCZBM5, SSJCZRQ5, SSJB5, SSJCZMC5, SZ5, YZ5, EZ5, QKDJ5, QKYHLB5, MZFS5, MZYS5, SSJCZBM6, SSJCZRQ6, SSJB6, SSJCZMC6, SZ6, YZ6, EZ6, QKDJ6, QKYHLB6, MZFS6, MZYS6, SSJCZBM7, SSJCZRQ7, SSJB7, SSJCZMC7, SZ7, YZ7, EZ7, QKDJ7, QKYHLB7, MZFS7, MZYS7, LYFS, YZZY_YLJG, WSY_YLJG, SFZZYJH, MD, RYQ_T, RYQ_XS, RYQ_F, RYH_T, RYH_XS, RYH_F, ZFY, ZFJE, YLFUF, ZLCZF, HLF, QTFY, BLZDF, SYSZDF, YXXZDF, LCZDXMF, FSSZLXMF, WLZLF, SSZLF, MAF, SSF, KFF, ZYZLF, XYF, KJYWF, ZCYF, ZCYF1, XF, BDBLZPF, QDBLZPF, NXYZLZPF, XBYZLZPF, HCYYCLF, YYCLF, YCXYYCLF, QTF) values ('œÊÃ∂ –∫Ï Æ◊÷» ∫Õ“Ω‘∫', '01', '', '1', '00008429                      ', '÷‹””∑≤                        ', '1', '1934-01-23', 78, '÷–π˙', 0, 0.00, 0.00, '∫˛ƒœ≥§…≥ –', '∫˛ƒœ≥§…≥ –', '∫∫◊Â', '430103193401233015  ', '80  ', '2', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷                                      ', '84723448      ', '410000', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷', '410000', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷                                      ', '84723448      ', '410000', '                              ', '8', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷                                      ', '84723448      ', '2', '2013-01-19', 11, '11', '', '', '2013-01-23', 15, '11', '', '4', '±«≥ˆ—™', 'R04.000', '±«≥ˆ—™', 'R04.000             ', '1', '', '', '', '∏ﬂ—™—π≤°', 'I10.x00             ', '1', '', '', '', '2–ÕÃ«ƒÚ≤°', 'E11.900             ', '1', '', '', '', 'π⁄◊¥∂Ø¬ˆ÷‡—˘”≤ªØ–‘–ƒ‘‡≤°', 'I25.103             ', '1', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '1', '', ' ', '6', '4', 'Õıƒ˛                          ', '…≥…Ø                          ', '÷‹∆Ω                          ', '÷‹∆Ω                          ', '', '                              ', '                              ', '”‡—‡                          ', '1', '…≥…Ø                          ', '¿Ó¡¯                          ', '2013-01-23', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '1', '', '', '1', '', 0, 0, 0, 0, 0, 0, 3699.5100, 777.58, 168.00, 91.00, 60.00, 0.00, 0.00, 1633.00, 364.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1380.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 3.50, 0.00, 0.00, 0.00)";
                //olde.DoCommand(strSQl);
                //olde.Close();
                new TransDBFClass().AccessToExcel(@"d:\db.mdb");
            }
            catch
            {
                MessageBox.Show("");

            }


        }

        private void button6_Click(object sender, EventArgs e)
        {

            string   connect   =   "Driver={Microsoft   Visual   FoxPro   Driver};SourceType=DBF;SourceDB=d:\\; ";
            connect = @"Dsn=Visual FoxPro Tables;sourcedb=d:\;sourcetype=DBF;exclusive=No;backgroundfetch=Yes;collate=Machine";
            connect = "Driver={Visual FoxPro Tables};sourcetype=DBF;sourcedb=d:\\";

            OdbcConnection   myconn   =   new   OdbcConnection(connect); 
            //string   sqlt   =   "create   table   [test14.dbf](sno   char(6),sname   char(10),age   numeric(3,0))   "; 
              string   sqlt   =   "create table [test14.dbf](sno c(6),sname c(10),age n(3,0)) ";
              myconn.Open(); 
          OdbcCommand   olec   =   new   OdbcCommand(sqlt,   myconn);                 
                try 
                { 
                        int rows=  olec.ExecuteNonQuery(); 

              } 
                catch   (Exception   ex) 
                { 
                       // Response.Write(ex.ToString()); 
                } 
                olec.Dispose(); 
                myconn.Close();



        //    string connect = "Driver={Microsoft Visual FoxPro Driver};SourceType=DBF;SourceDB=d:\\; Exclusive=No;NULL=NO;Collate=Machine;BACKGROUNDFETCH=NO;DELETED=NO";

        //    OdbcConnection myconn = new OdbcConnection(connect);

        //    string sqlt = "CREATE TABLE aa (cc int(10))";

        //    myconn.Open();

        //    OdbcCommand olec = new OdbcCommand(sqlt, myconn);

        //    try
        //    {

        //        int i = olec.ExecuteNonQuery();

        //        MessageBox.Show("'" + i + "'success");

        //    }

        //    catch (Exception ex)
        //    {

        //        MessageBox.Show(ex.Message);

        //    }

        //    finally
        //    {

        //        olec.Dispose();

        //        myconn.Close();

        //    }
            }

        private void button7_Click(object sender, EventArgs e)
        {
            try
            {
                TrasenClasses.DatabaseAccess.RelationalDatabase  dabase = new OdbcVfpDbf(@"d:\");
                dabase.Initialize(dabase.ConnectionString);

                string createTab = @"create table d:\N044 (USERNAME c(60), YLFKFS c(100), JKKH c(100), ZYCS c(100), BAH c(100), XM c(100), XB c(100), CSRQ c(12), NL n(10,0), GJ c(100), BZYZSNL n(4,0), XSECSTZ n(12,2), XSERYTZ n(12,2), CSD c(200), GG c(200), MZ c(100), SFZH c(100), ZY c(100), HY c(100), XZZ c(100), DH c(100), YB1 c(100), HKDZ c(100), YB2 c(100), GZDWJDZ c(100), DWDH c(100), YB3 c(100), LXRXM c(100), GX c(100), DZ c(100), DH2 c(100), RYTJ c(100), RYSJ c(12), RYSJS n(18,0), RYKB c(100), RYBF c(100), ZKKB c(100), CYSJ c(12), CYSJS n(18,0), CYKB c(100), CYBF c(100), SJZYTS c(100), MZZD c(200), JBBM c(100), ZYZD c(200), JBDM c(100), RYBQ c(100), QTZD8 c(200), JBDM8 c(100), RYBQ8 c(100), QTZD1 c(200), JBDM1 c(100), RYBQ1 c(100), QTZD9 c(200), JBDM9 c(100), RYBQ9 c(100), QTZD2 c(200), JBDM2 c(100), RYBQ2 c(100), QTZD10 c(200), JBDM10 c(100), RYBQ10 c(100), QTZD3 c(200), JBDM3 c(100), RYBQ3 c(100), QTZD11 c(200), JBDM11 c(100), RYBQ11 c(100), QTZD4 c(200), JBDM4 c(100), RYBQ4 c(100), QTZD12 c(200), JBDM12 c(100), RYBQ12 c(100), QTZD5 c(200), JBDM5 c(100), RYBQ5 c(100), QTZD13 c(200), JBDM13 c(100), RYBQ13 c(100), QTZD6 c(200), JBDM6 c(100), RYBQ6 c(100), QTZD14 c(200), JBDM14 c(100), RYBQ14 c(100), QTZD7 c(200), JBDM7 c(100), RYBQ7 c(100), QTZD15 c(200), JBDM15 c(100), RYBQ15 c(100), WBYY c(254), H23 c(100), BLZD c(100), JBMM c(100), BLH c(100), YWGM c(254), GMYW c(100), SWHZSJ c(100), XX c(100), RH c(100), KZR c(100), ZRYS c(100), ZZYS c(100), ZYYS c(100), ZRHS c(100), JXYS c(100), SXYS c(100), BMY c(100), BAZL c(100), ZKYS c(100), ZKHS c(100), ZKRQ c(12), SSJCZBM1 c(100), SSJCZRQ1 c(12), SSJB1 c(100), SSJCZMC1 c(200), SZ1 c(100), YZ1 c(100), EZ1 c(100), QKDJ1 c(100), QKYHLB1 c(100), MZFS1 c(100), MZYS1 c(100), SSJCZBM2 c(100), SSJCZRQ2 c(12), SSJB2 c(100), SSJCZMC2 c(200), SZ2 c(100), YZ2 c(100), EZ2 c(100), QKDJ2 c(100), QKYHLB2 c(100), MZFS2 c(100), MZYS2 c(100), SSJCZBM3 c(100), SSJCZRQ3 c(12), SSJB3 c(100), SSJCZMC3 c(200), SZ3 c(100), YZ3 c(100), EZ3 c(100), QKDJ3 c(100), QKYHLB3 c(100), MZFS3 c(100), MZYS3 c(100), SSJCZBM4 c(100), SSJCZRQ4 c(12), SSJB4 c(100), SSJCZMC4 c(200), SZ4 c(100), YZ4 c(100), EZ4 c(100), QKDJ4 c(100), QKYHLB4 c(100), MZFS4 c(100), MZYS4 c(100), SSJCZBM5 c(100), SSJCZRQ5 c(12), SSJB5 c(100), SSJCZMC5 c(200), SZ5 c(100), YZ5 c(100), EZ5 c(100), QKDJ5 c(100), QKYHLB5 c(100), MZFS5 c(100), MZYS5 c(100), SSJCZBM6 c(100), SSJCZRQ6 c(12), SSJB6 c(100), SSJCZMC6 c(200), SZ6 c(100), YZ6 c(100), EZ6 c(100), QKDJ6 c(100), QKYHLB6 c(100), MZFS6 c(100), MZYS6 c(100), SSJCZBM7 c(100), SSJCZRQ7 c(12), SSJB7 c(100), SSJCZMC7 c(200), SZ7 c(100), YZ7 c(100), EZ7 c(100), QKDJ7 c(100), QKYHLB7 c(100), MZFS7 c(100), MZYS7 c(100), LYFS c(100), YZZY_YLJG c(200), WSY_YLJG c(200), SFZZYJH c(100), MD c(100), RYQ_T n(12,0), RYQ_XS n(18,0), RYQ_F n(12,0), RYH_T n(12,0), RYH_XS n(18,0), RYH_F n(12,0), ZFY n(12,2), ZFJE n(12,2), YLFUF n(12,2), ZLCZF n(12,2), HLF n(12,2), QTFY n(12,2), BLZDF n(12,2), SYSZDF n(12,2), YXXZDF n(12,2), LCZDXMF n(12,2), FSSZLXMF n(12,2), WLZLF n(12,2), SSZLF n(12,2), MAF n(12,2), SSF n(12,2), KFF n(12,2), ZYZLF n(12,2), XYF n(12,2), KJYWF n(12,2), ZCYF n(12,2), ZCYF1 n(12,2), XF n(12,2), BDBLZPF n(12,2), QDBLZPF n(12,2), NXYZLZPF n(12,2), XBYZLZPF n(12,2), HCYYCLF n(12,2), YYCLF n(12,2), YCXYYCLF n(12,2), QTF n(12,2))";
                dabase.DoCommand(createTab);

                string strSQl = "insert into N041(USERNAME, YLFKFS, JKKH, ZYCS, BAH, XM, XB, CSRQ, NL, GJ, BZYZSNL, XSECSTZ, XSERYTZ, CSD, GG, MZ, SFZH, ZY, HY, XZZ, DH, YB1, HKDZ, YB2, GZDWJDZ, DWDH, YB3, LXRXM, GX, DZ, DH2, RYTJ, RYSJ, RYSJS, RYKB, RYBF, ZKKB, CYSJ, CYSJS, CYKB, CYBF, SJZYTS, MZZD, JBBM, ZYZD, JBDM, RYBQ, QTZD8, JBDM8, RYBQ8, QTZD1, JBDM1, RYBQ1, QTZD9, JBDM9, RYBQ9, QTZD2, JBDM2, RYBQ2, QTZD10, JBDM10, RYBQ10, QTZD3, JBDM3, RYBQ3, QTZD11, JBDM11, RYBQ11, QTZD4, JBDM4, RYBQ4, QTZD12, JBDM12, RYBQ12, QTZD5, JBDM5, RYBQ5, QTZD13, JBDM13, RYBQ13, QTZD6, JBDM6, RYBQ6, QTZD14, JBDM14, RYBQ14, QTZD7, JBDM7, RYBQ7, QTZD15, JBDM15, RYBQ15, WBYY, H23, BLZD, JBMM, BLH, YWGM, GMYW, SWHZSJ, XX, RH, KZR, ZRYS, ZZYS, ZYYS, ZRHS, JXYS, SXYS, BMY, BAZL, ZKYS, ZKHS, ZKRQ, SSJCZBM1, SSJCZRQ1, SSJB1, SSJCZMC1, SZ1, YZ1, EZ1, QKDJ1, QKYHLB1, MZFS1, MZYS1, SSJCZBM2, SSJCZRQ2, SSJB2, SSJCZMC2, SZ2, YZ2, EZ2, QKDJ2, QKYHLB2, MZFS2, MZYS2, SSJCZBM3, SSJCZRQ3, SSJB3, SSJCZMC3, SZ3, YZ3, EZ3, QKDJ3, QKYHLB3, MZFS3, MZYS3, SSJCZBM4, SSJCZRQ4, SSJB4, SSJCZMC4, SZ4, YZ4, EZ4, QKDJ4, QKYHLB4, MZFS4, MZYS4, SSJCZBM5, SSJCZRQ5, SSJB5, SSJCZMC5, SZ5, YZ5, EZ5, QKDJ5, QKYHLB5, MZFS5, MZYS5, SSJCZBM6, SSJCZRQ6, SSJB6, SSJCZMC6, SZ6, YZ6, EZ6, QKDJ6, QKYHLB6, MZFS6, MZYS6, SSJCZBM7, SSJCZRQ7, SSJB7, SSJCZMC7, SZ7, YZ7, EZ7, QKDJ7, QKYHLB7, MZFS7, MZYS7, LYFS, YZZY_YLJG, WSY_YLJG, SFZZYJH, MD, RYQ_T, RYQ_XS, RYQ_F, RYH_T, RYH_XS, RYH_F, ZFY, ZFJE, YLFUF, ZLCZF, HLF, QTFY, BLZDF, SYSZDF, YXXZDF, LCZDXMF, FSSZLXMF, WLZLF, SSZLF, MAF, SSF, KFF, ZYZLF, XYF, KJYWF, ZCYF, ZCYF1, XF, BDBLZPF, QDBLZPF, NXYZLZPF, XBYZLZPF, HCYYCLF, YYCLF, YCXYYCLF, QTF,USERIDKEY,TBJGDM) values ('œÊÃ∂ –∫Ï Æ◊÷» ∫Õ“Ω‘∫', '01', '', '1', '00008429                      ', '÷‹””∑≤                        ', '1', '1934-01-23', 78, '÷–π˙', 0, 0.00, 0.00, '∫˛ƒœ≥§…≥ –', '∫˛ƒœ≥§…≥ –', '∫∫◊Â', '430103193401233015  ', '80  ', '2', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷                                      ', '84723448      ', '410000', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷', '410000', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷                                      ', '84723448      ', '410000', '                              ', '8', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷                                      ', '84723448      ', '2', '2013-01-19', 11, '11', '', '', '2013-01-23', 15, '11', '', '4', '±«≥ˆ—™', 'R04.000', '±«≥ˆ—™', 'R04.000             ', '1', '', '', '', '∏ﬂ—™—π≤°', 'I10.x00             ', '1', '', '', '', '2–ÕÃ«ƒÚ≤°', 'E11.900             ', '1', '', '', '', 'π⁄◊¥∂Ø¬ˆ÷‡—˘”≤ªØ–‘–ƒ‘‡≤°', 'I25.103             ', '1', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '1', '', ' ', '6', '4', 'Õıƒ˛                          ', '…≥…Ø                          ', '÷‹∆Ω                          ', '÷‹∆Ω                          ', '', '                              ', '                              ', '”‡—‡                          ', '1', '…≥…Ø                          ', '¿Ó¡¯                          ', '2013-01-23', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '1', '', '', '1', '', 0, 0, 0, 0, 0, 0, 3699.5100, 777.58, 168.00, 91.00, 60.00, 0.00, 0.00, 1633.00, 364.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1380.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 3.50, 0.00, 0.00, 0.00,'1','1')";
                strSQl = "insert into N044(USERNAME, YLFKFS, JKKH, ZYCS, BAH, XM, XB, CSRQ, NL, GJ, BZYZSNL, XSECSTZ, XSERYTZ, CSD, GG, MZ, SFZH, ZY, HY, XZZ, DH, YB1, HKDZ, YB2, GZDWJDZ, DWDH, YB3, LXRXM, GX, DZ, DH2, RYTJ, RYSJ, RYSJS, RYKB, RYBF, ZKKB, CYSJ, CYSJS, CYKB, CYBF, SJZYTS, MZZD, JBBM, ZYZD, JBDM, RYBQ, QTZD8, JBDM8, RYBQ8, QTZD1, JBDM1, RYBQ1, QTZD9, JBDM9, RYBQ9, QTZD2, JBDM2, RYBQ2, QTZD10, JBDM10, RYBQ10, QTZD3, JBDM3, RYBQ3, QTZD11, JBDM11, RYBQ11, QTZD4, JBDM4, RYBQ4, QTZD12, JBDM12, RYBQ12, QTZD5, JBDM5, RYBQ5, QTZD13, JBDM13, RYBQ13, QTZD6, JBDM6, RYBQ6, QTZD14, JBDM14, RYBQ14, QTZD7, JBDM7, RYBQ7, QTZD15, JBDM15, RYBQ15, WBYY, H23, BLZD, JBMM, BLH, YWGM, GMYW, SWHZSJ, XX, RH, KZR, ZRYS, ZZYS, ZYYS, ZRHS, JXYS, SXYS, BMY, BAZL, ZKYS, ZKHS, ZKRQ, SSJCZBM1, SSJCZRQ1, SSJB1, SSJCZMC1, SZ1, YZ1, EZ1, QKDJ1, QKYHLB1, MZFS1, MZYS1, SSJCZBM2, SSJCZRQ2, SSJB2, SSJCZMC2, SZ2, YZ2, EZ2, QKDJ2, QKYHLB2, MZFS2, MZYS2, SSJCZBM3, SSJCZRQ3, SSJB3, SSJCZMC3, SZ3, YZ3, EZ3, QKDJ3, QKYHLB3, MZFS3, MZYS3, SSJCZBM4, SSJCZRQ4, SSJB4, SSJCZMC4, SZ4, YZ4, EZ4, QKDJ4, QKYHLB4, MZFS4, MZYS4, SSJCZBM5, SSJCZRQ5, SSJB5, SSJCZMC5, SZ5, YZ5, EZ5, QKDJ5, QKYHLB5, MZFS5, MZYS5, SSJCZBM6, SSJCZRQ6, SSJB6, SSJCZMC6, SZ6, YZ6, EZ6, QKDJ6, QKYHLB6, MZFS6, MZYS6, SSJCZBM7, SSJCZRQ7, SSJB7, SSJCZMC7, SZ7, YZ7, EZ7, QKDJ7, QKYHLB7, MZFS7, MZYS7, LYFS, YZZY_YLJG, WSY_YLJG, SFZZYJH, MD, RYQ_T, RYQ_XS, RYQ_F, RYH_T, RYH_XS, RYH_F, ZFY, ZFJE, YLFUF, ZLCZF, HLF, QTFY, BLZDF, SYSZDF, YXXZDF, LCZDXMF, FSSZLXMF, WLZLF, SSZLF, MAF, SSF, KFF, ZYZLF, XYF, KJYWF, ZCYF, ZCYF1, XF, BDBLZPF, QDBLZPF, NXYZLZPF, XBYZLZPF, HCYYCLF, YYCLF, YCXYYCLF, QTF) values ('œÊÃ∂ –∫Ï Æ◊÷» ∫Õ“Ω‘∫', '01', '', '1', '00008429                      ', '÷‹””∑≤                        ', '1', '1934-01-23', 78, '÷–π˙', 0, 0.00, 0.00, '∫˛ƒœ≥§…≥ –', '∫˛ƒœ≥§…≥ –', '∫∫◊Â', '430103193401233015  ', '80  ', '2', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷                                      ', '84723448      ', '410000', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷', '410000', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷                                      ', '84723448      ', '410000', '                              ', '8', '∫˛ƒœ °≥§…≥ –π§…Ãπ‹¿Ìæ÷                                      ', '84723448      ', '2', '2013-01-19', 11, '11', '', '', '2013-01-23', 15, '11', '', '4', '±«≥ˆ—™', 'R04.000', '±«≥ˆ—™', 'R04.000             ', '1', '', '', '', '∏ﬂ—™—π≤°', 'I10.x00             ', '1', '', '', '', '2–ÕÃ«ƒÚ≤°', 'E11.900             ', '1', '', '', '', 'π⁄◊¥∂Ø¬ˆ÷‡—˘”≤ªØ–‘–ƒ‘‡≤°', 'I25.103             ', '1', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '1', '', ' ', '6', '4', 'Õıƒ˛                          ', '…≥…Ø                          ', '÷‹∆Ω                          ', '÷‹∆Ω                          ', '', '                              ', '                              ', '”‡—‡                          ', '1', '…≥…Ø                          ', '¿Ó¡¯                          ', '2013-01-23', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '1', '', '', '1', '', 0, 0, 0, 0, 0, 0, 3699.5100, 777.58, 168.00, 91.00, 60.00, 0.00, 0.00, 1633.00, 364.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 1380.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 3.50, 0.00, 0.00, 0.00)";
                dabase.DoCommand(strSQl);
                dabase.Close();
                dabase.Dispose();



            }
            catch(Exception ex)
            {
                MessageBox.Show(ex.Message);
            }
        }

        private void dataGridView1_DragEnter(object sender, DragEventArgs e)
        {
            Point curPos = this.dataGridView1.PointToClient(Control.MousePosition);   

        }

        private void button8_Click(object sender, EventArgs e)
        {
            string conn=@"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=""E:\◊ ¡œ\ ÷ª˙ »˝–«GT C3580\ ˝æ›\»˝–«GT3518_20130508\µÁª∞.mdb"";Persist Security Info=True";
            TrasenClasses.DatabaseAccess.RelationalDatabase dabase = new MsAccess();
            dabase.Initialize(conn);
            DataTable dt = dabase.GetDataTable("select * from »˝–«jqgGT3518_20130508 order by id"); 
            string path=@"E:\◊ ¡œ\ ÷ª˙ »˝–«GT C3580\ ˝æ›\»˝–«GT3518_20130508\vcf\";
            for (int i = 0; i < dt.Rows.Count; i++)
            {
                DataRow dr = dt.Rows[i];
                string name = dr["name"].ToString();
                string file = path + name + ".vcf";
                if (System.IO.File.Exists(file)) System.IO.File.Delete(file);
                System.IO.StreamWriter sw = new System.IO.StreamWriter(path + name + ".vcf",true, Encoding.UTF8);
                sw.WriteLine("BEGIN:VCARD");
                sw.WriteLine("VERSION:3.0");
                sw.WriteLine("FN;CHARSET=UTF-8:" + name);
                sw.WriteLine("N;CHARSET=UTF-8:" + name + ";;");
                sw.WriteLine("TEL;TYPE=CELL:" + dr["dh1"].ToString());
                sw.WriteLine("TEL;TYPE=CELL:" + dr["dh2"].ToString());
                sw.WriteLine("TEL;TYPE=CELL:" + dr["dh3"].ToString());
                sw.WriteLine("TEL;TYPE=CELL:" + dr["dh4"].ToString());
                sw.WriteLine("NOTE:" + dr["bz"].ToString());
                sw.WriteLine("END:VCARD");
                sw.Close();


            }

        }


        private bool ThumbnailCallback()
        {
            return false;
        }

        private void button9_Click(object sender, EventArgs e)
        {
            //Application.Run(new Form1());

            //ts_ReadCard.ts_card_xzx t = new ts_ReadCard.ts_card_xzx();
            //ts_ReadCard.IDCardData data =new ts_ReadCard.IDCardData();
            //string str = "";
            //t.ReadCard(ref data,ref str);

            //return;
            //string tt = ConvertToLetter(27);
            ////for (int i = 1; i < 526; i++)
            ////{
            ////    tt += i.ToString() + "\t" + ConvertToLetter(i) + "\r\n";
            ////}
            //return;

            //TrasenClasses.DatabaseAccess.MsSqlServer t = new TrasenClasses.DatabaseAccess.MsSqlServer();
            //t.Initialize(connectionString);
            //try
            //{
            //    t.DoCommand("select getdate()");
            //    t.BeginTransaction();
            //    t.DoCommand("select getdate()");
            //    t.CommitTransaction();
            //    //for (int i = 0; i < 20; i++)
            //    //{

            //    //    t.SqlException("");
            //    //    string tt = "";
            //    //    tt += t.ConnectionStates.ToString();
            //    //}
            //    //tt = t.GetServerTimeString();
            //}
            //catch (Exception ex)
            //{
            //    string yy = ex.Message;
            //}
        }
        private static string ConvertToLetter(int col)
        {
            string strValue = "";
            //int iAlpha = 0;
            //int iRemainder = 0;
            //iAlpha = Convert.ToInt32(col / 27);

            ////jianqg 2012-10-8 ‘ˆº”
            //if (col >= 53) iAlpha = Convert.ToInt32(col / 26);

            //iRemainder = col - (iAlpha * 26);


            //if (iAlpha > 0) strValue = Convert.ToString((Char)(iAlpha + 64));
            //if (iRemainder > 0) strValue = strValue + Convert.ToString((Char)(iRemainder + 64));
            //return strValue;

            //if (col < 0) { throw new Exception("invalid parameter"); }
            //System.Collections.Generic.List<string> chars = new System.Collections.Generic.List<string>();
            //do
            //{
            //    if (chars.Count > 0) col--;
            //    chars.Insert(0, ((char)(col % 26 + (int)'A')).ToString());
            //    col = (int)((col - col % 26) / 26);
            //} while (col > 0);
            //return String.Join(string.Empty, chars.ToArray());

            //int i = col / 26;
            //int j = col % 26;
            //string k = string.Empty;
            //if (i ==0)
            //{

            //    return Convert.ToString((Char)(j == 0 ? 26 + 64 : j + 64)); ;// GenerateLetter(j);
            //}
            //else
            //{

            //    k = Convert.ToString((Char)(j == 0 ? 26 + 64 : j + 64)); // GenerateLetter(j);
            //    return ConvertToLetter(i==1? i-1:i) + k;
            //}



            strValue = "";
            int num = col - 1;
            double i = Math.Floor(Math.Log(25.0 * (num) / 26.0 + 1) / Math.Log(26)) + 1;
            if (i > 1)
            {
                double sub = num - 26 * (Math.Pow(26, i - 1) - 1) / 25;
                for (double j = i; j > 0; j--)
                {
                    strValue = strValue + (char)(sub / Math.Pow(26, j - 1) + 65);
                    sub = sub % Math.Pow(26, i - 1);
                }
            }
            else strValue = strValue + (char)(num + 65);

            return strValue;
        }

    }
}