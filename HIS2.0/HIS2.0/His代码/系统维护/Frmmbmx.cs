using System;
using System.Drawing;
using System.Collections;
using System.ComponentModel;
using System.Windows.Forms;
using System.Data;
using TrasenFrame.Classes;
using TrasenClasses.GeneralControls;
using TrasenClasses.GeneralClasses;
using YpClass;
using TrasenFrame.Forms;

namespace ts_yp_xtwh
{
	/// <summary>
	/// Frmyprk 的摘要说明。
	/// </summary>
	public class Frmyptjmb : System.Windows.Forms.Form
	{
		private System.Windows.Forms.StatusBar statusBar1;
		private System.Windows.Forms.StatusBarPanel statusBarPanel1;
		private System.Windows.Forms.StatusBarPanel statusBarPanel2;
		private System.Windows.Forms.StatusBarPanel statusBarPanel3;
		private System.Windows.Forms.StatusBarPanel statusBarPanel4;
		private System.Windows.Forms.TabControl tabControl1;
		private System.Windows.Forms.TabPage tabPage1;
		private System.Windows.Forms.TabPage tabPage2;
		private myDataGrid.myDataGrid myDataGrid2;
		private System.Windows.Forms.Panel panel1;
		private System.Windows.Forms.GroupBox groupBox1;
		private System.Windows.Forms.Splitter splitter1;
		private System.Windows.Forms.Panel panel2;
		private System.Windows.Forms.GroupBox groupBox2;
		private System.Windows.Forms.Label label6;
		private System.Windows.Forms.Label label36;
		private System.Windows.Forms.Label label20;
		private System.Windows.Forms.Label label18;
		private System.Windows.Forms.Label label16;
		private System.Windows.Forms.Label label14;
		private System.Windows.Forms.Label label12;
		private System.Windows.Forms.Label label10;
		private System.Windows.Forms.GroupBox groupBox4;
		private System.Windows.Forms.GroupBox groupBox5;
		private myDataGrid.myDataGrid myDataGrid1;
		private System.Windows.Forms.DataGridTableStyle dataGridTableStyle1;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn1;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn2;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn3;
		private System.Windows.Forms.DataGridTableStyle dataGridTableStyle2;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn4;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn5;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn6;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn7;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn8;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn9;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn10;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn11;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn12;
		private myDataGrid.myDataGrid myDataGrid3;
		private System.Windows.Forms.DataGridTableStyle dataGridTableStyle3;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn13;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn14;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn15;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn16;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn17;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn18;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn19;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn20;
		private System.Windows.Forms.GroupBox groupBox6;
		private System.Windows.Forms.GroupBox groupBox3;
		private System.Windows.Forms.Label label1;
		private System.Windows.Forms.Label lbllsj;
		private System.Windows.Forms.Label lblpfj;
		private System.Windows.Forms.Label lblhh;
		private System.Windows.Forms.Label lblypmc;
		private System.Windows.Forms.Label lblgg;
		private System.Windows.Forms.Label lblcj;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn21;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn22;
		private System.Windows.Forms.Button butadd;
		private System.Windows.Forms.Button butinsert;
		private System.Windows.Forms.Button butdown;
		private System.Windows.Forms.Button butup;
		private System.Windows.Forms.Button butdel;
		private System.Windows.Forms.TextBox txtypdm;
		private System.Windows.Forms.Label lbldw;
		private System.Windows.Forms.TextBox txtdm;
		private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn23;
		private System.Windows.Forms.Button butquit;
		private System.Windows.Forms.Button butdelmb;
		private System.Windows.Forms.Button butsave;
		private System.Windows.Forms.Button butnew;
        private System.Windows.Forms.DataGridTextBoxColumn dataGridTextBoxColumn24;
		private System.Windows.Forms.Label label2;
        private System.Windows.Forms.TextBox txtbz;
		private System.Windows.Forms.Button butmodifmc;
		private System.Windows.Forms.Button butprint;
		private MenuTag _menuTag;
		private string _chineseName;
        private Form _mdiParent;
        private Panel panel4;
        private Panel panel5;
        private Splitter splitter2;
        private Panel panel3;
        private TreeView treeView1;
        private ImageList imageList1;
        private DataGridBoolColumn dataGridBoolColumn1;
        private IContainer components;

		public Frmyptjmb(MenuTag menuTag,string chineseName,Form mdiParent)
		{
			InitializeComponent();
			_menuTag=menuTag;
			_chineseName=chineseName;
			_mdiParent=mdiParent;
			this.MdiParent=_mdiParent;
            this.Text = chineseName;
            this.Text = this.Text + " [" + InstanceForm._menuTag.Jgbm + "]";
            
		}

		/// <summary>
		/// 清理所有正在使用的资源。
		/// </summary>
		protected override void Dispose( bool disposing )
		{
			if( disposing )
			{
				if(components != null)
				{
					components.Dispose();
				}
			}
			base.Dispose( disposing );
		}

		#region Windows 窗体设计器生成的代码
		/// <summary>
		/// 设计器支持所需的方法 - 不要使用代码编辑器修改
		/// 此方法的内容。
		/// </summary>
		private void InitializeComponent()
		{
            this.components = new System.ComponentModel.Container();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(Frmyptjmb));
            this.statusBar1 = new System.Windows.Forms.StatusBar();
            this.statusBarPanel1 = new System.Windows.Forms.StatusBarPanel();
            this.statusBarPanel2 = new System.Windows.Forms.StatusBarPanel();
            this.statusBarPanel3 = new System.Windows.Forms.StatusBarPanel();
            this.statusBarPanel4 = new System.Windows.Forms.StatusBarPanel();
            this.tabControl1 = new System.Windows.Forms.TabControl();
            this.tabPage1 = new System.Windows.Forms.TabPage();
            this.panel2 = new System.Windows.Forms.Panel();
            this.groupBox5 = new System.Windows.Forms.GroupBox();
            this.myDataGrid1 = new myDataGrid.myDataGrid();
            this.dataGridTableStyle2 = new System.Windows.Forms.DataGridTableStyle();
            this.dataGridTextBoxColumn4 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn5 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn6 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn7 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn10 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn8 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn9 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn11 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn12 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn21 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.groupBox4 = new System.Windows.Forms.GroupBox();
            this.butprint = new System.Windows.Forms.Button();
            this.butmodifmc = new System.Windows.Forms.Button();
            this.butquit = new System.Windows.Forms.Button();
            this.butdelmb = new System.Windows.Forms.Button();
            this.butsave = new System.Windows.Forms.Button();
            this.butnew = new System.Windows.Forms.Button();
            this.groupBox2 = new System.Windows.Forms.GroupBox();
            this.txtbz = new System.Windows.Forms.TextBox();
            this.label2 = new System.Windows.Forms.Label();
            this.butinsert = new System.Windows.Forms.Button();
            this.butdown = new System.Windows.Forms.Button();
            this.lbllsj = new System.Windows.Forms.Label();
            this.label6 = new System.Windows.Forms.Label();
            this.butup = new System.Windows.Forms.Button();
            this.butdel = new System.Windows.Forms.Button();
            this.butadd = new System.Windows.Forms.Button();
            this.lbldw = new System.Windows.Forms.Label();
            this.label36 = new System.Windows.Forms.Label();
            this.lblpfj = new System.Windows.Forms.Label();
            this.label20 = new System.Windows.Forms.Label();
            this.lblhh = new System.Windows.Forms.Label();
            this.label18 = new System.Windows.Forms.Label();
            this.lblypmc = new System.Windows.Forms.Label();
            this.label16 = new System.Windows.Forms.Label();
            this.lblcj = new System.Windows.Forms.Label();
            this.label14 = new System.Windows.Forms.Label();
            this.lblgg = new System.Windows.Forms.Label();
            this.label12 = new System.Windows.Forms.Label();
            this.txtypdm = new System.Windows.Forms.TextBox();
            this.label10 = new System.Windows.Forms.Label();
            this.splitter1 = new System.Windows.Forms.Splitter();
            this.panel1 = new System.Windows.Forms.Panel();
            this.groupBox1 = new System.Windows.Forms.GroupBox();
            this.panel4 = new System.Windows.Forms.Panel();
            this.myDataGrid2 = new myDataGrid.myDataGrid();
            this.dataGridTableStyle1 = new System.Windows.Forms.DataGridTableStyle();
            this.dataGridTextBoxColumn1 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn2 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn3 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn22 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.tabPage2 = new System.Windows.Forms.TabPage();
            this.groupBox3 = new System.Windows.Forms.GroupBox();
            this.panel5 = new System.Windows.Forms.Panel();
            this.myDataGrid3 = new myDataGrid.myDataGrid();
            this.dataGridTableStyle3 = new System.Windows.Forms.DataGridTableStyle();
            this.dataGridTextBoxColumn13 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn14 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn15 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn16 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn19 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn17 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn18 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn20 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn24 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridTextBoxColumn23 = new System.Windows.Forms.DataGridTextBoxColumn();
            this.dataGridBoolColumn1 = new System.Windows.Forms.DataGridBoolColumn();
            this.splitter2 = new System.Windows.Forms.Splitter();
            this.panel3 = new System.Windows.Forms.Panel();
            this.treeView1 = new System.Windows.Forms.TreeView();
            this.groupBox6 = new System.Windows.Forms.GroupBox();
            this.label1 = new System.Windows.Forms.Label();
            this.txtdm = new System.Windows.Forms.TextBox();
            this.imageList1 = new System.Windows.Forms.ImageList(this.components);
            ((System.ComponentModel.ISupportInitialize)(this.statusBarPanel1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.statusBarPanel2)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.statusBarPanel3)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.statusBarPanel4)).BeginInit();
            this.tabControl1.SuspendLayout();
            this.tabPage1.SuspendLayout();
            this.panel2.SuspendLayout();
            this.groupBox5.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.myDataGrid1)).BeginInit();
            this.groupBox4.SuspendLayout();
            this.groupBox2.SuspendLayout();
            this.panel1.SuspendLayout();
            this.groupBox1.SuspendLayout();
            this.panel4.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.myDataGrid2)).BeginInit();
            this.tabPage2.SuspendLayout();
            this.groupBox3.SuspendLayout();
            this.panel5.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.myDataGrid3)).BeginInit();
            this.panel3.SuspendLayout();
            this.groupBox6.SuspendLayout();
            this.SuspendLayout();
            // 
            // statusBar1
            // 
            this.statusBar1.Location = new System.Drawing.Point(0, 503);
            this.statusBar1.Name = "statusBar1";
            this.statusBar1.Panels.AddRange(new System.Windows.Forms.StatusBarPanel[] {
            this.statusBarPanel1,
            this.statusBarPanel2,
            this.statusBarPanel3,
            this.statusBarPanel4});
            this.statusBar1.ShowPanels = true;
            this.statusBar1.Size = new System.Drawing.Size(1030, 24);
            this.statusBar1.TabIndex = 3;
            this.statusBar1.Text = "statusBar1";
            // 
            // statusBarPanel1
            // 
            this.statusBarPanel1.Name = "statusBarPanel1";
            this.statusBarPanel1.Width = 150;
            // 
            // statusBarPanel2
            // 
            this.statusBarPanel2.Name = "statusBarPanel2";
            this.statusBarPanel2.Width = 150;
            // 
            // statusBarPanel3
            // 
            this.statusBarPanel3.Name = "statusBarPanel3";
            this.statusBarPanel3.Width = 150;
            // 
            // statusBarPanel4
            // 
            this.statusBarPanel4.Name = "statusBarPanel4";
            this.statusBarPanel4.Width = 400;
            // 
            // tabControl1
            // 
            this.tabControl1.Appearance = System.Windows.Forms.TabAppearance.FlatButtons;
            this.tabControl1.Controls.Add(this.tabPage1);
            this.tabControl1.Controls.Add(this.tabPage2);
            this.tabControl1.Dock = System.Windows.Forms.DockStyle.Fill;
            this.tabControl1.Location = new System.Drawing.Point(0, 0);
            this.tabControl1.Name = "tabControl1";
            this.tabControl1.SelectedIndex = 0;
            this.tabControl1.Size = new System.Drawing.Size(1030, 503);
            this.tabControl1.TabIndex = 4;
            this.tabControl1.SelectedIndexChanged += new System.EventHandler(this.tabControl1_SelectedIndexChanged);
            // 
            // tabPage1
            // 
            this.tabPage1.Controls.Add(this.panel2);
            this.tabPage1.Controls.Add(this.splitter1);
            this.tabPage1.Controls.Add(this.panel1);
            this.tabPage1.Location = new System.Drawing.Point(4, 24);
            this.tabPage1.Name = "tabPage1";
            this.tabPage1.Size = new System.Drawing.Size(1022, 475);
            this.tabPage1.TabIndex = 0;
            this.tabPage1.Text = "模板";
            this.tabPage1.UseVisualStyleBackColor = true;
            // 
            // panel2
            // 
            this.panel2.Controls.Add(this.groupBox5);
            this.panel2.Controls.Add(this.groupBox4);
            this.panel2.Controls.Add(this.groupBox2);
            this.panel2.Dock = System.Windows.Forms.DockStyle.Fill;
            this.panel2.Location = new System.Drawing.Point(173, 0);
            this.panel2.Name = "panel2";
            this.panel2.Size = new System.Drawing.Size(849, 475);
            this.panel2.TabIndex = 4;
            // 
            // groupBox5
            // 
            this.groupBox5.Controls.Add(this.myDataGrid1);
            this.groupBox5.Dock = System.Windows.Forms.DockStyle.Fill;
            this.groupBox5.Font = new System.Drawing.Font("宋体", 9F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.groupBox5.ForeColor = System.Drawing.Color.FromArgb(((int)(((byte)(0)))), ((int)(((byte)(0)))), ((int)(((byte)(192)))));
            this.groupBox5.Location = new System.Drawing.Point(0, 72);
            this.groupBox5.Name = "groupBox5";
            this.groupBox5.Size = new System.Drawing.Size(849, 363);
            this.groupBox5.TabIndex = 4;
            this.groupBox5.TabStop = false;
            this.groupBox5.Tag = "0";
            this.groupBox5.Text = "新模板";
            // 
            // myDataGrid1
            // 
            this.myDataGrid1.BackgroundColor = System.Drawing.Color.White;
            this.myDataGrid1.CaptionVisible = false;
            this.myDataGrid1.DataMember = "";
            this.myDataGrid1.Dock = System.Windows.Forms.DockStyle.Fill;
            this.myDataGrid1.Font = new System.Drawing.Font("宋体", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.myDataGrid1.HeaderFont = new System.Drawing.Font("宋体", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.myDataGrid1.HeaderForeColor = System.Drawing.SystemColors.ControlText;
            this.myDataGrid1.Location = new System.Drawing.Point(3, 17);
            this.myDataGrid1.Name = "myDataGrid1";
            this.myDataGrid1.Size = new System.Drawing.Size(843, 343);
            this.myDataGrid1.TabIndex = 0;
            this.myDataGrid1.TableStyles.AddRange(new System.Windows.Forms.DataGridTableStyle[] {
            this.dataGridTableStyle2});
            this.myDataGrid1.CurrentCellChanged += new System.EventHandler(this.myDataGrid1_CurrentCellChanged);
            this.myDataGrid1.Navigate += new System.Windows.Forms.NavigateEventHandler(this.myDataGrid1_Navigate);
            // 
            // dataGridTableStyle2
            // 
            this.dataGridTableStyle2.DataGrid = this.myDataGrid1;
            this.dataGridTableStyle2.GridColumnStyles.AddRange(new System.Windows.Forms.DataGridColumnStyle[] {
            this.dataGridTextBoxColumn4,
            this.dataGridTextBoxColumn5,
            this.dataGridTextBoxColumn6,
            this.dataGridTextBoxColumn7,
            this.dataGridTextBoxColumn10,
            this.dataGridTextBoxColumn8,
            this.dataGridTextBoxColumn9,
            this.dataGridTextBoxColumn11,
            this.dataGridTextBoxColumn12,
            this.dataGridTextBoxColumn21});
            this.dataGridTableStyle2.HeaderForeColor = System.Drawing.SystemColors.ControlText;
            // 
            // dataGridTextBoxColumn4
            // 
            this.dataGridTextBoxColumn4.Format = "";
            this.dataGridTextBoxColumn4.FormatInfo = null;
            this.dataGridTextBoxColumn4.HeaderText = "序号";
            this.dataGridTextBoxColumn4.ReadOnly = true;
            this.dataGridTextBoxColumn4.Width = 35;
            // 
            // dataGridTextBoxColumn5
            // 
            this.dataGridTextBoxColumn5.Format = "";
            this.dataGridTextBoxColumn5.FormatInfo = null;
            this.dataGridTextBoxColumn5.HeaderText = "品名";
            this.dataGridTextBoxColumn5.ReadOnly = true;
            this.dataGridTextBoxColumn5.Width = 120;
            // 
            // dataGridTextBoxColumn6
            // 
            this.dataGridTextBoxColumn6.Format = "";
            this.dataGridTextBoxColumn6.FormatInfo = null;
            this.dataGridTextBoxColumn6.HeaderText = "规格";
            this.dataGridTextBoxColumn6.ReadOnly = true;
            this.dataGridTextBoxColumn6.Width = 85;
            // 
            // dataGridTextBoxColumn7
            // 
            this.dataGridTextBoxColumn7.Format = "";
            this.dataGridTextBoxColumn7.FormatInfo = null;
            this.dataGridTextBoxColumn7.HeaderText = "厂家";
            this.dataGridTextBoxColumn7.ReadOnly = true;
            this.dataGridTextBoxColumn7.Width = 85;
            // 
            // dataGridTextBoxColumn10
            // 
            this.dataGridTextBoxColumn10.Format = "";
            this.dataGridTextBoxColumn10.FormatInfo = null;
            this.dataGridTextBoxColumn10.HeaderText = "单位";
            this.dataGridTextBoxColumn10.ReadOnly = true;
            this.dataGridTextBoxColumn10.Width = 35;
            // 
            // dataGridTextBoxColumn8
            // 
            this.dataGridTextBoxColumn8.Format = "";
            this.dataGridTextBoxColumn8.FormatInfo = null;
            this.dataGridTextBoxColumn8.HeaderText = "批发价";
            this.dataGridTextBoxColumn8.ReadOnly = true;
            this.dataGridTextBoxColumn8.Width = 60;
            // 
            // dataGridTextBoxColumn9
            // 
            this.dataGridTextBoxColumn9.Format = "";
            this.dataGridTextBoxColumn9.FormatInfo = null;
            this.dataGridTextBoxColumn9.HeaderText = "零售价";
            this.dataGridTextBoxColumn9.ReadOnly = true;
            this.dataGridTextBoxColumn9.Width = 60;
            // 
            // dataGridTextBoxColumn11
            // 
            this.dataGridTextBoxColumn11.Format = "";
            this.dataGridTextBoxColumn11.FormatInfo = null;
            this.dataGridTextBoxColumn11.HeaderText = "货号";
            this.dataGridTextBoxColumn11.ReadOnly = true;
            this.dataGridTextBoxColumn11.Width = 60;
            // 
            // dataGridTextBoxColumn12
            // 
            this.dataGridTextBoxColumn12.Format = "";
            this.dataGridTextBoxColumn12.FormatInfo = null;
            this.dataGridTextBoxColumn12.HeaderText = "描述";
            this.dataGridTextBoxColumn12.NullText = "";
            this.dataGridTextBoxColumn12.Width = 80;
            // 
            // dataGridTextBoxColumn21
            // 
            this.dataGridTextBoxColumn21.Format = "";
            this.dataGridTextBoxColumn21.FormatInfo = null;
            this.dataGridTextBoxColumn21.HeaderText = "cjid";
            this.dataGridTextBoxColumn21.ReadOnly = true;
            this.dataGridTextBoxColumn21.Width = 0;
            // 
            // groupBox4
            // 
            this.groupBox4.Controls.Add(this.butprint);
            this.groupBox4.Controls.Add(this.butmodifmc);
            this.groupBox4.Controls.Add(this.butquit);
            this.groupBox4.Controls.Add(this.butdelmb);
            this.groupBox4.Controls.Add(this.butsave);
            this.groupBox4.Controls.Add(this.butnew);
            this.groupBox4.Dock = System.Windows.Forms.DockStyle.Bottom;
            this.groupBox4.Location = new System.Drawing.Point(0, 435);
            this.groupBox4.Name = "groupBox4";
            this.groupBox4.Size = new System.Drawing.Size(849, 40);
            this.groupBox4.TabIndex = 3;
            this.groupBox4.TabStop = false;
            // 
            // butprint
            // 
            this.butprint.Location = new System.Drawing.Point(520, 12);
            this.butprint.Name = "butprint";
            this.butprint.Size = new System.Drawing.Size(96, 25);
            this.butprint.TabIndex = 5;
            this.butprint.Text = "打印模板";
            this.butprint.Visible = false;
            this.butprint.Click += new System.EventHandler(this.butprint_Click);
            // 
            // butmodifmc
            // 
            this.butmodifmc.Location = new System.Drawing.Point(416, 12);
            this.butmodifmc.Name = "butmodifmc";
            this.butmodifmc.Size = new System.Drawing.Size(96, 25);
            this.butmodifmc.TabIndex = 4;
            this.butmodifmc.Text = "修改模板名称";
            this.butmodifmc.Click += new System.EventHandler(this.butmodifmc_Click);
            // 
            // butquit
            // 
            this.butquit.Location = new System.Drawing.Point(624, 12);
            this.butquit.Name = "butquit";
            this.butquit.Size = new System.Drawing.Size(80, 25);
            this.butquit.TabIndex = 3;
            this.butquit.Text = "退出";
            this.butquit.Click += new System.EventHandler(this.butquit_Click);
            // 
            // butdelmb
            // 
            this.butdelmb.Location = new System.Drawing.Point(328, 12);
            this.butdelmb.Name = "butdelmb";
            this.butdelmb.Size = new System.Drawing.Size(80, 25);
            this.butdelmb.TabIndex = 2;
            this.butdelmb.Text = "删除模板";
            this.butdelmb.Click += new System.EventHandler(this.butdelmb_Click);
            // 
            // butsave
            // 
            this.butsave.Location = new System.Drawing.Point(240, 12);
            this.butsave.Name = "butsave";
            this.butsave.Size = new System.Drawing.Size(80, 25);
            this.butsave.TabIndex = 1;
            this.butsave.Text = "保存模板";
            this.butsave.Click += new System.EventHandler(this.butsave_Click);
            // 
            // butnew
            // 
            this.butnew.Location = new System.Drawing.Point(152, 12);
            this.butnew.Name = "butnew";
            this.butnew.Size = new System.Drawing.Size(80, 25);
            this.butnew.TabIndex = 0;
            this.butnew.Text = "新增模板";
            this.butnew.Click += new System.EventHandler(this.butnew_Click);
            // 
            // groupBox2
            // 
            this.groupBox2.Controls.Add(this.txtbz);
            this.groupBox2.Controls.Add(this.label2);
            this.groupBox2.Controls.Add(this.butinsert);
            this.groupBox2.Controls.Add(this.butdown);
            this.groupBox2.Controls.Add(this.lbllsj);
            this.groupBox2.Controls.Add(this.label6);
            this.groupBox2.Controls.Add(this.butup);
            this.groupBox2.Controls.Add(this.butdel);
            this.groupBox2.Controls.Add(this.butadd);
            this.groupBox2.Controls.Add(this.lbldw);
            this.groupBox2.Controls.Add(this.label36);
            this.groupBox2.Controls.Add(this.lblpfj);
            this.groupBox2.Controls.Add(this.label20);
            this.groupBox2.Controls.Add(this.lblhh);
            this.groupBox2.Controls.Add(this.label18);
            this.groupBox2.Controls.Add(this.lblypmc);
            this.groupBox2.Controls.Add(this.label16);
            this.groupBox2.Controls.Add(this.lblcj);
            this.groupBox2.Controls.Add(this.label14);
            this.groupBox2.Controls.Add(this.lblgg);
            this.groupBox2.Controls.Add(this.label12);
            this.groupBox2.Controls.Add(this.txtypdm);
            this.groupBox2.Controls.Add(this.label10);
            this.groupBox2.Dock = System.Windows.Forms.DockStyle.Top;
            this.groupBox2.ForeColor = System.Drawing.Color.FromArgb(((int)(((byte)(0)))), ((int)(((byte)(0)))), ((int)(((byte)(192)))));
            this.groupBox2.Location = new System.Drawing.Point(0, 0);
            this.groupBox2.Name = "groupBox2";
            this.groupBox2.Size = new System.Drawing.Size(849, 72);
            this.groupBox2.TabIndex = 2;
            this.groupBox2.TabStop = false;
            this.groupBox2.Text = "添加";
            // 
            // txtbz
            // 
            this.txtbz.Location = new System.Drawing.Point(184, 14);
            this.txtbz.Name = "txtbz";
            this.txtbz.Size = new System.Drawing.Size(80, 21);
            this.txtbz.TabIndex = 1;
            this.txtbz.KeyPress += new System.Windows.Forms.KeyPressEventHandler(this.GotoNext);
            // 
            // label2
            // 
            this.label2.ForeColor = System.Drawing.Color.Black;
            this.label2.Location = new System.Drawing.Point(152, 18);
            this.label2.Name = "label2";
            this.label2.Size = new System.Drawing.Size(64, 16);
            this.label2.TabIndex = 69;
            this.label2.Text = "描述";
            // 
            // butinsert
            // 
            this.butinsert.FlatStyle = System.Windows.Forms.FlatStyle.Popup;
            this.butinsert.ForeColor = System.Drawing.Color.FromArgb(((int)(((byte)(0)))), ((int)(((byte)(0)))), ((int)(((byte)(192)))));
            this.butinsert.Location = new System.Drawing.Point(640, 45);
            this.butinsert.Name = "butinsert";
            this.butinsert.Size = new System.Drawing.Size(72, 24);
            this.butinsert.TabIndex = 65;
            this.butinsert.Text = "插入到(&I)";
            this.butinsert.Click += new System.EventHandler(this.butinsert_Click);
            // 
            // butdown
            // 
            this.butdown.FlatStyle = System.Windows.Forms.FlatStyle.Popup;
            this.butdown.ForeColor = System.Drawing.Color.FromArgb(((int)(((byte)(0)))), ((int)(((byte)(0)))), ((int)(((byte)(192)))));
            this.butdown.Location = new System.Drawing.Point(584, 45);
            this.butdown.Name = "butdown";
            this.butdown.Size = new System.Drawing.Size(56, 24);
            this.butdown.TabIndex = 64;
            this.butdown.Text = "下移(&D)";
            this.butdown.Click += new System.EventHandler(this.butdown_Click);
            // 
            // lbllsj
            // 
            this.lbllsj.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D;
            this.lbllsj.Font = new System.Drawing.Font("宋体", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.lbllsj.Location = new System.Drawing.Point(336, 40);
            this.lbllsj.Name = "lbllsj";
            this.lbllsj.Size = new System.Drawing.Size(64, 20);
            this.lbllsj.TabIndex = 63;
            // 
            // label6
            // 
            this.label6.ForeColor = System.Drawing.Color.Black;
            this.label6.Location = new System.Drawing.Point(296, 43);
            this.label6.Name = "label6";
            this.label6.Size = new System.Drawing.Size(56, 16);
            this.label6.TabIndex = 62;
            this.label6.Text = "零售价";
            // 
            // butup
            // 
            this.butup.FlatStyle = System.Windows.Forms.FlatStyle.Popup;
            this.butup.ForeColor = System.Drawing.Color.FromArgb(((int)(((byte)(0)))), ((int)(((byte)(0)))), ((int)(((byte)(192)))));
            this.butup.Location = new System.Drawing.Point(528, 45);
            this.butup.Name = "butup";
            this.butup.Size = new System.Drawing.Size(56, 24);
            this.butup.TabIndex = 57;
            this.butup.Text = "上移(&U)";
            this.butup.Click += new System.EventHandler(this.butup_Click);
            // 
            // butdel
            // 
            this.butdel.FlatStyle = System.Windows.Forms.FlatStyle.Popup;
            this.butdel.ForeColor = System.Drawing.Color.FromArgb(((int)(((byte)(0)))), ((int)(((byte)(0)))), ((int)(((byte)(192)))));
            this.butdel.Location = new System.Drawing.Point(472, 45);
            this.butdel.Name = "butdel";
            this.butdel.Size = new System.Drawing.Size(56, 24);
            this.butdel.TabIndex = 56;
            this.butdel.Text = "删除(&D)";
            this.butdel.Click += new System.EventHandler(this.butdel_Click);
            // 
            // butadd
            // 
            this.butadd.BackColor = System.Drawing.SystemColors.Control;
            this.butadd.FlatStyle = System.Windows.Forms.FlatStyle.Popup;
            this.butadd.ForeColor = System.Drawing.Color.FromArgb(((int)(((byte)(0)))), ((int)(((byte)(0)))), ((int)(((byte)(192)))));
            this.butadd.Location = new System.Drawing.Point(416, 45);
            this.butadd.Name = "butadd";
            this.butadd.Size = new System.Drawing.Size(56, 24);
            this.butadd.TabIndex = 2;
            this.butadd.Text = "添加(&A)";
            this.butadd.UseVisualStyleBackColor = false;
            this.butadd.Click += new System.EventHandler(this.butadd_Click);
            // 
            // lbldw
            // 
            this.lbldw.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D;
            this.lbldw.Font = new System.Drawing.Font("宋体", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.lbldw.Location = new System.Drawing.Point(160, 40);
            this.lbldw.Name = "lbldw";
            this.lbldw.Size = new System.Drawing.Size(32, 20);
            this.lbldw.TabIndex = 51;
            // 
            // label36
            // 
            this.label36.ForeColor = System.Drawing.Color.Black;
            this.label36.Location = new System.Drawing.Point(128, 43);
            this.label36.Name = "label36";
            this.label36.Size = new System.Drawing.Size(48, 16);
            this.label36.TabIndex = 50;
            this.label36.Text = "单位";
            // 
            // lblpfj
            // 
            this.lblpfj.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D;
            this.lblpfj.Font = new System.Drawing.Font("宋体", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.lblpfj.Location = new System.Drawing.Point(232, 40);
            this.lblpfj.Name = "lblpfj";
            this.lblpfj.Size = new System.Drawing.Size(64, 20);
            this.lblpfj.TabIndex = 27;
            // 
            // label20
            // 
            this.label20.ForeColor = System.Drawing.Color.Black;
            this.label20.Location = new System.Drawing.Point(192, 43);
            this.label20.Name = "label20";
            this.label20.Size = new System.Drawing.Size(64, 16);
            this.label20.TabIndex = 26;
            this.label20.Text = "批发价";
            // 
            // lblhh
            // 
            this.lblhh.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D;
            this.lblhh.Font = new System.Drawing.Font("宋体", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.lblhh.Location = new System.Drawing.Point(728, 15);
            this.lblhh.Name = "lblhh";
            this.lblhh.Size = new System.Drawing.Size(48, 20);
            this.lblhh.TabIndex = 23;
            // 
            // label18
            // 
            this.label18.ForeColor = System.Drawing.Color.Black;
            this.label18.Location = new System.Drawing.Point(696, 17);
            this.label18.Name = "label18";
            this.label18.Size = new System.Drawing.Size(32, 16);
            this.label18.TabIndex = 22;
            this.label18.Text = "货号";
            // 
            // lblypmc
            // 
            this.lblypmc.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D;
            this.lblypmc.Font = new System.Drawing.Font("宋体", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.lblypmc.Location = new System.Drawing.Point(328, 15);
            this.lblypmc.Name = "lblypmc";
            this.lblypmc.Size = new System.Drawing.Size(120, 20);
            this.lblypmc.TabIndex = 21;
            // 
            // label16
            // 
            this.label16.ForeColor = System.Drawing.Color.Black;
            this.label16.Location = new System.Drawing.Point(272, 18);
            this.label16.Name = "label16";
            this.label16.Size = new System.Drawing.Size(64, 16);
            this.label16.TabIndex = 20;
            this.label16.Text = "药品名称";
            // 
            // lblcj
            // 
            this.lblcj.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D;
            this.lblcj.Font = new System.Drawing.Font("宋体", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.lblcj.Location = new System.Drawing.Point(608, 15);
            this.lblcj.Name = "lblcj";
            this.lblcj.Size = new System.Drawing.Size(87, 20);
            this.lblcj.TabIndex = 19;
            // 
            // label14
            // 
            this.label14.ForeColor = System.Drawing.Color.Black;
            this.label14.Location = new System.Drawing.Point(576, 18);
            this.label14.Name = "label14";
            this.label14.Size = new System.Drawing.Size(32, 16);
            this.label14.TabIndex = 18;
            this.label14.Text = "厂家";
            // 
            // lblgg
            // 
            this.lblgg.BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D;
            this.lblgg.Font = new System.Drawing.Font("宋体", 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(134)));
            this.lblgg.Location = new System.Drawing.Point(480, 15);
            this.lblgg.Name = "lblgg";
            this.lblgg.Size = new System.Drawing.Size(88, 20);
            this.lblgg.TabIndex = 17;
            // 
            // label12
            // 
            this.label12.ForeColor = System.Drawing.Color.Black;
            this.label12.Location = new System.Drawing.Point(448, 17);
            this.label12.Name = "label12";
            this.label12.Size = new System.Drawing.Size(34, 16);
            this.label12.TabIndex = 16;
            this.label12.Text = "规格";
            // 
            // txtypdm
            // 
            this.txtypdm.Location = new System.Drawing.Point(64, 15);
            this.txtypdm.Name = "txtypdm";
            this.txtypdm.Size = new System.Drawing.Size(80, 21);
            this.txtypdm.TabIndex = 0;
            this.txtypdm.KeyUp += new System.Windows.Forms.KeyEventHandler(this.TextKeyUp);
            // 
            // label10
            // 
            this.label10.ForeColor = System.Drawing.Color.Black;
            this.label10.Location = new System.Drawing.Point(8, 16);
            this.label10.Name = "label10";
            this.label10.Size = new System.Drawing.Size(64, 16);
            this.label10.TabIndex = 1;
            this.label10.Text = "药品代码";
            // 
            // splitter1
            // 
            this.splitter1.Location = new System.Drawing.Point(168, 0);
            this.splitter1.Name = "splitter1";
            this.splitter1.Size = new System.Drawing.Size(5, 475);
            this.splitter1.TabIndex = 3;
            this.splitter1.TabStop = false;
            // 
            // panel1
            // 
            this.panel1.Controls.Add(this.groupBox1);
            this.panel1.Dock = System.Windows.Forms.DockStyle.Left;
            this.panel1.Location = new System.Drawing.Point(0, 0);
            this.panel1.Name = "panel1";
            this.panel1.Size = new System.Drawing.Size(168, 475);
            this.panel1.TabIndex = 2;
            // 
            // groupBox1
            // 
            this.groupBox1.Controls.Add(this.panel4);
            this.groupBox1.Dock = System.Windows.Forms.DockStyle.Fill;
            this.groupBox1.ForeColor = System.Drawing.Color.FromArgb(((int)(((byte)(0)))), ((int)(((byte)(0)))), ((int)(((byte)(192)))));
            this.groupBox1.Location = new System.Drawing.Point(0, 0);
            this.groupBox1.Name = "groupBox1";
            this.groupBox1.Size = new System.Drawing.Size(168, 475);
            this.groupBox1.TabIndex = 0;
            this.groupBox1.TabStop = false;
            this.groupBox1.Text = "模板";
            // 
            // panel4
            // 
            this.panel4.Controls.Add(this.myDataGrid2);
            this.panel4.Dock = System.Windows.Forms.DockStyle.Fill;
            this.panel4.Location = new System.Drawing.Point(3, 17);
            this.panel4.Name = "panel4";
            this.panel4.Size = new System.Drawing.Size(162, 455);
            this.panel4.TabIndex = 3;
            // 
            // myDataGrid2
            // 
            this.myDataGrid2.BackgroundColor = System.Drawing.Color.White;
            this.myDataGrid2.CaptionVisible = false;
            this.myDataGrid2.DataMember = "";
            this.myDataGrid2.Dock = System.Windows.Forms.DockStyle.Fill;
            this.myDataGrid2.HeaderForeColor = System.Drawing.SystemColors.ControlText;
            this.myDataGrid2.Location = new System.Drawing.Point(0, 0);
            this.myDataGrid2.Name = "myDataGrid2";
            this.myDataGrid2.Size = new System.Drawing.Size(162, 455);
            this.myDataGrid2.TabIndex = 1;
            this.myDataGrid2.TableStyles.AddRange(new System.Windows.Forms.DataGridTableStyle[] {
            this.dataGridTableStyle1});
            this.myDataGrid2.Click += new System.EventHandler(this.myDataGrid2_CurrentCellChanged);
            // 
            // dataGridTableStyle1
            // 
            this.dataGridTableStyle1.DataGrid = this.myDataGrid2;
            this.dataGridTableStyle1.GridColumnStyles.AddRange(new System.Windows.Forms.DataGridColumnStyle[] {
            this.dataGridTextBoxColumn1,
            this.dataGridTextBoxColumn2,
            this.dataGridTextBoxColumn3,
            this.dataGridTextBoxColumn22});
            this.dataGridTableStyle1.HeaderForeColor = System.Drawing.SystemColors.ControlText;
            this.dataGridTableStyle1.ReadOnly = true;
            // 
            // dataGridTextBoxColumn1
            // 
            this.dataGridTextBoxColumn1.Format = "";
            this.dataGridTextBoxColumn1.FormatInfo = null;
            this.dataGridTextBoxColumn1.HeaderText = "模板名称";
            this.dataGridTextBoxColumn1.NullText = "";
            this.dataGridTextBoxColumn1.Width = 120;
            // 
            // dataGridTextBoxColumn2
            // 
            this.dataGridTextBoxColumn2.Format = "";
            this.dataGridTextBoxColumn2.FormatInfo = null;
            this.dataGridTextBoxColumn2.HeaderText = "登记时间";
            this.dataGridTextBoxColumn2.NullText = "";
            this.dataGridTextBoxColumn2.Width = 120;
            // 
            // dataGridTextBoxColumn3
            // 
            this.dataGridTextBoxColumn3.Format = "";
            this.dataGridTextBoxColumn3.FormatInfo = null;
            this.dataGridTextBoxColumn3.HeaderText = "登记人";
            this.dataGridTextBoxColumn3.NullText = "";
            this.dataGridTextBoxColumn3.Width = 60;
            // 
            // dataGridTextBoxColumn22
            // 
            this.dataGridTextBoxColumn22.Format = "";
            this.dataGridTextBoxColumn22.FormatInfo = null;
            this.dataGridTextBoxColumn22.HeaderText = "id";
            this.dataGridTextBoxColumn22.NullText = "";
            this.dataGridTextBoxColumn22.Width = 0;
            // 
            // tabPage2
            // 
            this.tabPage2.Controls.Add(this.groupBox3);
            this.tabPage2.Controls.Add(this.groupBox6);
            this.tabPage2.Location = new System.Drawing.Point(4, 24);
            this.tabPage2.Name = "tabPage2";
            this.tabPage2.Size = new System.Drawing.Size(1022, 475);
            this.tabPage2.TabIndex = 1;
            this.tabPage2.Text = "查询药品";
            this.tabPage2.UseVisualStyleBackColor = true;
            // 
            // groupBox3
            // 
            this.groupBox3.Controls.Add(this.panel5);
            this.groupBox3.Controls.Add(this.splitter2);
            this.groupBox3.Controls.Add(this.panel3);
            this.groupBox3.Dock = System.Windows.Forms.DockStyle.Fill;
            this.groupBox3.ForeColor = System.Drawing.Color.FromArgb(((int)(((byte)(0)))), ((int)(((byte)(0)))), ((int)(((byte)(192)))));
            this.groupBox3.Location = new System.Drawing.Point(0, 48);
            this.groupBox3.Name = "groupBox3";
            this.groupBox3.Size = new System.Drawing.Size(1022, 427);
            this.groupBox3.TabIndex = 2;
            this.groupBox3.TabStop = false;
            // 
            // panel5
            // 
            this.panel5.Controls.Add(this.myDataGrid3);
            this.panel5.Dock = System.Windows.Forms.DockStyle.Fill;
            this.panel5.Location = new System.Drawing.Point(224, 17);
            this.panel5.Name = "panel5";
            this.panel5.Size = new System.Drawing.Size(795, 407);
            this.panel5.TabIndex = 3;
            // 
            // myDataGrid3
            // 
            this.myDataGrid3.BackgroundColor = System.Drawing.Color.White;
            this.myDataGrid3.CaptionBackColor = System.Drawing.Color.DarkGray;
            this.myDataGrid3.CaptionText = "没有被加为模板的库存药品";
            this.myDataGrid3.CaptionVisible = false;
            this.myDataGrid3.DataMember = "";
            this.myDataGrid3.Dock = System.Windows.Forms.DockStyle.Fill;
            this.myDataGrid3.HeaderForeColor = System.Drawing.SystemColors.ControlText;
            this.myDataGrid3.Location = new System.Drawing.Point(0, 0);
            this.myDataGrid3.Name = "myDataGrid3";
            this.myDataGrid3.Size = new System.Drawing.Size(795, 407);
            this.myDataGrid3.TabIndex = 0;
            this.myDataGrid3.TableStyles.AddRange(new System.Windows.Forms.DataGridTableStyle[] {
            this.dataGridTableStyle3});
            this.myDataGrid3.DoubleClick += new System.EventHandler(this.myDataGrid3_DoubleClick);
            this.myDataGrid3.CurrentCellChanged += new System.EventHandler(this.myDataGrid3_CurrentCellChanged);
            // 
            // dataGridTableStyle3
            // 
            this.dataGridTableStyle3.DataGrid = this.myDataGrid3;
            this.dataGridTableStyle3.GridColumnStyles.AddRange(new System.Windows.Forms.DataGridColumnStyle[] {
            this.dataGridTextBoxColumn13,
            this.dataGridTextBoxColumn14,
            this.dataGridTextBoxColumn15,
            this.dataGridTextBoxColumn16,
            this.dataGridTextBoxColumn19,
            this.dataGridTextBoxColumn17,
            this.dataGridTextBoxColumn18,
            this.dataGridTextBoxColumn20,
            this.dataGridTextBoxColumn24,
            this.dataGridTextBoxColumn23,
            this.dataGridBoolColumn1});
            this.dataGridTableStyle3.HeaderForeColor = System.Drawing.SystemColors.ControlText;
            this.dataGridTableStyle3.ReadOnly = true;
            // 
            // dataGridTextBoxColumn13
            // 
            this.dataGridTextBoxColumn13.Format = "";
            this.dataGridTextBoxColumn13.FormatInfo = null;
            this.dataGridTextBoxColumn13.HeaderText = "序号";
            this.dataGridTextBoxColumn13.Width = 35;
            // 
            // dataGridTextBoxColumn14
            // 
            this.dataGridTextBoxColumn14.Format = "";
            this.dataGridTextBoxColumn14.FormatInfo = null;
            this.dataGridTextBoxColumn14.HeaderText = "品名";
            this.dataGridTextBoxColumn14.Width = 150;
            // 
            // dataGridTextBoxColumn15
            // 
            this.dataGridTextBoxColumn15.Format = "";
            this.dataGridTextBoxColumn15.FormatInfo = null;
            this.dataGridTextBoxColumn15.HeaderText = "规格";
            this.dataGridTextBoxColumn15.Width = 75;
            // 
            // dataGridTextBoxColumn16
            // 
            this.dataGridTextBoxColumn16.Format = "";
            this.dataGridTextBoxColumn16.FormatInfo = null;
            this.dataGridTextBoxColumn16.HeaderText = "厂家";
            this.dataGridTextBoxColumn16.Width = 75;
            // 
            // dataGridTextBoxColumn19
            // 
            this.dataGridTextBoxColumn19.Format = "";
            this.dataGridTextBoxColumn19.FormatInfo = null;
            this.dataGridTextBoxColumn19.HeaderText = "单位";
            this.dataGridTextBoxColumn19.Width = 40;
            // 
            // dataGridTextBoxColumn17
            // 
            this.dataGridTextBoxColumn17.Format = "";
            this.dataGridTextBoxColumn17.FormatInfo = null;
            this.dataGridTextBoxColumn17.HeaderText = "批发价";
            this.dataGridTextBoxColumn17.Width = 70;
            // 
            // dataGridTextBoxColumn18
            // 
            this.dataGridTextBoxColumn18.Format = "";
            this.dataGridTextBoxColumn18.FormatInfo = null;
            this.dataGridTextBoxColumn18.HeaderText = "零售价";
            this.dataGridTextBoxColumn18.Width = 70;
            // 
            // dataGridTextBoxColumn20
            // 
            this.dataGridTextBoxColumn20.Format = "";
            this.dataGridTextBoxColumn20.FormatInfo = null;
            this.dataGridTextBoxColumn20.HeaderText = "货号";
            this.dataGridTextBoxColumn20.Width = 70;
            // 
            // dataGridTextBoxColumn24
            // 
            this.dataGridTextBoxColumn24.Format = "";
            this.dataGridTextBoxColumn24.FormatInfo = null;
            this.dataGridTextBoxColumn24.HeaderText = "ggid";
            this.dataGridTextBoxColumn24.Width = 0;
            // 
            // dataGridTextBoxColumn23
            // 
            this.dataGridTextBoxColumn23.Format = "";
            this.dataGridTextBoxColumn23.FormatInfo = null;
            this.dataGridTextBoxColumn23.HeaderText = "cjid";
            this.dataGridTextBoxColumn23.Width = 0;
            // 
            // dataGridBoolColumn1
            // 
            this.dataGridBoolColumn1.AllowNull = false;
            this.dataGridBoolColumn1.FalseValue = ((short)(0));
            this.dataGridBoolColumn1.HeaderText = "停用";
            this.dataGridBoolColumn1.NullValue = ((short)(0));
            this.dataGridBoolColumn1.TrueValue = ((short)(1));
            this.dataGridBoolColumn1.Width = 40;
            // 
            // splitter2
            // 
            this.splitter2.Location = new System.Drawing.Point(216, 17);
            this.splitter2.Name = "splitter2";
            this.splitter2.Size = new System.Drawing.Size(8, 407);
            this.splitter2.TabIndex = 2;
            this.splitter2.TabStop = false;
            // 
            // panel3
            // 
            this.panel3.Controls.Add(this.treeView1);
            this.panel3.Dock = System.Windows.Forms.DockStyle.Left;
            this.panel3.Location = new System.Drawing.Point(3, 17);
            this.panel3.Name = "panel3";
            this.panel3.Size = new System.Drawing.Size(213, 407);
            this.panel3.TabIndex = 1;
            // 
            // treeView1
            // 
            this.treeView1.BackColor = System.Drawing.Color.WhiteSmoke;
            this.treeView1.Dock = System.Windows.Forms.DockStyle.Fill;
            this.treeView1.Location = new System.Drawing.Point(0, 0);
            this.treeView1.Name = "treeView1";
            this.treeView1.Size = new System.Drawing.Size(213, 407);
            this.treeView1.TabIndex = 2;
            this.treeView1.AfterSelect += new System.Windows.Forms.TreeViewEventHandler(this.treeView1_AfterSelect);
            // 
            // groupBox6
            // 
            this.groupBox6.Controls.Add(this.label1);
            this.groupBox6.Controls.Add(this.txtdm);
            this.groupBox6.Dock = System.Windows.Forms.DockStyle.Top;
            this.groupBox6.ForeColor = System.Drawing.Color.FromArgb(((int)(((byte)(0)))), ((int)(((byte)(0)))), ((int)(((byte)(192)))));
            this.groupBox6.Location = new System.Drawing.Point(0, 0);
            this.groupBox6.Name = "groupBox6";
            this.groupBox6.Size = new System.Drawing.Size(1022, 48);
            this.groupBox6.TabIndex = 1;
            this.groupBox6.TabStop = false;
            this.groupBox6.Text = "查询";
            // 
            // label1
            // 
            this.label1.ForeColor = System.Drawing.Color.Black;
            this.label1.Location = new System.Drawing.Point(17, 23);
            this.label1.Name = "label1";
            this.label1.Size = new System.Drawing.Size(55, 15);
            this.label1.TabIndex = 1;
            this.label1.Text = "药品代码";
            // 
            // txtdm
            // 
            this.txtdm.Location = new System.Drawing.Point(80, 17);
            this.txtdm.Name = "txtdm";
            this.txtdm.Size = new System.Drawing.Size(920, 21);
            this.txtdm.TabIndex = 0;
            this.txtdm.KeyUp += new System.Windows.Forms.KeyEventHandler(this.txtdm_KeyUp);
            // 
            // imageList1
            // 
            this.imageList1.ImageStream = ((System.Windows.Forms.ImageListStreamer)(resources.GetObject("imageList1.ImageStream")));
            this.imageList1.TransparentColor = System.Drawing.Color.Transparent;
            this.imageList1.Images.SetKeyName(0, "");
            this.imageList1.Images.SetKeyName(1, "");
            this.imageList1.Images.SetKeyName(2, "");
            // 
            // Frmyptjmb
            // 
            this.AutoScaleBaseSize = new System.Drawing.Size(6, 14);
            this.ClientSize = new System.Drawing.Size(1030, 527);
            this.Controls.Add(this.tabControl1);
            this.Controls.Add(this.statusBar1);
            this.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedSingle;
            this.Name = "Frmyptjmb";
            this.ShowInTaskbar = false;
            this.StartPosition = System.Windows.Forms.FormStartPosition.CenterScreen;
            this.Text = "药品统计模板";
            this.Load += new System.EventHandler(this.Frmmbmx_Load);
            ((System.ComponentModel.ISupportInitialize)(this.statusBarPanel1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.statusBarPanel2)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.statusBarPanel3)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.statusBarPanel4)).EndInit();
            this.tabControl1.ResumeLayout(false);
            this.tabPage1.ResumeLayout(false);
            this.panel2.ResumeLayout(false);
            this.groupBox5.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.myDataGrid1)).EndInit();
            this.groupBox4.ResumeLayout(false);
            this.groupBox2.ResumeLayout(false);
            this.groupBox2.PerformLayout();
            this.panel1.ResumeLayout(false);
            this.groupBox1.ResumeLayout(false);
            this.panel4.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.myDataGrid2)).EndInit();
            this.tabPage2.ResumeLayout(false);
            this.groupBox3.ResumeLayout(false);
            this.panel5.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.myDataGrid3)).EndInit();
            this.panel3.ResumeLayout(false);
            this.groupBox6.ResumeLayout(false);
            this.groupBox6.PerformLayout();
            this.ResumeLayout(false);

		}
		#endregion

		private void Frmmbmx_Load(object sender, System.EventArgs e)
		{
			//初始化
			FunBase.CsDataGrid(this.myDataGrid1,this.myDataGrid1.TableStyles[0],"Tb");


			FunBase.CsDataGrid(this.myDataGrid2,this.myDataGrid2.TableStyles[0],"Tb1");


			FunBase.CsDataGrid(this.myDataGrid3,this.myDataGrid3.TableStyles[0],"Tb3");


            AddTitle();
            AddTreeYpsx();

            this.WindowState = FormWindowState.Maximized;
		}


        private void AddTreeYpsx()
        {
            this.treeView1.Nodes.Clear();
            this.treeView1.ImageList = this.imageList1;
            TreeNode node = treeView1.Nodes.Add("属性状态");
            TreeNode Cnode2 = node.Nodes.Add("毒剧药品");
            Cnode2.Tag = " and djyp=1 ";
            Cnode2.ImageIndex = 1;
            TreeNode Cnode3 = node.Nodes.Add("麻醉药品");
            Cnode3.Tag = " and mzyp=1 ";
            Cnode3.ImageIndex = 1;
            TreeNode Cnode4 = node.Nodes.Add("皮试药品");
            Cnode4.Tag = " and psyp=1 ";
            Cnode4.ImageIndex = 1;
            TreeNode Cnode5 = node.Nodes.Add("精神药品");
            Cnode5.Tag = " and jsyp=1 ";
            Cnode5.ImageIndex = 1;
            TreeNode Cnode6 = node.Nodes.Add("贵重药品");
            Cnode6.Tag = " and gzyp=1 ";
            Cnode6.ImageIndex = 1;

            TreeNode Cnode20 = node.Nodes.Add("外用药品");
            Cnode20.Tag = " and wyyp=1 ";
            Cnode20.ImageIndex = 1;

            TreeNode Cnode7 = node.Nodes.Add("处方药品");
            Cnode7.Tag = " and cfyp=1 ";
            Cnode7.ImageIndex = 1;

            TreeNode Cnode21 = node.Nodes.Add("妊娠药品");
            Cnode21.Tag = " and rsyp=1 ";
            Cnode21.ImageIndex = 1;

            TreeNode Cnode22 = node.Nodes.Add("中标药品");
            Cnode22.Tag = " and zbzt=1 ";
            Cnode22.ImageIndex = 1;

            TreeNode Cnode32 = node.Nodes.Add("基本药物");
            Cnode32.Tag = " and GJJBYW=1 ";
            Cnode32.ImageIndex = 1;

            TreeNode Cnode13 = node.Nodes.Add("停用的药品");
            Cnode13.Tag = " and b.BDELETE=1 ";
            Cnode13.ImageIndex = 1;

            TreeNode Cnode14 = node.Nodes.Add("★按包装取整");
            Cnode14.Tag = " and lyfs=1 ";
            Cnode14.ImageIndex = 1;
            TreeNode Cnode15 = node.Nodes.Add("★按含量累计");
            Cnode15.Tag = " and lyfs=2 ";
            Cnode15.ImageIndex = 1;

            TreeNode Cnode16 = node.Nodes.Add("●正主任医师用药");
            Cnode16.Tag = " and cfjb=1 ";
            Cnode16.ImageIndex = 1;
            TreeNode Cnode17 = node.Nodes.Add("●副正主任医师用药");
            Cnode17.Tag = " and cfjb=2 ";
            Cnode17.ImageIndex = 1;
            TreeNode Cnode18 = node.Nodes.Add("●主治医师用药");
            Cnode18.Tag = " and cfjb=3 ";
            Cnode18.ImageIndex = 1;
            TreeNode Cnode19 = node.Nodes.Add("●经治医师用药");
            Cnode19.Tag = " and cfjb=4 ";
            Cnode19.ImageIndex = 1;

            //统领分类
            string ssql = "select * from yp_tlfl ";
            DataTable tb = InstanceForm.BDatabase.GetDataTable(ssql);
            for (int i = 0; i <= tb.Rows.Count - 1; i++)
            {
                TreeNode Cnode30 = node.Nodes.Add("※" + Convertor.IsNull(tb.Rows[i]["name"], ""));
                Cnode30.Tag = " and a.tlfl='" + Convertor.IsNull(tb.Rows[i]["code"], "") + "' ";

                Cnode30.ImageIndex = 1;
            }

            //modefy by lwl 2011-10-19
            //抗生素等级
            string ksssql = "select * from YP_KSSDJ";
            DataTable dt = InstanceForm.BDatabase.GetDataTable(ksssql);
            for (int i = 0; i < dt.Rows.Count; i++)
            {
                TreeNode Cnode31 = node.Nodes.Add("★" + Convertor.IsNull(dt.Rows[i]["KSSDJMC"], ""));
                Cnode31.Tag = " and a.KSSDJID='" + Convertor.IsNull(dt.Rows[i]["KSSDJID"], "") + "' ";

                Cnode31.ImageIndex = 1;
            }




            node.Expand();


        }
	
		#region 界面控制
		//重新排列序号
		private void SortXH()
		{
			DataTable tb=(DataTable)this.myDataGrid1.DataSource;
			for (int i=0;i<=tb.Rows.Count-1;i++)
			{
				tb.Rows[i]["序号"]=i+1;
			}
			tb.AcceptChanges();
		}

		//清空Groupbox2
		private void csgroupbox2()
		{
			this.txtypdm.Text="";
			this.lblypmc.Text="";
			this.lblypmc.Tag="0";
			this.lblgg.Text="";
			this.lblcj.Text="";
			this.lblhh.Text="";
			this.lblpfj.Text="";
			this.lbllsj.Text="";
			this.lblpfj.Tag="";
			this.lbllsj.Tag ="";
			this.lbldw.Text="";

			//this.txtypdm.Focus();
		}

	
		//初始药品
		private void csyp(int ggid,int cjid)
		{
			try
			{
				this.csgroupbox2();
                Ypcj ydcj = new Ypcj(cjid, InstanceForm.BDatabase);
                Ypgg ydgg = new Ypgg(ydcj.GGID, InstanceForm.BDatabase);
				this.lblypmc.Tag=ydcj.CJID.ToString();
				this.lblypmc.Text=ydgg.YPSPM;
				this.lblgg.Text=ydgg.YPGG;
                this.lblcj.Text = Yp.SeekSccj(ydcj.SCCJ, InstanceForm.BDatabase);
				this.lblhh.Text=ydcj.SHH;
				this.lblpfj.Text=ydcj.PFJ.ToString();
				this.lbllsj.Text=ydcj.LSJ.ToString() ;
				this.lblpfj.Tag=ydcj.PFJ.ToString();
				this.lbllsj.Tag=ydcj.LSJ.ToString() ;
                this.lbldw.Text = ydcj.S_YPDW;
			}
			catch(System.Exception err)
			{
				MessageBox.Show("发生错误"+err.Message);
			}
		}


		//输入框控制事件
		private void TextKeyUp(object sender, KeyEventArgs e)//KeyEventArgs
		{
			int nkey=Convert.ToInt32(e.KeyCode);
			Control control=(Control)sender;

			if (control.Text.Trim()=="" ){control.Text="";control.Tag="0";}

			if ((nkey>=65 &&  nkey<=90) || (nkey>=48 && nkey<=57) || (nkey>=96 && nkey<=105) || nkey==8 || nkey==32 || nkey==46||(nkey==13 && (Convert.ToString(control.Tag)=="0" || Convert.ToString(control.Tag)=="")))
			{}
			else{return;}

			string[] GrdMappingName;
			int[] GrdWidth;
			string[]sfield;
			string ssql="";
			DataRow row;
			
			try
			{
				Point point=new Point(this.Location.X+control.Location.X,this.Location.Y+control.Location.Y+control.Height*3 );
				switch(control.TabIndex)
				{
					case 0:
						if (control.Text.Trim()=="") return;
                        if (control.Text.Trim() == "") return;
                        Yp.frmShowCard(sender, ShowCardType.所有药品字典, 0, point, 0, InstanceForm.BDatabase);
                        if (Convertor.IsNull(control.Tag, "0") != "0")
                        {
                            Ypcj cj = new Ypcj(Convert.ToInt32(Convertor.IsNull(control.Tag, "0")), InstanceForm.BDatabase);
                            csgroupbox2();
                            this.csyp(cj.GGID, cj.CJID);
                            this.SelectNextControl((Control)sender, true, false, true, true);
                        }
						break;
				}
			}
			catch(System.Exception err)
			{
				MessageBox.Show("发生错误"+err.Message);
			}


		}


		private void myDataGrid2_CurrentCellChanged(object sender, System.EventArgs e)
		{
			
			DataTable tb=(DataTable)this.myDataGrid2.DataSource;
			int nrow=this.myDataGrid2.CurrentCell.RowNumber;
			if (nrow>tb.Rows.Count-1) return;
			this.Addmx(Convert.ToInt32(tb.Rows[nrow]["id"]));
			this.groupBox5.Text=tb.Rows[nrow]["模板名称"].ToString();
			this.groupBox5.Tag=tb.Rows[nrow]["id"].ToString();
			this.myDataGrid2.Select(this.myDataGrid2.CurrentCell.RowNumber);
		}

	
		//mydataGrid3
		private void myDataGrid3_CurrentCellChanged(object sender, System.EventArgs e)
		{
			this.myDataGrid3.Select(this.myDataGrid3.CurrentCell.RowNumber);
		}
		private void myDataGrid3_DoubleClick(object sender, System.EventArgs e)
		{
			try
			{
				DataTable tb3=(DataTable)this.myDataGrid3.DataSource;
				DataTable tb1=(DataTable)this.myDataGrid1.DataSource;
				int nrow=this.myDataGrid3.CurrentCell.RowNumber;
				if (nrow>tb3.Rows.Count-1) return;
				this.csyp(Convert.ToInt32(tb3.Rows[nrow]["ggid"]),Convert.ToInt32(tb3.Rows[nrow]["cjid"]));

				DataRow row=tb1.NewRow();
				this.Fillrow(row);
				tb1.Rows.Add(row);
				tb3.Rows[nrow].Delete();
				tb3.AcceptChanges();
				this.SortXH();
			}
			catch(System.Exception err)
			{
				MessageBox.Show(err.Message);
			}
		}


		//在tabpage2中按代码查询时
		private void txtdm_KeyUp(object sender, System.Windows.Forms.KeyEventArgs e)
		{
			try
			{
				if (Convert.ToInt32(e.KeyCode)==13)
				{
                    SelectGG("", txtdm.Text.Trim());
					//FunBase.myGridSelect(this.myDataGrid3,this.myDataGrid3.TableStyles[0].GridColumnStyles);
				}
			}
			catch(System.Exception err)
			{
				MessageBox.Show(err.Message);
			}
		}

		//页面切换事件
		private void tabControl1_SelectedIndexChanged(object sender, System.EventArgs e)
		{
			try
			{
				if (tabControl1.SelectedTab==this.tabPage2)
				{
                    SelectGG("", txtdm.Text.Trim());
					//FunBase.myGridSelect(this.myDataGrid3,this.myDataGrid3.TableStyles[0].GridColumnStyles);
				}
			}
			catch(System.Exception err)
			{
				MessageBox.Show(err.Message);
			}
		}


		//验正记录在网格中已存在
		private bool DataBool(int cjid,out string bz)
		{
			bz="";
			bool B=true;
			try
			{
				DataTable tb=(DataTable)this.myDataGrid1.DataSource;
				for (int i=0;i<=tb.Rows.Count-1;i++)
				{
					if (cjid==Convert.ToInt32(tb.Rows[i]["cjid"]))
					{
						B=false;
					}
				}

                ////如果当前网格中没有已添加的
                //if (B==true)
                //{
                //    string ssql = "select * from yp_yptjmb a,yp_yptjmbmx b where a.id=b.mbid and cjid=" + cjid + " and b.deptid=" + Convert.ToInt32(Convertor.IsNull(cmbck.SelectedValue, "0")) + "";
                //    DataTable tb1=InstanceForm.BDatabase.GetDataTable(ssql);
                //    if (tb1.Rows.Count>0) {bz=tb1.Rows[0]["mbmc"].ToString();B=false;} 

                //}
			}
			catch(System.Exception err)
			{
				throw new Exception(err.Message);
			}
			return B;
		}


		private void GotoNext(object sender, KeyPressEventArgs e)
		{ 
			Control control=(Control)sender;
			if (e.KeyChar==13 )
			{
				this.SelectNextControl(control,true,false,true,true);
			}
		}

		#endregion
	
		#region 填充数据
		//刷新模板头
		private void AddTitle()
		{
            string ssql = "SELECT  mbmc 模板名称,djsj 登记时间, dbo.fun_getempname(djy) 登记人,id FROM YP_YPTJMB   order by id";
			DataTable myTb=InstanceForm.BDatabase.GetDataTable(ssql);
			myTb.TableName="Tb1";
			this.myDataGrid2.DataSource=myTb;
			this.myDataGrid2.TableStyles[0].MappingName="Tb1";
			FunBase.myGridSelect(this.myDataGrid2,this.myDataGrid2.TableStyles[0].GridColumnStyles);
		}

		//添加模板明细
		public void Addmx(int mbid)
		{
			DataTable myTb=new DataTable();
			myTb.TableName="Tb";

            string ssql = "SELECT  0 序号,YPPM 品名, ypgg 规格, s_sccj 厂家, dbo.fun_yp_ypdw(ypdw) 单位, pfj 批发价,lsj 零售价,shh 货号,b.bz 描述,b.cjid FROM vi_yp_ypcd a,yp_YPTJMBmx b where a.cjid=b.cjid and b.mbid=" + mbid + " order by id";
			myTb=InstanceForm.BDatabase.GetDataTable(ssql);
			FunBase.AddRowtNo(myTb);
			myTb.TableName="Tb";
			this.myDataGrid1.DataSource=myTb;
			this.myDataGrid1.TableStyles[0].MappingName ="Tb";

		}

		//填充行
		private void Fillrow(System.Data.DataRow row)
		{
			if (Convert.ToInt32(this.lblypmc.Tag)==0) 
			{
				throw new Exception("没有可添加的药品");
			}
			

			DataTable tb=(DataTable)this.myDataGrid1.DataSource;
			row["序号"]=tb.Rows.Count+1;
			row["品名"]=this.lblypmc.Text.Trim();
			row["规格"]=this.lblgg.Text.Trim();
			row["厂家"]=this.lblcj.Text.Trim();
			row["批发价"]=this.lblpfj.Text.Trim();
			row["零售价"]=this.lbllsj.Text.Trim();
			row["单位"]=this.lbldw.Text.Trim();
			row["货号"]=this.lblhh.Text.Trim();
			row["描述"]=this.txtbz.Text.Trim();
			row["CJID"]=this.lblypmc.Tag.ToString();
		}


		#endregion

		#region 添加药品系列按钮事件
		private void butadd_Click(object sender, System.EventArgs e)
		{
			try
			{

				DataTable tb=(DataTable)this.myDataGrid1.DataSource;

                string bz = "";
                if (DataBool(Convert.ToInt32(Convertor.IsNull(lblypmc.Tag, "0")), out bz) == false)
                {
                    if (bz.Trim() == "")
                    {
                        MessageBox.Show("在当前模板中这个药品已经添加了，不能重复添加","提示", MessageBoxButtons.OK, MessageBoxIcon.Error);
                        txtdm.Focus();
                        return;
                    }
                    else
                    {
                        if (MessageBox.Show("这个药品已经在 [" + bz.Trim() + "] 模板中添加了？", "询问窗", MessageBoxButtons.YesNo, MessageBoxIcon.Question, MessageBoxDefaultButton.Button2) == DialogResult.No)
                        {
                            txtdm.Focus();
                            return;
                        }
                    }
                }

				DataRow row=tb.NewRow();
				this.Fillrow(row);
				if (row["品名"].ToString().Trim()!="")
				{
					tb.Rows.Add(row);
					this.myDataGrid1.CurrentCell=new DataGridCell(tb.Rows.Count-1,1);
					this.csgroupbox2();
					this.txtypdm.Focus();
					return;
				}
			}
			catch(System.Exception err)
			{
				MessageBox.Show(err.Message);
			}
		}

		private void butdel_Click(object sender, System.EventArgs e)
		{
			try
			{
				DataTable tb=(DataTable)this.myDataGrid1.DataSource;
				int nrow=this.myDataGrid1.CurrentCell.RowNumber;
				if (nrow>=tb.Rows.Count) return;
				if(MessageBox.Show("您确定要删除第"+Convert.ToString((nrow+1))+"行吗 ？","询问窗",MessageBoxButtons.YesNo,MessageBoxIcon.Question,MessageBoxDefaultButton.Button2)==DialogResult.Yes)
				{
					DataRow datarow=tb.Rows[nrow];
                    string ssql = "delete from yp_YPTJMBmx where cjid=" + Convert.ToInt64(Convertor.IsNull(datarow["cjid"], "0")) + " ";
					InstanceForm.BDatabase.DoCommand(ssql);
					tb.Rows.Remove(datarow);
				}
			
				this.butadd.Enabled=true;

				this.SortXH();
			}
			catch(System.Exception err)
			{
				MessageBox.Show("发生错误"+err.Message);
			}
		}

		private void butup_Click(object sender, System.EventArgs e)
		{
			try
			{
				DataTable tb=(DataTable)this.myDataGrid1.DataSource;
				int nrow=this.myDataGrid1.CurrentCell.RowNumber;
				if (nrow>tb.Rows.Count-1)return;
				if (nrow-1<0) return;
				DataRow row=tb.NewRow();
				for (int i=0;i<=tb.Columns.Count-1;i++)
				{
					row[i]=tb.Rows[nrow][i];
				}

				tb.Rows.Remove(tb.Rows[nrow]);
				tb.AcceptChanges();
				tb.Rows.InsertAt(row,nrow-1);
				SortXH();
				tb.AcceptChanges();
				this.myDataGrid1.CurrentCell=new DataGridCell(nrow-1,2);
			}
			catch(System.Exception err)
			{
				MessageBox.Show(err.Message);
			}
		}

		private void butdown_Click(object sender, System.EventArgs e)
		{
			try
			{
				DataTable tb=(DataTable)this.myDataGrid1.DataSource;
				int nrow=this.myDataGrid1.CurrentCell.RowNumber;
				if (nrow>tb.Rows.Count-1)return;
				if (nrow+1==tb.Rows.Count) return;
				DataRow row=tb.NewRow();
				for (int i=0;i<=tb.Columns.Count-1;i++)
				{
					row[i]=tb.Rows[nrow][i];
				}

				tb.Rows.Remove(tb.Rows[nrow]);
				tb.AcceptChanges();
				tb.Rows.InsertAt(row,nrow+1);
				SortXH();
				tb.AcceptChanges();
				this.myDataGrid1.CurrentCell=new DataGridCell(nrow+1,2);
			}
			catch(System.Exception err)
			{
				MessageBox.Show(err.Message);
			}
			
			
		}
		private void butinsert_Click(object sender, System.EventArgs e)
		{
			try
			{
                int mbid = Convert.ToInt32(Convertor.IsNull(this.groupBox5.Tag, "0"));

				DataTable tb=(DataTable)this.myDataGrid1.DataSource;
				int nrow=this.myDataGrid1.CurrentCell.RowNumber;
				if (nrow>tb.Rows.Count-1)return;

                int brow=-1;
				int torow=0;

				TrasenFrame.Forms.DlgInputBox f=new TrasenFrame.Forms.DlgInputBox("","将"+this.lblypmc.Text.ToString().Trim()+"插入到下列行号之后 ","插入");
				f.NumCtrl=true;
				f.ShowDialog();
				if (TrasenFrame.Forms.DlgInputBox.DlgResult==true) torow=Convert.ToInt32(TrasenFrame.Forms.DlgInputBox.DlgValue);else return;
				if (torow<0 || torow>tb.Rows.Count || (torow-1)<0) return;


                for (int i = 0; i <= tb.Rows.Count - 1; i++)
                {
                    if (Convert.ToInt32(Convertor.IsNull(this.lblypmc.Tag, "0")) == Convert.ToInt32(tb.Rows[i]["cjid"]))
                    {
                        brow = this.myDataGrid1.CurrentCell.RowNumber;
                    }
                        
                }
                if (brow == -1)
                {
                    this.butadd_Click(sender, e);
                    brow = tb.Rows.Count - 1;
                }

                DataRow row = tb.NewRow();
                for (int j = 0; j <= tb.Columns.Count - 1; j++)
                    row[j] = tb.Rows[brow][j];

                tb.Rows.Remove(tb.Rows[brow]);
                tb.Rows.InsertAt(row, torow - 1);
                SortXH();
                tb.AcceptChanges();
                this.myDataGrid1.CurrentCell = new DataGridCell(torow - 1, 2);

                this.csgroupbox2();
			}
			catch(System.Exception err)
			{
				MessageBox.Show(err.Message);
			}

		}
		#endregion

		#region 按钮事件
		//新增模板
		private void butnew_Click(object sender, System.EventArgs e)
		{
			this.groupBox5.Text="新模板";
			this.groupBox5.Tag="0";
			DataTable tb=(DataTable)this.myDataGrid1.DataSource;
			tb.Rows.Clear();
			tb.AcceptChanges();
			this.csgroupbox2();
		}

		
		//保存模板
		private void butsave_Click(object sender, System.EventArgs e)
		{
			string mbmc="";
			int newmbid=0;
			int mbid=Convert.ToInt32(Convertor.IsNull(this.groupBox5.Tag,"0"));
			DataTable tb=(DataTable)this.myDataGrid1.DataSource;
			if (tb.Rows.Count==0){MessageBox.Show("没有要保存的记录");return;}
			if (mbid==0)
			{
				TrasenFrame.Forms.DlgInputBox f=new TrasenFrame.Forms.DlgInputBox(mbmc,"请输入模板的名称","输入名称");
				f.ShowDialog();
				if (DlgInputBox.DlgResult==true) mbmc=DlgInputBox.DlgValue;else return;
			}
			else
			{
				mbmc=this.groupBox5.Text.Trim();
			}
			
			try
			{
				this.Cursor=TrasenClasses.GeneralClasses.PubStaticFun.WaitCursor();

				InstanceForm.BDatabase.BeginTransaction();
                //保存模板头
                string pym = TrasenClasses.GeneralClasses.PubStaticFun.GetPYWBM(mbmc, 0);
                string wbm = TrasenClasses.GeneralClasses.PubStaticFun.GetPYWBM(mbmc, 1);
                YP_YPTJMB.SaveMb(mbid, mbmc, pym, wbm, DateManager.ServerDateTimeByDBType(InstanceForm.BDatabase).ToString(), InstanceForm.BCurrentUser.EmployeeId, out newmbid, InstanceForm.BDatabase);
                if (newmbid == 0 && mbid == 0) { MessageBox.Show("模板ID为零，没有保存成功"); return; }
                if (mbid == 0 && newmbid != 0) { mbid = newmbid; }

                //删除模板明细
                YP_YPTJMB.DeleteMbmx(mbid, InstanceForm.BDatabase);
                //保存模板明细
                for (int i = 0; i <= tb.Rows.Count - 1; i++)
                {
                    if (Convert.ToInt32(Convertor.IsNull(tb.Rows[i]["cjid"], "0")) > 0)
                        YP_YPTJMB.SaveMbmx(Convert.ToInt32(tb.Rows[i]["cjid"]), mbid, tb.Rows[i]["描述"].ToString(), InstanceForm.BDatabase);
                }
				
				InstanceForm.BDatabase.CommitTransaction();
				
				MessageBox.Show("保存成功");
				this.groupBox5.Tag=mbid.ToString();
				this.groupBox5.Text=mbmc.Trim();

                this.AddTitle();
				
			}
			catch(System.Exception err)
			{
				InstanceForm.BDatabase.RollbackTransaction();
				this.butsave.Enabled=true;
				MessageBox.Show(err.Message);
			}
			finally
			{
				this.Cursor=Cursors.Arrow;
			}
		}


		//删除模板
		private void butdelmb_Click(object sender, System.EventArgs e)
		{
			if (this.groupBox5.Tag.ToString().Trim()=="0") {MessageBox.Show("没有选择模板");return;}
			if (MessageBox.Show(this, "您确定要删除这个模板吗？", "确认", MessageBoxButtons.YesNo)==DialogResult.No ) return;

			try
			{
				this.Cursor=TrasenClasses.GeneralClasses.PubStaticFun.WaitCursor();
				InstanceForm.BDatabase.BeginTransaction();
				int mbid=Convert.ToInt32(Convertor.IsNull(this.groupBox5.Tag,"0"));
                YP_YPTJMB.DeleteMbmx(mbid, InstanceForm.BDatabase);
                YP_YPTJMB.DeleteMb(mbid, InstanceForm.BDatabase);

				InstanceForm.BDatabase.CommitTransaction();
				MessageBox.Show("删除成功");
				this.csgroupbox2();
				this.groupBox5.Text="新模板";
				this.groupBox5.Tag="0";
				DataTable tb=(DataTable)this.myDataGrid1.DataSource;
				tb.Rows.Clear();
                this.AddTitle();
			}
			catch(System.Exception err)
			{
				InstanceForm.BDatabase.RollbackTransaction();
				this.butsave.Enabled=true;
				MessageBox.Show(err.Message);
			}
			finally
			{
				this.Cursor=Cursors.Arrow;
			}
		}

		
		//退出
		private void butquit_Click(object sender, System.EventArgs e)
		{
			this.Close();
		}


		//修改模板名称
		private void butmodifmc_Click(object sender, System.EventArgs e)
		{
			int outmbid=0;
			int mbid=Convert.ToInt32(Convertor.IsNull(this.groupBox5.Tag,"0"));
			if (mbid==0){MessageBox.Show("请先选择模板");return;}
			string mbmc=this.groupBox5.Text.Trim();
			DlgInputBox f=new DlgInputBox(mbmc,"请输入模板的名称 ","输入名称");
			f.ShowDialog();
			if (DlgInputBox.DlgResult==true) mbmc=DlgInputBox.DlgValue;else return;
			try
			{

                string pym = TrasenClasses.GeneralClasses.PubStaticFun.GetPYWBM(mbmc, 0);
                string wbm = TrasenClasses.GeneralClasses.PubStaticFun.GetPYWBM(mbmc, 1);
                YP_YPTJMB.SaveMb(mbid, mbmc, pym,wbm, "", InstanceForm.BCurrentUser.EmployeeId, out outmbid, InstanceForm.BDatabase);
				MessageBox.Show("修改成功");
				this.groupBox5.Text=mbmc.Trim();
                AddTitle();
			}
			catch(System.Exception err)
			{
				MessageBox.Show(err.Message);
			}

		}

		
		//网格列改变事件
		private void myDataGrid1_CurrentCellChanged(object sender, System.EventArgs e)
		{
			DataTable tb=(DataTable)this.myDataGrid1.DataSource;
			int nrow=this.myDataGrid1.CurrentCell.RowNumber;
			if (nrow>tb.Rows.Count-1) return;
			this.csyp(0,Convert.ToInt32(tb.Rows[nrow]["cjid"]));
		}


		#endregion 

		private void butprint_Click(object sender, System.EventArgs e)
		{
            //try
            //{

				
            //    DataTable tb=(DataTable)this.myDataGrid1.DataSource;
            //    ts_Yk_ReportView.Dataset2 Dset=new ts_Yk_ReportView.Dataset2();

            //    if (tb.Rows.Count==0) return;
            //    butprint.Enabled=false;
            //    DataRow myrow;
            //    for(int i=0;i<=tb.Rows.Count-1;i++)
            //    {
            //        myrow=Dset.发药明细单.NewRow();
            //        myrow["rowno"]=Convert.ToString(tb.Rows[i]["序号"]);
            //        myrow["ypspm"]=Convert.ToString(tb.Rows[i]["品名"]);
            //        myrow["ypgg"]=Convert.ToString(tb.Rows[i]["规格"]);
            //        myrow["sccj"]=Convert.ToString(tb.Rows[i]["厂家"]);
            //        myrow["lsj"]=Convert.ToDecimal(tb.Rows[i]["零售价"]);
            //        myrow["ypdw"]=Convert.ToString(tb.Rows[i]["单位"]);
            //        myrow["shh"]=Convert.ToString(tb.Rows[i]["货号"]);
            //        myrow["bz"]=Convert.ToString(tb.Rows[i]["描述"]);
            //        Dset.发药明细单.Rows.Add(myrow);

            //    }

            //    ParameterEx[] parameters=new ParameterEx[2];
            //    parameters[0].Text="title";
            //    parameters[0].Value=TrasenFrame.Classes.Constant.HospitalName+"("+InstanceForm.BCurrentDept.DeptName+")"+"盘点模板";
            //    parameters[1].Text="bz";
            //    parameters[1].Value=this.groupBox5.Text.Trim();
            //    TrasenFrame.Forms.FrmReportView f=new TrasenFrame.Forms.FrmReportView(Dset.发药明细单,Constant.ApplicationDirectory+"\\Report\\YF_盘点模板.rpt",parameters);
            //    if (f.LoadReportSuccess) f.Show();else  f.Dispose();
            //    butprint.Enabled=true;

            //}
            //catch(System.Exception err)
            //{
            //    butprint.Enabled=true;
            //    MessageBox.Show(err.Message);
            //}
		}

        private void treeView1_AfterSelect(object sender, TreeViewEventArgs e)
        {
            try
            {
                this.Cursor = PubStaticFun.WaitCursor();
                this.SelectGG(this.treeView1.SelectedNode.Tag.ToString(), "");
            }
            catch (System.Exception err)
            {
                MessageBox.Show(err.Message, "错误", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
            finally
            {
                this.Cursor = Cursors.Arrow;
            }
        }


        private void SelectGG(string swhere, string ypbm)
        {
            try
            {
                string ssql = "select 0 序号,yppm 品名,ypgg 规格,s_sccj 厂家 ,s_ypdw 单位,pfj 批发价,lsj 零售价,shh 货号,a.ggid,cjid,cast(b.bdelete as smallint) 停用 " +
                    "  from yp_ypggd a inner join yp_ypcjd b on a.ggid=b.ggid " +
                    "  where a.ggid>0 ";
                if (swhere.Trim() == "" && ypbm.Trim() == "") ssql = ssql + " and b.bdelete=0 ";
                if (swhere.Trim() != "") ssql = ssql + " " + swhere;
                if (ypbm.Trim() != "")
                    ssql = ssql + " and  a.ggid in(select ggid from yp_ypbm where  upper(pym) like '" + ypbm.Trim().ToUpper() + "%'" +
                        " or upper(wbm) like '" + ypbm.Trim().ToUpper() + "%'" +
                        " or  ypbm like '%" + ypbm.Trim() + "%') ";
                 ssql = ssql + " order by yppm ";

                DataTable tb = InstanceForm.BDatabase.GetDataTable(ssql);
                FunBase.AddRowtNo(tb);
                tb.TableName = "Tb3";
                this.myDataGrid3.DataSource = tb;
                FunBase.myGridSelect(this.myDataGrid3, this.myDataGrid3.TableStyles[0].GridColumnStyles);
            }
            catch (System.Exception err)
            {
                MessageBox.Show(err.Message, "错误", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
        }

        private void myDataGrid1_Navigate(object sender, NavigateEventArgs ne)
        {

        }
		
		
		
	}
}
